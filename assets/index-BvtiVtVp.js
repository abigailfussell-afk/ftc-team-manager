var zu=Object.defineProperty;var wr=t=>{throw TypeError(t)};var ju=(t,e,n)=>e in t?zu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Xe=(t,e,n)=>ju(t,typeof e!="symbol"?e+"":e,n),$o=(t,e,n)=>e.has(t)||wr("Cannot "+n);var N=(t,e,n)=>($o(t,e,"read from private field"),n?n.call(t):e.get(t)),Y=(t,e,n)=>e.has(t)?wr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),K=(t,e,n,o)=>($o(t,e,"write to private field"),o?o.call(t,n):e.set(t,n),n),le=(t,e,n)=>($o(t,e,"access private method"),n);var Fn=(t,e,n,o)=>({set _(s){K(t,e,s,n)},get _(){return N(t,e,o)}});import{r as D,a as Wu,g as Yu,R as Za,b as Qu,c as Oo,N as Cr,u as Xu,H as Zu}from"./vendor-B0Cn478z.js";import{c as ec}from"./supabase-CRHRt2Ih.js";import{s as Ln,d as tc}from"./charts-CeMqgyHT.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();var el={exports:{}},No={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nc=D,oc=Symbol.for("react.element"),sc=Symbol.for("react.fragment"),rc=Object.prototype.hasOwnProperty,ic=nc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ac={key:!0,ref:!0,__self:!0,__source:!0};function tl(t,e,n){var o,s={},r=null,a=null;n!==void 0&&(r=""+n),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(a=e.ref);for(o in e)rc.call(e,o)&&!ac.hasOwnProperty(o)&&(s[o]=e[o]);if(t&&t.defaultProps)for(o in e=t.defaultProps,e)s[o]===void 0&&(s[o]=e[o]);return{$$typeof:oc,type:t,key:r,ref:a,props:s,_owner:ic.current}}No.Fragment=sc;No.jsx=tl;No.jsxs=tl;el.exports=No;var h=el.exports,ns={},Tr=Wu;ns.createRoot=Tr.createRoot,ns.hydrateRoot=Tr.hydrateRoot;var Ao=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},lc={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},st,Ws,Oa,uc=(Oa=class{constructor(){Y(this,st,lc);Y(this,Ws,!1)}setTimeoutProvider(t){K(this,st,t)}setTimeout(t,e){return N(this,st).setTimeout(t,e)}clearTimeout(t){N(this,st).clearTimeout(t)}setInterval(t,e){return N(this,st).setInterval(t,e)}clearInterval(t){N(this,st).clearInterval(t)}},st=new WeakMap,Ws=new WeakMap,Oa),os=new uc;function cc(t){setTimeout(t,0)}var Po=typeof window>"u"||"Deno"in globalThis;function Ee(){}function dc(t,e){return typeof t=="function"?t(e):t}function fc(t){return typeof t=="number"&&t>=0&&t!==1/0}function hc(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ss(t,e){return typeof t=="function"?t(e):t}function pc(t,e){return typeof t=="function"?t(e):t}function Sr(t,e){const{type:n="all",exact:o,fetchStatus:s,predicate:r,queryKey:a,stale:u}=t;if(a){if(o){if(e.queryHash!==Ys(a,e.options))return!1}else if(!xn(e.queryKey,a))return!1}if(n!=="all"){const c=e.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof u=="boolean"&&e.isStale()!==u||s&&s!==e.state.fetchStatus||r&&!r(e))}function Er(t,e){const{exact:n,status:o,predicate:s,mutationKey:r}=t;if(r){if(!e.options.mutationKey)return!1;if(n){if(vn(e.options.mutationKey)!==vn(r))return!1}else if(!xn(e.options.mutationKey,r))return!1}return!(o&&e.state.status!==o||s&&!s(e))}function Ys(t,e){return((e==null?void 0:e.queryKeyHashFn)||vn)(t)}function vn(t){return JSON.stringify(t,(e,n)=>rs(n)?Object.keys(n).sort().reduce((o,s)=>(o[s]=n[s],o),{}):n)}function xn(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>xn(t[n],e[n])):!1}var mc=Object.prototype.hasOwnProperty;function nl(t,e){if(t===e)return t;const n=Ir(t)&&Ir(e);if(!n&&!(rs(t)&&rs(e)))return e;const s=(n?t:Object.keys(t)).length,r=n?e:Object.keys(e),a=r.length,u=n?new Array(a):{};let c=0;for(let d=0;d<a;d++){const f=n?d:r[d],m=t[f],p=e[f];if(m===p){u[f]=m,(n?d<s:mc.call(t,f))&&c++;continue}if(m===null||p===null||typeof m!="object"||typeof p!="object"){u[f]=p;continue}const g=nl(m,p);u[f]=g,g===m&&c++}return s===a&&c===s?t:u}function Ir(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function rs(t){if(!kr(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!kr(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function kr(t){return Object.prototype.toString.call(t)==="[object Object]"}function gc(t){return new Promise(e=>{os.setTimeout(e,t)})}function yc(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?nl(t,e):e}function vc(t,e,n=0){const o=[...t,e];return n&&o.length>n?o.slice(1):o}function xc(t,e,n=0){const o=[e,...t];return n&&o.length>n?o.slice(0,-1):o}var Qs=Symbol();function ol(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Qs?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function bc(t,e,n){let o=!1,s;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(s??(s=e()),o||(o=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),t}var xt,rt,Ot,Ka,_c=(Ka=class extends Ao{constructor(){super();Y(this,xt);Y(this,rt);Y(this,Ot);K(this,Ot,e=>{if(!Po&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){N(this,rt)||this.setEventListener(N(this,Ot))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,rt))==null||e.call(this),K(this,rt,void 0))}setEventListener(e){var n;K(this,Ot,e),(n=N(this,rt))==null||n.call(this),K(this,rt,e(o=>{typeof o=="boolean"?this.setFocused(o):this.onFocus()}))}setFocused(e){N(this,xt)!==e&&(K(this,xt,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof N(this,xt)=="boolean"?N(this,xt):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},xt=new WeakMap,rt=new WeakMap,Ot=new WeakMap,Ka),sl=new _c;function wc(){let t,e;const n=new Promise((s,r)=>{t=s,e=r});n.status="pending",n.catch(()=>{});function o(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{o({status:"fulfilled",value:s}),t(s)},n.reject=s=>{o({status:"rejected",reason:s}),e(s)},n}var Cc=cc;function Tc(){let t=[],e=0,n=u=>{u()},o=u=>{u()},s=Cc;const r=u=>{e?t.push(u):s(()=>{n(u)})},a=()=>{const u=t;t=[],u.length&&s(()=>{o(()=>{u.forEach(c=>{n(c)})})})};return{batch:u=>{let c;e++;try{c=u()}finally{e--,e||a()}return c},batchCalls:u=>(...c)=>{r(()=>{u(...c)})},schedule:r,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{o=u},setScheduler:u=>{s=u}}}var pe=Tc(),Kt,it,Jt,Ja,Sc=(Ja=class extends Ao{constructor(){super();Y(this,Kt,!0);Y(this,it);Y(this,Jt);K(this,Jt,e=>{if(!Po&&window.addEventListener){const n=()=>e(!0),o=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",o,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",o)}}})}onSubscribe(){N(this,it)||this.setEventListener(N(this,Jt))}onUnsubscribe(){var e;this.hasListeners()||((e=N(this,it))==null||e.call(this),K(this,it,void 0))}setEventListener(e){var n;K(this,Jt,e),(n=N(this,it))==null||n.call(this),K(this,it,e(this.setOnline.bind(this)))}setOnline(e){N(this,Kt)!==e&&(K(this,Kt,e),this.listeners.forEach(o=>{o(e)}))}isOnline(){return N(this,Kt)}},Kt=new WeakMap,it=new WeakMap,Jt=new WeakMap,Ja),io=new Sc;function Ec(t){return Math.min(1e3*2**t,3e4)}function rl(t){return(t??"online")==="online"?io.isOnline():!0}var is=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function il(t){let e=!1,n=0,o;const s=wc(),r=()=>s.status!=="pending",a=y=>{var x;if(!r()){const b=new is(y);p(b),(x=t.onCancel)==null||x.call(t,b)}},u=()=>{e=!0},c=()=>{e=!1},d=()=>sl.isFocused()&&(t.networkMode==="always"||io.isOnline())&&t.canRun(),f=()=>rl(t.networkMode)&&t.canRun(),m=y=>{r()||(o==null||o(),s.resolve(y))},p=y=>{r()||(o==null||o(),s.reject(y))},g=()=>new Promise(y=>{var x;o=b=>{(r()||d())&&y(b)},(x=t.onPause)==null||x.call(t)}).then(()=>{var y;o=void 0,r()||(y=t.onContinue)==null||y.call(t)}),v=()=>{if(r())return;let y;const x=n===0?t.initialPromise:void 0;try{y=x??t.fn()}catch(b){y=Promise.reject(b)}Promise.resolve(y).then(m).catch(b=>{var k;if(r())return;const _=t.retry??(Po?0:3),w=t.retryDelay??Ec,C=typeof w=="function"?w(n,b):w,I=_===!0||typeof _=="number"&&n<_||typeof _=="function"&&_(n,b);if(e||!I){p(b);return}n++,(k=t.onFail)==null||k.call(t,n,b),gc(C).then(()=>d()?void 0:g()).then(()=>{e?p(b):v()})})};return{promise:s,status:()=>s.status,cancel:a,continue:()=>(o==null||o(),s),cancelRetry:u,continueRetry:c,canStart:f,start:()=>(f()?v():g().then(v),s)}}var bt,za,al=(za=class{constructor(){Y(this,bt)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),fc(this.gcTime)&&K(this,bt,os.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Po?1/0:5*60*1e3))}clearGcTimeout(){N(this,bt)&&(os.clearTimeout(N(this,bt)),K(this,bt,void 0))}},bt=new WeakMap,za),_t,zt,_e,wt,ie,An,Ct,Ie,He,ja,Ic=(ja=class extends al{constructor(e){super();Y(this,Ie);Y(this,_t);Y(this,zt);Y(this,_e);Y(this,wt);Y(this,ie);Y(this,An);Y(this,Ct);K(this,Ct,!1),K(this,An,e.defaultOptions),this.setOptions(e.options),this.observers=[],K(this,wt,e.client),K(this,_e,N(this,wt).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,K(this,_t,Ar(this.options)),this.state=e.state??N(this,_t),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=N(this,ie))==null?void 0:e.promise}setOptions(e){if(this.options={...N(this,An),...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Ar(this.options);n.data!==void 0&&(this.setState(Nr(n.data,n.dataUpdatedAt)),K(this,_t,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&N(this,_e).remove(this)}setData(e,n){const o=yc(this.state.data,e,this.options);return le(this,Ie,He).call(this,{data:o,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),o}setState(e,n){le(this,Ie,He).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var o,s;const n=(o=N(this,ie))==null?void 0:o.promise;return(s=N(this,ie))==null||s.cancel(e),n?n.then(Ee).catch(Ee):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(N(this,_t))}isActive(){return this.observers.some(e=>pc(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Qs||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ss(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!hc(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(o=>o.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=N(this,ie))==null||n.continue()}onOnline(){var n;const e=this.observers.find(o=>o.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=N(this,ie))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),N(this,_e).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(N(this,ie)&&(N(this,Ct)?N(this,ie).cancel({revert:!0}):N(this,ie).cancelRetry()),this.scheduleGc()),N(this,_e).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||le(this,Ie,He).call(this,{type:"invalidate"})}async fetch(e,n){var c,d,f,m,p,g,v,y,x,b,_,w;if(this.state.fetchStatus!=="idle"&&((c=N(this,ie))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(N(this,ie))return N(this,ie).continueRetry(),N(this,ie).promise}if(e&&this.setOptions(e),!this.options.queryFn){const C=this.observers.find(I=>I.options.queryFn);C&&this.setOptions(C.options)}const o=new AbortController,s=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(K(this,Ct,!0),o.signal)})},r=()=>{const C=ol(this.options,n),k=(()=>{const T={client:N(this,wt),queryKey:this.queryKey,meta:this.meta};return s(T),T})();return K(this,Ct,!1),this.options.persister?this.options.persister(C,k,this):C(k)},u=(()=>{const C={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:N(this,wt),state:this.state,fetchFn:r};return s(C),C})();(d=this.options.behavior)==null||d.onFetch(u,this),K(this,zt,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=u.fetchOptions)==null?void 0:f.meta))&&le(this,Ie,He).call(this,{type:"fetch",meta:(m=u.fetchOptions)==null?void 0:m.meta}),K(this,ie,il({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,onCancel:C=>{C instanceof is&&C.revert&&this.setState({...N(this,zt),fetchStatus:"idle"}),o.abort()},onFail:(C,I)=>{le(this,Ie,He).call(this,{type:"failed",failureCount:C,error:I})},onPause:()=>{le(this,Ie,He).call(this,{type:"pause"})},onContinue:()=>{le(this,Ie,He).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const C=await N(this,ie).start();if(C===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(C),(g=(p=N(this,_e).config).onSuccess)==null||g.call(p,C,this),(y=(v=N(this,_e).config).onSettled)==null||y.call(v,C,this.state.error,this),C}catch(C){if(C instanceof is){if(C.silent)return N(this,ie).promise;if(C.revert){if(this.state.data===void 0)throw C;return this.state.data}}throw le(this,Ie,He).call(this,{type:"error",error:C}),(b=(x=N(this,_e).config).onError)==null||b.call(x,C,this),(w=(_=N(this,_e).config).onSettled)==null||w.call(_,this.state.data,C,this),C}finally{this.scheduleGc()}}},_t=new WeakMap,zt=new WeakMap,_e=new WeakMap,wt=new WeakMap,ie=new WeakMap,An=new WeakMap,Ct=new WeakMap,Ie=new WeakSet,He=function(e){const n=o=>{switch(e.type){case"failed":return{...o,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...o,fetchStatus:"paused"};case"continue":return{...o,fetchStatus:"fetching"};case"fetch":return{...o,...kc(o.data,this.options),fetchMeta:e.meta??null};case"success":const s={...o,...Nr(e.data,e.dataUpdatedAt),dataUpdateCount:o.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return K(this,zt,e.manual?s:void 0),s;case"error":const r=e.error;return{...o,error:r,errorUpdateCount:o.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:o.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...o,isInvalidated:!0};case"setState":return{...o,...e.state}}};this.state=n(this.state),pe.batch(()=>{this.observers.forEach(o=>{o.onQueryUpdate()}),N(this,_e).notify({query:this,type:"updated",action:e})})},ja);function kc(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:rl(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Nr(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ar(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,o=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function Pr(t){return{onFetch:(e,n)=>{var f,m,p,g,v;const o=e.options,s=(p=(m=(f=e.fetchOptions)==null?void 0:f.meta)==null?void 0:m.fetchMore)==null?void 0:p.direction,r=((g=e.state.data)==null?void 0:g.pages)||[],a=((v=e.state.data)==null?void 0:v.pageParams)||[];let u={pages:[],pageParams:[]},c=0;const d=async()=>{let y=!1;const x=w=>{bc(w,()=>e.signal,()=>y=!0)},b=ol(e.options,e.fetchOptions),_=async(w,C,I)=>{if(y)return Promise.reject();if(C==null&&w.pages.length)return Promise.resolve(w);const T=(()=>{const A={client:e.client,queryKey:e.queryKey,pageParam:C,direction:I?"backward":"forward",meta:e.options.meta};return x(A),A})(),U=await b(T),{maxPages:E}=e.options,R=I?xc:vc;return{pages:R(w.pages,U,E),pageParams:R(w.pageParams,C,E)}};if(s&&r.length){const w=s==="backward",C=w?Nc:Rr,I={pages:r,pageParams:a},k=C(o,I);u=await _(I,k,w)}else{const w=t??r.length;do{const C=c===0?a[0]??o.initialPageParam:Rr(o,u);if(c>0&&C==null)break;u=await _(u,C),c++}while(c<w)}return u};e.options.persister?e.fetchFn=()=>{var y,x;return(x=(y=e.options).persister)==null?void 0:x.call(y,d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=d}}}function Rr(t,{pages:e,pageParams:n}){const o=e.length-1;return e.length>0?t.getNextPageParam(e[o],e,n[o],n):void 0}function Nc(t,{pages:e,pageParams:n}){var o;return e.length>0?(o=t.getPreviousPageParam)==null?void 0:o.call(t,e[0],e,n[0],n):void 0}var Pn,Ue,fe,Tt,Fe,et,Wa,Ac=(Wa=class extends al{constructor(e){super();Y(this,Fe);Y(this,Pn);Y(this,Ue);Y(this,fe);Y(this,Tt);K(this,Pn,e.client),this.mutationId=e.mutationId,K(this,fe,e.mutationCache),K(this,Ue,[]),this.state=e.state||Pc(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){N(this,Ue).includes(e)||(N(this,Ue).push(e),this.clearGcTimeout(),N(this,fe).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){K(this,Ue,N(this,Ue).filter(n=>n!==e)),this.scheduleGc(),N(this,fe).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){N(this,Ue).length||(this.state.status==="pending"?this.scheduleGc():N(this,fe).remove(this))}continue(){var e;return((e=N(this,Tt))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var a,u,c,d,f,m,p,g,v,y,x,b,_,w,C,I,k,T,U,E;const n=()=>{le(this,Fe,et).call(this,{type:"continue"})},o={client:N(this,Pn),meta:this.options.meta,mutationKey:this.options.mutationKey};K(this,Tt,il({fn:()=>this.options.mutationFn?this.options.mutationFn(e,o):Promise.reject(new Error("No mutationFn found")),onFail:(R,A)=>{le(this,Fe,et).call(this,{type:"failed",failureCount:R,error:A})},onPause:()=>{le(this,Fe,et).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>N(this,fe).canRun(this)}));const s=this.state.status==="pending",r=!N(this,Tt).canStart();try{if(s)n();else{le(this,Fe,et).call(this,{type:"pending",variables:e,isPaused:r}),await((u=(a=N(this,fe).config).onMutate)==null?void 0:u.call(a,e,this,o));const A=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,e,o));A!==this.state.context&&le(this,Fe,et).call(this,{type:"pending",context:A,variables:e,isPaused:r})}const R=await N(this,Tt).start();return await((m=(f=N(this,fe).config).onSuccess)==null?void 0:m.call(f,R,e,this.state.context,this,o)),await((g=(p=this.options).onSuccess)==null?void 0:g.call(p,R,e,this.state.context,o)),await((y=(v=N(this,fe).config).onSettled)==null?void 0:y.call(v,R,null,this.state.variables,this.state.context,this,o)),await((b=(x=this.options).onSettled)==null?void 0:b.call(x,R,null,e,this.state.context,o)),le(this,Fe,et).call(this,{type:"success",data:R}),R}catch(R){try{await((w=(_=N(this,fe).config).onError)==null?void 0:w.call(_,R,e,this.state.context,this,o))}catch(A){Promise.reject(A)}try{await((I=(C=this.options).onError)==null?void 0:I.call(C,R,e,this.state.context,o))}catch(A){Promise.reject(A)}try{await((T=(k=N(this,fe).config).onSettled)==null?void 0:T.call(k,void 0,R,this.state.variables,this.state.context,this,o))}catch(A){Promise.reject(A)}try{await((E=(U=this.options).onSettled)==null?void 0:E.call(U,void 0,R,e,this.state.context,o))}catch(A){Promise.reject(A)}throw le(this,Fe,et).call(this,{type:"error",error:R}),R}finally{N(this,fe).runNext(this)}}},Pn=new WeakMap,Ue=new WeakMap,fe=new WeakMap,Tt=new WeakMap,Fe=new WeakSet,et=function(e){const n=o=>{switch(e.type){case"failed":return{...o,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...o,isPaused:!0};case"continue":return{...o,isPaused:!1};case"pending":return{...o,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...o,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...o,data:void 0,error:e.error,failureCount:o.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),pe.batch(()=>{N(this,Ue).forEach(o=>{o.onMutationUpdate(e)}),N(this,fe).notify({mutation:this,type:"updated",action:e})})},Wa);function Pc(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var $e,ke,Rn,Ya,Rc=(Ya=class extends Ao{constructor(e={}){super();Y(this,$e);Y(this,ke);Y(this,Rn);this.config=e,K(this,$e,new Set),K(this,ke,new Map),K(this,Rn,0)}build(e,n,o){const s=new Ac({client:e,mutationCache:this,mutationId:++Fn(this,Rn)._,options:e.defaultMutationOptions(n),state:o});return this.add(s),s}add(e){N(this,$e).add(e);const n=Gn(e);if(typeof n=="string"){const o=N(this,ke).get(n);o?o.push(e):N(this,ke).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(N(this,$e).delete(e)){const n=Gn(e);if(typeof n=="string"){const o=N(this,ke).get(n);if(o)if(o.length>1){const s=o.indexOf(e);s!==-1&&o.splice(s,1)}else o[0]===e&&N(this,ke).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Gn(e);if(typeof n=="string"){const o=N(this,ke).get(n),s=o==null?void 0:o.find(r=>r.state.status==="pending");return!s||s===e}else return!0}runNext(e){var o;const n=Gn(e);if(typeof n=="string"){const s=(o=N(this,ke).get(n))==null?void 0:o.find(r=>r!==e&&r.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){pe.batch(()=>{N(this,$e).forEach(e=>{this.notify({type:"removed",mutation:e})}),N(this,$e).clear(),N(this,ke).clear()})}getAll(){return Array.from(N(this,$e))}find(e){const n={exact:!0,...e};return this.getAll().find(o=>Er(n,o))}findAll(e={}){return this.getAll().filter(n=>Er(e,n))}notify(e){pe.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return pe.batch(()=>Promise.all(e.map(n=>n.continue().catch(Ee))))}},$e=new WeakMap,ke=new WeakMap,Rn=new WeakMap,Ya);function Gn(t){var e;return(e=t.options.scope)==null?void 0:e.id}var Le,Qa,Mc=(Qa=class extends Ao{constructor(e={}){super();Y(this,Le);this.config=e,K(this,Le,new Map)}build(e,n,o){const s=n.queryKey,r=n.queryHash??Ys(s,n);let a=this.get(r);return a||(a=new Ic({client:e,queryKey:s,queryHash:r,options:e.defaultQueryOptions(n),state:o,defaultOptions:e.getQueryDefaults(s)}),this.add(a)),a}add(e){N(this,Le).has(e.queryHash)||(N(this,Le).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=N(this,Le).get(e.queryHash);n&&(e.destroy(),n===e&&N(this,Le).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){pe.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return N(this,Le).get(e)}getAll(){return[...N(this,Le).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(o=>Sr(n,o))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(o=>Sr(e,o)):n}notify(e){pe.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){pe.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){pe.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Le=new WeakMap,Qa),oe,at,lt,jt,Wt,ut,Yt,Qt,Xa,Dc=(Xa=class{constructor(t={}){Y(this,oe);Y(this,at);Y(this,lt);Y(this,jt);Y(this,Wt);Y(this,ut);Y(this,Yt);Y(this,Qt);K(this,oe,t.queryCache||new Mc),K(this,at,t.mutationCache||new Rc),K(this,lt,t.defaultOptions||{}),K(this,jt,new Map),K(this,Wt,new Map),K(this,ut,0)}mount(){Fn(this,ut)._++,N(this,ut)===1&&(K(this,Yt,sl.subscribe(async t=>{t&&(await this.resumePausedMutations(),N(this,oe).onFocus())})),K(this,Qt,io.subscribe(async t=>{t&&(await this.resumePausedMutations(),N(this,oe).onOnline())})))}unmount(){var t,e;Fn(this,ut)._--,N(this,ut)===0&&((t=N(this,Yt))==null||t.call(this),K(this,Yt,void 0),(e=N(this,Qt))==null||e.call(this),K(this,Qt,void 0))}isFetching(t){return N(this,oe).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return N(this,at).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=N(this,oe).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=N(this,oe).build(this,e),o=n.state.data;return o===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(ss(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(o))}getQueriesData(t){return N(this,oe).findAll(t).map(({queryKey:e,state:n})=>{const o=n.data;return[e,o]})}setQueryData(t,e,n){const o=this.defaultQueryOptions({queryKey:t}),s=N(this,oe).get(o.queryHash),r=s==null?void 0:s.state.data,a=dc(e,r);if(a!==void 0)return N(this,oe).build(this,o).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return pe.batch(()=>N(this,oe).findAll(t).map(({queryKey:o})=>[o,this.setQueryData(o,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=N(this,oe).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=N(this,oe);pe.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=N(this,oe);return pe.batch(()=>(n.findAll(t).forEach(o=>{o.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},o=pe.batch(()=>N(this,oe).findAll(t).map(s=>s.cancel(n)));return Promise.all(o).then(Ee).catch(Ee)}invalidateQueries(t,e={}){return pe.batch(()=>(N(this,oe).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},o=pe.batch(()=>N(this,oe).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let r=s.fetch(void 0,n);return n.throwOnError||(r=r.catch(Ee)),s.state.fetchStatus==="paused"?Promise.resolve():r}));return Promise.all(o).then(Ee)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=N(this,oe).build(this,e);return n.isStaleByTime(ss(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ee).catch(Ee)}fetchInfiniteQuery(t){return t.behavior=Pr(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ee).catch(Ee)}ensureInfiniteQueryData(t){return t.behavior=Pr(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return io.isOnline()?N(this,at).resumePausedMutations():Promise.resolve()}getQueryCache(){return N(this,oe)}getMutationCache(){return N(this,at)}getDefaultOptions(){return N(this,lt)}setDefaultOptions(t){K(this,lt,t)}setQueryDefaults(t,e){N(this,jt).set(vn(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...N(this,jt).values()],n={};return e.forEach(o=>{xn(t,o.queryKey)&&Object.assign(n,o.defaultOptions)}),n}setMutationDefaults(t,e){N(this,Wt).set(vn(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...N(this,Wt).values()],n={};return e.forEach(o=>{xn(t,o.mutationKey)&&Object.assign(n,o.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...N(this,lt).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Ys(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Qs&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...N(this,lt).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){N(this,oe).clear(),N(this,at).clear()}},oe=new WeakMap,at=new WeakMap,lt=new WeakMap,jt=new WeakMap,Wt=new WeakMap,ut=new WeakMap,Yt=new WeakMap,Qt=new WeakMap,Xa),Uc=D.createContext(void 0),Fc=({client:t,children:e})=>(D.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),h.jsx(Uc.Provider,{value:t,children:e}));const Xs="https://cvnonrjzshaawzxcjwmn.supabase.co",bn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImN2bm9ucmp6c2hhYXd6eGNqd21uIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjczODM0MjQsImV4cCI6MjA4Mjk1OTQyNH0._Qx-efsymzv9R2WpvqcuuxDbz0GeugueEgSPIEM7Cn0",X=ec(Xs,bn,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}}),Zs=()=>!!X,ll=D.createContext(void 0);function Lc({children:t}){const[e,n]=D.useState({user:null,session:null,isLoading:!0,isConfigured:Zs()});D.useEffect(()=>{if(!X){n(g=>({...g,isLoading:!1}));return}const m=setTimeout(()=>{n(g=>g.isLoading?(console.warn("Auth check timed out, proceeding to app..."),{...g,isLoading:!1}):g)},1500);X.auth.getSession().then(({data:{session:g}})=>{clearTimeout(m),n(v=>({...v,session:g,user:(g==null?void 0:g.user)??null,isLoading:!1}))}).catch(g=>{console.error("Auth session error:",g),clearTimeout(m),n(v=>({...v,isLoading:!1}))});const{data:{subscription:p}}=X.auth.onAuthStateChange(async(g,v)=>{n(y=>({...y,session:v,user:(v==null?void 0:v.user)??null,isLoading:!1})),g==="SIGNED_IN"&&(v!=null&&v.user)&&await o(v.user)});return()=>{p.unsubscribe()}},[]);const o=async m=>{if(!X)return;const{data:p}=await X.from("users").select("id").eq("id",m.id).single();p||await X.from("users").insert({id:m.id,email:m.email,full_name:m.user_metadata.full_name||m.user_metadata.name||null,avatar_url:m.user_metadata.avatar_url||null})},s=D.useCallback(async(m,p)=>{if(!X)return{error:{message:"Supabase not configured"}};const{error:g}=await X.auth.signInWithPassword({email:m,password:p});return{error:g}},[]),r=D.useCallback(async(m,p,g)=>{if(!X)return{error:{message:"Supabase not configured"}};const{error:v}=await X.auth.signUp({email:m,password:p,options:{data:{full_name:g}}});return{error:v}},[]),a=D.useCallback(async()=>{if(!X)return{error:{message:"Supabase not configured"}};const{error:m}=await X.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});return{error:m}},[]),u=D.useCallback(async()=>{if(!X)return{error:{message:"Supabase not configured"}};const{error:m}=await X.auth.signInWithOAuth({provider:"azure",options:{redirectTo:`${window.location.origin}/auth/callback`,scopes:"email profile openid"}});return{error:m}},[]),c=D.useCallback(async()=>{X&&await X.auth.signOut()},[]),d=D.useCallback(async m=>{if(!X)return{error:{message:"Supabase not configured"}};const{error:p}=await X.auth.resetPasswordForEmail(m,{redirectTo:`${window.location.origin}/auth/reset-password`});return{error:p}},[]),f={...e,signInWithEmail:s,signUpWithEmail:r,signInWithGoogle:a,signInWithMicrosoft:u,signOut:c,resetPassword:d};return h.jsx(ll.Provider,{value:f,children:t})}function Ro(){const t=D.useContext(ll);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gc=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qc=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,o)=>o?o.toUpperCase():n.toLowerCase()),Mr=t=>{const e=qc(t);return e.charAt(0).toUpperCase()+e.slice(1)},ul=(...t)=>t.filter((e,n,o)=>!!e&&e.trim()!==""&&o.indexOf(e)===n).join(" ").trim(),Vc=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Hc={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=D.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:s="",children:r,iconNode:a,...u},c)=>D.createElement("svg",{ref:c,...Hc,width:e,height:e,stroke:t,strokeWidth:o?Number(n)*24/Number(e):n,className:ul("lucide",s),...!r&&!Vc(u)&&{"aria-hidden":"true"},...u},[...a.map(([d,f])=>D.createElement(d,f)),...Array.isArray(r)?r:[r]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=(t,e)=>{const n=D.forwardRef(({className:o,...s},r)=>D.createElement(Bc,{ref:r,iconNode:e,className:ul(`lucide-${Gc(Mr(t))}`,`lucide-${t}`,o),...s}));return n.displayName=Mr(t),n};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],as=B("activity",$c);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ko=B("archive",Oc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],ao=B("arrow-right",Kc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jc=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Dr=B("book-open",Jc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zc=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],cl=B("calendar",zc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jc=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],dl=B("check",jc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ls=B("chevron-down",Wc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Qc=B("chevron-right",Yc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xc=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Zc=B("circle-alert",Xc);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],td=B("circle-check",ed);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nd=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],od=B("circle-plus",nd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],lo=B("clipboard-check",sd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],fl=B("clock",rd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]],uo=B("cloud-off",id);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ad=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],ld=B("cloud-upload",ad);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],cd=B("cloud",ud);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dd=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],fd=B("download",dd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Ur=B("folder-open",hd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]],co=B("gamepad-2",pd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Fr=B("graduation-cap",md);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],yd=B("layers",gd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],fo=B("layout-dashboard",vd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xd=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],bd=B("list",xd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _d=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],us=B("loader-circle",_d);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Cd=B("lock",wd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Lr=B("log-out",Td);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Ed=B("mail",Sd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Id=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],kd=B("menu",Id);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=[["path",{d:"M5 12h14",key:"1ays0h"}]],Gr=B("minus",Nd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ad=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],qr=B("moon",Ad);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Rd=B("panels-top-left",Pd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Dd=B("pen",Md);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Gt=B("plus",Ud);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fd=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ld=B("refresh-cw",Fd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gd=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],hl=B("rotate-ccw",Gd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Vr=B("save",qd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vd=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Hd=B("send",Vd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bd=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Hr=B("settings",Bd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $d=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],ho=B("sparkles",$d);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],po=B("square-check-big",Od);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kd=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Jd=B("square-pen",Kd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zd=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],Br=B("sun",zd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Ge=B("trash-2",jd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Yd=B("trending-up",Wd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Xd=B("triangle-alert",Qd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],ef=B("trophy",Zd);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]],nf=B("undo",tf);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],sf=B("user-plus",of);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],pl=B("user",rf);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],lf=B("users",af);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],_n=B("x",uf),cf={},$r=t=>{let e;const n=new Set,o=(f,m)=>{const p=typeof f=="function"?f(e):f;if(!Object.is(p,e)){const g=e;e=m??(typeof p!="object"||p===null)?p:Object.assign({},e,p),n.forEach(v=>v(e,g))}},s=()=>e,c={setState:o,getState:s,getInitialState:()=>d,subscribe:f=>(n.add(f),()=>n.delete(f)),destroy:()=>{(cf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=e=t(o,s,c);return c},df=t=>t?$r(t):$r;var ml={exports:{}},gl={},yl={exports:{}},vl={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xt=D;function ff(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var hf=typeof Object.is=="function"?Object.is:ff,pf=Xt.useState,mf=Xt.useEffect,gf=Xt.useLayoutEffect,yf=Xt.useDebugValue;function vf(t,e){var n=e(),o=pf({inst:{value:n,getSnapshot:e}}),s=o[0].inst,r=o[1];return gf(function(){s.value=n,s.getSnapshot=e,Jo(s)&&r({inst:s})},[t,n,e]),mf(function(){return Jo(s)&&r({inst:s}),t(function(){Jo(s)&&r({inst:s})})},[t]),yf(n),n}function Jo(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!hf(t,n)}catch{return!0}}function xf(t,e){return e()}var bf=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xf:vf;vl.useSyncExternalStore=Xt.useSyncExternalStore!==void 0?Xt.useSyncExternalStore:bf;yl.exports=vl;var _f=yl.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mo=D,wf=_f;function Cf(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Tf=typeof Object.is=="function"?Object.is:Cf,Sf=wf.useSyncExternalStore,Ef=Mo.useRef,If=Mo.useEffect,kf=Mo.useMemo,Nf=Mo.useDebugValue;gl.useSyncExternalStoreWithSelector=function(t,e,n,o,s){var r=Ef(null);if(r.current===null){var a={hasValue:!1,value:null};r.current=a}else a=r.current;r=kf(function(){function c(g){if(!d){if(d=!0,f=g,g=o(g),s!==void 0&&a.hasValue){var v=a.value;if(s(v,g))return m=v}return m=g}if(v=m,Tf(f,g))return v;var y=o(g);return s!==void 0&&s(v,y)?(f=g,v):(f=g,m=y)}var d=!1,f,m,p=n===void 0?null:n;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,n,o,s]);var u=Sf(t,r[0],r[1]);return If(function(){a.hasValue=!0,a.value=u},[u]),Nf(u),u};ml.exports=gl;var Af=ml.exports;const Pf=Yu(Af),xl={},{useDebugValue:Rf}=Za,{useSyncExternalStoreWithSelector:Mf}=Pf;let Or=!1;const Df=t=>t;function Uf(t,e=Df,n){(xl?"production":void 0)!=="production"&&n&&!Or&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Or=!0);const o=Mf(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return Rf(o),o}const Ff=t=>{(xl?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?df(t):t,n=(o,s)=>Uf(e,o,s);return Object.assign(n,e),n},Lf=t=>Ff,Gf={};function qf(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var r;const a=c=>c===null?null:JSON.parse(c,void 0),u=(r=n.getItem(s))!=null?r:null;return u instanceof Promise?u.then(a):a(u)},setItem:(s,r)=>n.setItem(s,JSON.stringify(r,void 0)),removeItem:s=>n.removeItem(s)}}const wn=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(o){return wn(o)(n)},catch(o){return this}}}catch(n){return{then(o){return this},catch(o){return wn(o)(n)}}}},Vf=(t,e)=>(n,o,s)=>{let r={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,b)=>({...b,...x}),...e},a=!1;const u=new Set,c=new Set;let d;try{d=r.getStorage()}catch{}if(!d)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...x)},o,s);const f=wn(r.serialize),m=()=>{const x=r.partialize({...o()});let b;const _=f({state:x,version:r.version}).then(w=>d.setItem(r.name,w)).catch(w=>{b=w});if(b)throw b;return _},p=s.setState;s.setState=(x,b)=>{p(x,b),m()};const g=t((...x)=>{n(...x),m()},o,s);let v;const y=()=>{var x;if(!d)return;a=!1,u.forEach(_=>_(o()));const b=((x=r.onRehydrateStorage)==null?void 0:x.call(r,o()))||void 0;return wn(d.getItem.bind(d))(r.name).then(_=>{if(_)return r.deserialize(_)}).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==r.version){if(r.migrate)return r.migrate(_.state,_.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return _.state}).then(_=>{var w;return v=r.merge(_,(w=o())!=null?w:g),n(v,!0),m()}).then(()=>{b==null||b(v,void 0),a=!0,c.forEach(_=>_(v))}).catch(_=>{b==null||b(void 0,_)})};return s.persist={setOptions:x=>{r={...r,...x},x.getStorage&&(d=x.getStorage())},clearStorage:()=>{d==null||d.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>y(),hasHydrated:()=>a,onHydrate:x=>(u.add(x),()=>{u.delete(x)}),onFinishHydration:x=>(c.add(x),()=>{c.delete(x)})},y(),v||g},Hf=(t,e)=>(n,o,s)=>{let r={storage:qf(()=>localStorage),partialize:y=>y,version:0,merge:(y,x)=>({...x,...y}),...e},a=!1;const u=new Set,c=new Set;let d=r.storage;if(!d)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${r.name}', the given storage is currently unavailable.`),n(...y)},o,s);const f=()=>{const y=r.partialize({...o()});return d.setItem(r.name,{state:y,version:r.version})},m=s.setState;s.setState=(y,x)=>{m(y,x),f()};const p=t((...y)=>{n(...y),f()},o,s);s.getInitialState=()=>p;let g;const v=()=>{var y,x;if(!d)return;a=!1,u.forEach(_=>{var w;return _((w=o())!=null?w:p)});const b=((x=r.onRehydrateStorage)==null?void 0:x.call(r,(y=o())!=null?y:p))||void 0;return wn(d.getItem.bind(d))(r.name).then(_=>{if(_)if(typeof _.version=="number"&&_.version!==r.version){if(r.migrate)return[!0,r.migrate(_.state,_.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,_.state];return[!1,void 0]}).then(_=>{var w;const[C,I]=_;if(g=r.merge(I,(w=o())!=null?w:p),n(g,!0),C)return f()}).then(()=>{b==null||b(g,void 0),g=o(),a=!0,c.forEach(_=>_(g))}).catch(_=>{b==null||b(void 0,_)})};return s.persist={setOptions:y=>{r={...r,...y},y.storage&&(d=y.storage)},clearStorage:()=>{d==null||d.removeItem(r.name)},getOptions:()=>r,rehydrate:()=>v(),hasHydrated:()=>a,onHydrate:y=>(u.add(y),()=>{u.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},r.skipHydration||v(),g||p},Bf=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((Gf?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Vf(t,e)):Hf(t,e),$f=Bf,te=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,se=Object.keys,ce=Array.isArray;function ye(t,e){return typeof e!="object"||se(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||te.Promise||(te.Promise=Promise);const Cn=Object.getPrototypeOf,Of={}.hasOwnProperty;function be(t,e){return Of.call(t,e)}function Zt(t,e){typeof e=="function"&&(e=e(Cn(t))),(typeof Reflect>"u"?se:Reflect.ownKeys)(e).forEach(n=>{Je(t,n,e[n])})}const bl=Object.defineProperty;function Je(t,e,n,o){bl(t,e,ye(n&&be(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},o))}function qt(t){return{from:function(e){return t.prototype=Object.create(e.prototype),Je(t.prototype,"constructor",t),{extend:Zt.bind(null,t.prototype)}}}}const Kf=Object.getOwnPropertyDescriptor;function er(t,e){let n;return Kf(t,e)||(n=Cn(t))&&er(n,e)}const Jf=[].slice;function mo(t,e,n){return Jf.call(t,e,n)}function _l(t,e){return e(t)}function cn(t){if(!t)throw new Error("Assertion Failed")}function wl(t){te.setImmediate?setImmediate(t):setTimeout(t,0)}function Cl(t,e){return t.reduce((n,o,s)=>{var r=e(o,s);return r&&(n[r[0]]=r[1]),n},{})}function ze(t,e){if(typeof e=="string"&&be(t,e))return t[e];if(!e)return t;if(typeof e!="string"){for(var n=[],o=0,s=e.length;o<s;++o){var r=ze(t,e[o]);n.push(r)}return n}var a=e.indexOf(".");if(a!==-1){var u=t[e.substr(0,a)];return u==null?void 0:ze(u,e.substr(a+1))}}function Ne(t,e,n){if(t&&e!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if(typeof e!="string"&&"length"in e){cn(typeof n!="string"&&"length"in n);for(var o=0,s=e.length;o<s;++o)Ne(t,e[o],n[o])}else{var r=e.indexOf(".");if(r!==-1){var a=e.substr(0,r),u=e.substr(r+1);if(u==="")n===void 0?ce(t)&&!isNaN(parseInt(a))?t.splice(a,1):delete t[a]:t[a]=n;else{var c=t[a];c&&be(t,a)||(c=t[a]={}),Ne(c,u,n)}}else n===void 0?ce(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Tl(t){var e={};for(var n in t)be(t,n)&&(e[n]=t[n]);return e}const zf=[].concat;function Sl(t){return zf.apply([],t)}const El="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Sl([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>te[t]),jf=El.map(t=>te[t]);Cl(El,t=>[t,!0]);let nt=null;function Mn(t){nt=typeof WeakMap<"u"&&new WeakMap;const e=cs(t);return nt=null,e}function cs(t){if(!t||typeof t!="object")return t;let e=nt&&nt.get(t);if(e)return e;if(ce(t)){e=[],nt&&nt.set(t,e);for(var n=0,o=t.length;n<o;++n)e.push(cs(t[n]))}else if(jf.indexOf(t.constructor)>=0)e=t;else{const r=Cn(t);for(var s in e=r===Object.prototype?{}:Object.create(r),nt&&nt.set(t,e),t)be(t,s)&&(e[s]=cs(t[s]))}return e}const{toString:Wf}={};function ds(t){return Wf.call(t).slice(8,-1)}const fs=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Yf=typeof fs=="symbol"?function(t){var e;return t!=null&&(e=t[fs])&&e.apply(t)}:function(){return null},Dt={};function Oe(t){var e,n,o,s;if(arguments.length===1){if(ce(t))return t.slice();if(this===Dt&&typeof t=="string")return[t];if(s=Yf(t)){for(n=[];!(o=s.next()).done;)n.push(o.value);return n}if(t==null)return[t];if(typeof(e=t.length)=="number"){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const tr=typeof Symbol<"u"?t=>t[Symbol.toStringTag]==="AsyncFunction":()=>!1;var qe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Il(t,e){qe=t,kl=e}var kl=()=>!0;const Qf=!new Error("").stack;function At(){if(Qf)try{throw At.arguments,new Error}catch(t){return t}return new Error}function hs(t,e){var n=t.stack;return n?(e=e||0,n.indexOf(t.name)===0&&(e+=(t.name+t.message).split(`
`).length),n.split(`
`).slice(e).filter(kl).map(o=>`
`+o).join("")):""}var Nl=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],nr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Nl),Xf={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Vt(t,e){this._e=At(),this.name=t,this.message=e}function Al(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,o,s)=>s.indexOf(n)===o).join(`
`)}function go(t,e,n,o){this._e=At(),this.failures=e,this.failedKeys=o,this.successCount=n,this.message=Al(t,e)}function hn(t,e){this._e=At(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Al(t,e)}qt(Vt).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+hs(this._e,2))}},toString:function(){return this.name+": "+this.message}}),qt(go).from(Vt),qt(hn).from(Vt);var or=nr.reduce((t,e)=>(t[e]=e+"Error",t),{});const Zf=Vt;var O=nr.reduce((t,e)=>{var n=e+"Error";function o(s,r){this._e=At(),this.name=n,s?typeof s=="string"?(this.message=`${s}${r?`
 `+r:""}`,this.inner=r||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=Xf[e]||n,this.inner=null)}return qt(o).from(Zf),t[e]=o,t},{});O.Syntax=SyntaxError,O.Type=TypeError,O.Range=RangeError;var Kr=Nl.reduce((t,e)=>(t[e+"Error"]=O[e],t),{}),Qn=nr.reduce((t,e)=>(["Syntax","Type","Range"].indexOf(e)===-1&&(t[e+"Error"]=O[e]),t),{});function ee(){}function Tn(t){return t}function eh(t,e){return t==null||t===Tn?e:function(n){return e(t(n))}}function kt(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function th(t,e){return t===ee?e:function(){var n=t.apply(this,arguments);n!==void 0&&(arguments[0]=n);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var r=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?kt(o,this.onsuccess):o),s&&(this.onerror=this.onerror?kt(s,this.onerror):s),r!==void 0?r:n}}function nh(t,e){return t===ee?e:function(){t.apply(this,arguments);var n=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?kt(n,this.onsuccess):n),o&&(this.onerror=this.onerror?kt(o,this.onerror):o)}}function oh(t,e){return t===ee?e:function(n){var o=t.apply(this,arguments);ye(n,o);var s=this.onsuccess,r=this.onerror;this.onsuccess=null,this.onerror=null;var a=e.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?kt(s,this.onsuccess):s),r&&(this.onerror=this.onerror?kt(r,this.onerror):r),o===void 0?a===void 0?void 0:a:ye(o,a)}}function sh(t,e){return t===ee?e:function(){return e.apply(this,arguments)!==!1&&t.apply(this,arguments)}}function sr(t,e){return t===ee?e:function(){var n=t.apply(this,arguments);if(n&&typeof n.then=="function"){for(var o=this,s=arguments.length,r=new Array(s);s--;)r[s]=arguments[s];return n.then(function(){return e.apply(o,r)})}return e.apply(this,arguments)}}Qn.ModifyError=go,Qn.DexieError=Vt,Qn.BulkError=hn;var Sn={};const Pl=100,[ps,yo,ms]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,Cn(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,Cn(e),t]})(),Rl=yo&&yo.then,Xn=ps&&ps.constructor,rr=!!ms;var gs=!1,rh=ms?()=>{ms.then(qn)}:te.setImmediate?setImmediate.bind(null,qn):te.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{qn(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(qn,0)},pn=function(t,e){dn.push([t,e]),vo&&(rh(),vo=!1)},ys=!0,vo=!0,St=[],Zn=[],vs=null,xs=Tn,Ht={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:jr,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{jr(t[0],t[1])}catch{}})}},H=Ht,dn=[],Et=0,eo=[];function L(t){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ee,this._lib=!1;var e=this._PSD=H;if(qe&&(this._stackHolder=At(),this._prev=null,this._numPrev=0),typeof t!="function"){if(t!==Sn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&_s(this,this._value))}this._state=null,this._value=null,++e.ref,Dl(this,t)}const bs={get:function(){var t=H,e=xo;function n(o,s){var r=!t.global&&(t!==H||e!==xo);const a=r&&!je();var u=new L((c,d)=>{ir(this,new Ml(bo(o,t,r,a),bo(s,t,r,a),c,d,t))});return qe&&Ll(u,this),u}return n.prototype=Sn,n},set:function(t){Je(this,"then",t&&t.prototype===Sn?bs:{get:function(){return t},set:bs.set})}};function Ml(t,e,n,o,s){this.onFulfilled=typeof t=="function"?t:null,this.onRejected=typeof e=="function"?e:null,this.resolve=n,this.reject=o,this.psd=s}function Dl(t,e){try{e(n=>{if(t._state===null){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var o=t._lib&&Dn();n&&typeof n.then=="function"?Dl(t,(s,r)=>{n instanceof L?n._then(s,r):n.then(s,r)}):(t._state=!0,t._value=n,Ul(t)),o&&Un()}},_s.bind(null,t))}catch(n){_s(t,n)}}function _s(t,e){if(Zn.push(e),t._state===null){var n=t._lib&&Dn();e=xs(e),t._state=!1,t._value=e,qe&&e!==null&&typeof e=="object"&&!e._promise&&function(o,s,r){try{o.apply(null,r)}catch{}}(()=>{var o=er(e,"stack");e._promise=t,Je(e,"stack",{get:()=>gs?o&&(o.get?o.get.apply(e):o.value):t.stack})}),function(o){St.some(s=>s._value===o._value)||St.push(o)}(t),Ul(t),n&&Un()}}function Ul(t){var e=t._listeners;t._listeners=[];for(var n=0,o=e.length;n<o;++n)ir(t,e[n]);var s=t._PSD;--s.ref||s.finalize(),Et===0&&(++Et,pn(()=>{--Et==0&&ar()},[]))}function ir(t,e){if(t._state!==null){var n=t._state?e.onFulfilled:e.onRejected;if(n===null)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Et,pn(ih,[n,t,e])}else t._listeners.push(e)}function ih(t,e,n){try{vs=e;var o,s=e._value;e._state?o=t(s):(Zn.length&&(Zn=[]),o=t(s),Zn.indexOf(s)===-1&&function(r){for(var a=St.length;a;)if(St[--a]._value===r._value)return void St.splice(a,1)}(e)),n.resolve(o)}catch(r){n.reject(r)}finally{vs=null,--Et==0&&ar(),--n.psd.ref||n.psd.finalize()}}function Fl(t,e,n){if(e.length===n)return e;var o="";if(t._state===!1){var s,r,a=t._value;a!=null?(s=a.name||"Error",r=a.message||a,o=hs(a,0)):(s=a,r=""),e.push(s+(r?": "+r:"")+o)}return qe&&((o=hs(t._stackHolder,2))&&e.indexOf(o)===-1&&e.push(o),t._prev&&Fl(t._prev,e,n)),e}function Ll(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function qn(){Dn()&&Un()}function Dn(){var t=ys;return ys=!1,vo=!1,t}function Un(){var t,e,n;do for(;dn.length>0;)for(t=dn,dn=[],n=t.length,e=0;e<n;++e){var o=t[e];o[0].apply(null,o[1])}while(dn.length>0);ys=!0,vo=!0}function ar(){var t=St;St=[],t.forEach(o=>{o._PSD.onunhandled.call(null,o._value,o)});for(var e=eo.slice(0),n=e.length;n;)e[--n]()}function Vn(t){return new L(Sn,!1,t)}function ne(t,e){var n=H;return function(){var o=Dn(),s=H;try{return ht(n,!0),t.apply(this,arguments)}catch(r){e&&e(r)}finally{ht(s,!1),o&&Un()}}}Zt(L.prototype,{then:bs,_then:function(t,e){ir(this,new Ml(null,null,t,e,H))},catch:function(t){if(arguments.length===1)return this.then(null,t);var e=arguments[0],n=arguments[1];return typeof e=="function"?this.then(null,o=>o instanceof e?n(o):Vn(o)):this.then(null,o=>o&&o.name===e?n(o):Vn(o))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),Vn(e)))},stack:{get:function(){if(this._stack)return this._stack;try{gs=!0;var t=Fl(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{gs=!1}}},timeout:function(t,e){return t<1/0?new L((n,o)=>{var s=setTimeout(()=>o(new O.Timeout(e)),t);this.then(n,o).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Je(L.prototype,Symbol.toStringTag,"Dexie.Promise"),Ht.env=Gl(),Zt(L,{all:function(){var t=Oe.apply(null,arguments).map(Hn);return new L(function(e,n){t.length===0&&e([]);var o=t.length;t.forEach((s,r)=>L.resolve(s).then(a=>{t[r]=a,--o||e(t)},n))})},resolve:t=>{if(t instanceof L)return t;if(t&&typeof t.then=="function")return new L((n,o)=>{t.then(n,o)});var e=new L(Sn,!0,t);return Ll(e,vs),e},reject:Vn,race:function(){var t=Oe.apply(null,arguments).map(Hn);return new L((e,n)=>{t.map(o=>L.resolve(o).then(e,n))})},PSD:{get:()=>H,set:t=>H=t},totalEchoes:{get:()=>xo},newPSD:ft,usePSD:tn,scheduler:{get:()=>pn,set:t=>{pn=t}},rejectionMapper:{get:()=>xs,set:t=>{xs=t}},follow:(t,e)=>new L((n,o)=>ft((s,r)=>{var a=H;a.unhandleds=[],a.onunhandled=r,a.finalize=kt(function(){(function(u){function c(){u(),eo.splice(eo.indexOf(c),1)}eo.push(c),++Et,pn(()=>{--Et==0&&ar()},[])})(()=>{this.unhandleds.length===0?s():r(this.unhandleds[0])})},a.finalize),t()},e,n,o))}),Xn&&(Xn.allSettled&&Je(L,"allSettled",function(){const t=Oe.apply(null,arguments).map(Hn);return new L(e=>{t.length===0&&e([]);let n=t.length;const o=new Array(n);t.forEach((s,r)=>L.resolve(s).then(a=>o[r]={status:"fulfilled",value:a},a=>o[r]={status:"rejected",reason:a}).then(()=>--n||e(o)))})}),Xn.any&&typeof AggregateError<"u"&&Je(L,"any",function(){const t=Oe.apply(null,arguments).map(Hn);return new L((e,n)=>{t.length===0&&n(new AggregateError([]));let o=t.length;const s=new Array(o);t.forEach((r,a)=>L.resolve(r).then(u=>e(u),u=>{s[a]=u,--o||n(new AggregateError(s))}))})}));const ue={awaits:0,echoes:0,id:0};var ah=0,to=[],zo=0,xo=0,lh=0;function ft(t,e,n,o){var s=H,r=Object.create(s);r.parent=s,r.ref=0,r.global=!1,r.id=++lh;var a=Ht.env;r.env=rr?{Promise:L,PromiseProp:{value:L,configurable:!0,writable:!0},all:L.all,race:L.race,allSettled:L.allSettled,any:L.any,resolve:L.resolve,reject:L.reject,nthen:Jr(a.nthen,r),gthen:Jr(a.gthen,r)}:{},e&&ye(r,e),++s.ref,r.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=tn(r,t,n,o);return r.ref===0&&r.finalize(),u}function en(){return ue.id||(ue.id=++ah),++ue.awaits,ue.echoes+=Pl,ue.id}function je(){return!!ue.awaits&&(--ue.awaits==0&&(ue.id=0),ue.echoes=ue.awaits*Pl,!0)}function Hn(t){return ue.echoes&&t&&t.constructor===Xn?(en(),t.then(e=>(je(),e),e=>(je(),re(e)))):t}function uh(t){++xo,ue.echoes&&--ue.echoes!=0||(ue.echoes=ue.id=0),to.push(H),ht(t,!0)}function ch(){var t=to[to.length-1];to.pop(),ht(t,!1)}function ht(t,e){var n=H;if((e?!ue.echoes||zo++&&t===H:!zo||--zo&&t===H)||ql(e?uh.bind(null,t):ch),t!==H&&(H=t,n===Ht&&(Ht.env=Gl()),rr)){var o=Ht.env.Promise,s=t.env;yo.then=s.nthen,o.prototype.then=s.gthen,(n.global||t.global)&&(Object.defineProperty(te,"Promise",s.PromiseProp),o.all=s.all,o.race=s.race,o.resolve=s.resolve,o.reject=s.reject,s.allSettled&&(o.allSettled=s.allSettled),s.any&&(o.any=s.any))}}function Gl(){var t=te.Promise;return rr?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(te,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:yo.then,gthen:t.prototype.then}:{}}function tn(t,e,n,o,s){var r=H;try{return ht(t,!0),e(n,o,s)}finally{ht(r,!1)}}function ql(t){Rl.call(ps,t)}function bo(t,e,n,o){return typeof t!="function"?t:function(){var s=H;n&&en(),ht(e,!0);try{return t.apply(this,arguments)}finally{ht(s,!1),o&&ql(je)}}}function Jr(t,e){return function(n,o){return t.call(this,bo(n,e),bo(o,e))}}(""+Rl).indexOf("[native code]")===-1&&(en=je=ee);const zr="unhandledrejection";function jr(t,e){var n;try{n=e.onuncatched(t)}catch{}if(n!==!1)try{var o,s={promise:e,reason:t};if(te.document&&document.createEvent?((o=document.createEvent("Event")).initEvent(zr,!0,!0),ye(o,s)):te.CustomEvent&&ye(o=new CustomEvent(zr,{detail:s}),s),o&&te.dispatchEvent&&(dispatchEvent(o),!te.PromiseRejectionEvent&&te.onunhandledrejection))try{te.onunhandledrejection(o)}catch{}qe&&o&&!o.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}var re=L.reject;function ws(t,e,n,o){if(t.idbdb&&(t._state.openComplete||H.letThrough||t._vip)){var s=t._createTransaction(e,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(r){return r.name===or.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>ws(t,e,n,o))):re(r)}return s._promise(e,(r,a)=>ft(()=>(H.trans=s,o(r,a,s)))).then(r=>s._completion.then(()=>r))}if(t._state.openComplete)return re(new O.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return re(new O.DatabaseClosed);t.open().catch(ee)}return t._state.dbReadyPromise.then(()=>ws(t,e,n,o))}const Wr="3.2.7",vt="",Cs=-1/0,Ve="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Vl="String expected.",mn=[],Do=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),dh=Do,fh=Do,Hl=t=>!/(dexie\.js|dexie\.min\.js)/.test(t),Uo="__dbnames",jo="readonly",Wo="readwrite";function Nt(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Bl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Bn(t){return typeof t!="string"||/\./.test(t)?e=>e:e=>(e[t]===void 0&&t in e&&delete(e=Mn(e))[t],e)}class hh{_trans(e,n,o){const s=this._tx||H.trans,r=this.name;function a(c,d,f){if(!f.schema[r])throw new O.NotFound("Table "+r+" not part of transaction");return n(f.idbtrans,f)}const u=Dn();try{return s&&s.db===this.db?s===H.trans?s._promise(e,a,o):ft(()=>s._promise(e,a,o),{trans:s,transless:H.transless||H}):ws(this.db,e,[this.name],a)}finally{u&&Un()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",o=>this.core.get({trans:o,key:e}).then(s=>this.hook.reading.fire(s))).then(n)}where(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(ce(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=se(e);if(n.length===1)return this.where(n[0]).equals(e[n[0]]);const o=this.schema.indexes.concat(this.schema.primKey).filter(d=>{if(d.compound&&n.every(f=>d.keyPath.indexOf(f)>=0)){for(let f=0;f<n.length;++f)if(n.indexOf(d.keyPath[f])===-1)return!1;return!0}return!1}).sort((d,f)=>d.keyPath.length-f.keyPath.length)[0];if(o&&this.db._maxKey!==vt){const d=o.keyPath.slice(0,n.length);return this.where(d).equals(d.map(f=>e[f]))}!o&&qe&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,r=this.db._deps.indexedDB;function a(d,f){try{return r.cmp(d,f)===0}catch{return!1}}const[u,c]=n.reduce(([d,f],m)=>{const p=s[m],g=e[m];return[d||p,d||!p?Nt(f,p&&p.multi?v=>{const y=ze(v,m);return ce(y)&&y.some(x=>a(g,x))}:v=>a(g,ze(v,m))):f]},[null,null]);return u?this.where(u.name).equals(e[u.keyPath]).filter(c):o?this.filter(c):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,ce(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=o=>{if(!o)return o;const s=Object.create(e.prototype);for(var r in o)if(be(o,r))try{s[r]=o[r]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){ye(this,e)})}add(e,n){const{auto:o,keyPath:s}=this.schema.primKey;let r=e;return s&&o&&(r=Bn(s)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:n!=null?[n]:null,values:[r]})).then(a=>a.numFailures?L.reject(a.failures[0]):a.lastResult).then(a=>{if(s)try{Ne(e,s,a)}catch{}return a})}update(e,n){if(typeof e!="object"||ce(e))return this.where(":id").equals(e).modify(n);{const o=ze(e,this.schema.primKey.keyPath);if(o===void 0)return re(new O.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?se(n).forEach(s=>{Ne(e,s,n[s])}):n(e,{value:e,primKey:o})}catch{}return this.where(":id").equals(o).modify(n)}}put(e,n){const{auto:o,keyPath:s}=this.schema.primKey;let r=e;return s&&o&&(r=Bn(s)(e)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[r],keys:n!=null?[n]:null})).then(a=>a.numFailures?L.reject(a.failures[0]):a.lastResult).then(a=>{if(s)try{Ne(e,s,a)}catch{}return a})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?L.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Bl})).then(e=>e.numFailures?L.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(o=>o.map(s=>this.hook.reading.fire(s))))}bulkAdd(e,n,o){const s=Array.isArray(n)?n:void 0,r=(o=o||(s?void 0:n))?o.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:u,keyPath:c}=this.schema.primKey;if(c&&s)throw new O.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new O.InvalidArgument("Arguments objects and keys must have the same length");const d=e.length;let f=c&&u?e.map(Bn(c)):e;return this.core.mutate({trans:a,type:"add",keys:s,values:f,wantResults:r}).then(({numFailures:m,results:p,lastResult:g,failures:v})=>{if(m===0)return r?p:g;throw new hn(`${this.name}.bulkAdd(): ${m} of ${d} operations failed`,v)})})}bulkPut(e,n,o){const s=Array.isArray(n)?n:void 0,r=(o=o||(s?void 0:n))?o.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:u,keyPath:c}=this.schema.primKey;if(c&&s)throw new O.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new O.InvalidArgument("Arguments objects and keys must have the same length");const d=e.length;let f=c&&u?e.map(Bn(c)):e;return this.core.mutate({trans:a,type:"put",keys:s,values:f,wantResults:r}).then(({numFailures:m,results:p,lastResult:g,failures:v})=>{if(m===0)return r?p:g;throw new hn(`${this.name}.bulkPut(): ${m} of ${d} operations failed`,v)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",o=>this.core.mutate({trans:o,type:"delete",keys:e})).then(({numFailures:o,lastResult:s,failures:r})=>{if(o===0)return s;throw new hn(`${this.name}.bulkDelete(): ${o} of ${n} operations failed`,r)})}}function gn(t){var e={},n=function(a,u){if(u){for(var c=arguments.length,d=new Array(c-1);--c;)d[c-1]=arguments[c];return e[a].subscribe.apply(null,d),t}if(typeof a=="string")return e[a]};n.addEventType=r;for(var o=1,s=arguments.length;o<s;++o)r(arguments[o]);return n;function r(a,u,c){if(typeof a!="object"){var d;u||(u=sh),c||(c=ee);var f={subscribers:[],fire:c,subscribe:function(m){f.subscribers.indexOf(m)===-1&&(f.subscribers.push(m),f.fire=u(f.fire,m))},unsubscribe:function(m){f.subscribers=f.subscribers.filter(function(p){return p!==m}),f.fire=f.subscribers.reduce(u,c)}};return e[a]=n[a]=f,f}se(d=a).forEach(function(m){var p=d[m];if(ce(p))r(m,d[m][0],d[m][1]);else{if(p!=="asap")throw new O.InvalidArgument("Invalid event config");var g=r(m,Tn,function(){for(var v=arguments.length,y=new Array(v);v--;)y[v]=arguments[v];g.subscribers.forEach(function(x){wl(function(){x.apply(null,y)})})})}})}}function rn(t,e){return qt(e).from({prototype:t}),e}function Rt(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Yo(t,e){t.filter=Nt(t.filter,e)}function Qo(t,e,n){var o=t.replayFilter;t.replayFilter=o?()=>Nt(o(),e()):e,t.justLimit=n&&!o}function no(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new O.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Yr(t,e,n){const o=no(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:t.dir==="prev",unique:!!t.unique,query:{index:o,range:t.range}})}function $n(t,e,n,o){const s=t.replayFilter?Nt(t.filter,t.replayFilter()):t.filter;if(t.or){const r={},a=(u,c,d)=>{if(!s||s(c,d,p=>c.stop(p),p=>c.fail(p))){var f=c.primaryKey,m=""+f;m==="[object ArrayBuffer]"&&(m=""+new Uint8Array(f)),be(r,m)||(r[m]=!0,e(u,c,d))}};return Promise.all([t.or._iterate(a,n),Qr(Yr(t,o,n),t.algorithm,a,!t.keysOnly&&t.valueMapper)])}return Qr(Yr(t,o,n),Nt(t.algorithm,s),e,!t.keysOnly&&t.valueMapper)}function Qr(t,e,n,o){var s=ne(o?(r,a,u)=>n(o(r),a,u):n);return t.then(r=>{if(r)return r.start(()=>{var a=()=>r.continue();e&&!e(r,u=>a=u,u=>{r.stop(u),a=ee},u=>{r.fail(u),a=ee})||s(r.value,r,u=>a=u),a()})})}function me(t,e){try{const n=Xr(t),o=Xr(e);if(n!==o)return n==="Array"?1:o==="Array"?-1:n==="binary"?1:o==="binary"?-1:n==="string"?1:o==="string"?-1:n==="Date"?1:o!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(s,r){const a=s.length,u=r.length,c=a<u?a:u;for(let d=0;d<c;++d)if(s[d]!==r[d])return s[d]<r[d]?-1:1;return a===u?0:a<u?-1:1}(Zr(t),Zr(e));case"Array":return function(s,r){const a=s.length,u=r.length,c=a<u?a:u;for(let d=0;d<c;++d){const f=me(s[d],r[d]);if(f!==0)return f}return a===u?0:a<u?-1:1}(t,e)}}catch{}return NaN}function Xr(t){const e=typeof t;if(e!=="object")return e;if(ArrayBuffer.isView(t))return"binary";const n=ds(t);return n==="ArrayBuffer"?"binary":n}function Zr(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class ph{_read(e,n){var o=this._ctx;return o.error?o.table._trans(null,re.bind(null,o.error)):o.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,re.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Nt(n.algorithm,e)}_iterate(e,n){return $n(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return e&&ye(o,e),n._ctx=o,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(o=>$n(n,e,o,n.table.core))}count(e){return this._read(n=>{const o=this._ctx,s=o.table.core;if(Rt(o,!0))return s.count({trans:n,query:{index:no(o,s.schema),range:o.range}}).then(a=>Math.min(a,o.limit));var r=0;return $n(o,()=>(++r,!1),n,s).then(()=>r)}).then(e)}sortBy(e,n){const o=e.split(".").reverse(),s=o[0],r=o.length-1;function a(d,f){return f?a(d[o[f]],f-1):d[s]}var u=this._ctx.dir==="next"?1:-1;function c(d,f){var m=a(d,r),p=a(f,r);return m<p?-u:m>p?u:0}return this.toArray(function(d){return d.sort(c)}).then(n)}toArray(e){return this._read(n=>{var o=this._ctx;if(o.dir==="next"&&Rt(o,!0)&&o.limit>0){const{valueMapper:s}=o,r=no(o,o.table.core.schema);return o.table.core.query({trans:n,limit:o.limit,values:!0,query:{index:r,range:o.range}}).then(({result:a})=>s?a.map(s):a)}{const s=[];return $n(o,r=>s.push(r),n,o.table.core).then(()=>s)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,Rt(n)?Qo(n,()=>{var o=e;return(s,r)=>o===0||(o===1?(--o,!1):(r(()=>{s.advance(o),o=0}),!1))}):Qo(n,()=>{var o=e;return()=>--o<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Qo(this._ctx,()=>{var n=e;return function(o,s,r){return--n<=0&&s(r),n>=0}},!0),this}until(e,n){return Yo(this._ctx,function(o,s,r){return!e(o.value)||(s(r),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n,o;return Yo(this._ctx,function(s){return e(s.value)}),n=this._ctx,o=e,n.isMatch=Nt(n.isMatch,o),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(o,s){e(s.key,s)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(o,s){e(s.primaryKey,s)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var o=[];return this.each(function(s,r){o.push(r.key)}).then(function(){return o}).then(e)}primaryKeys(e){var n=this._ctx;if(n.dir==="next"&&Rt(n,!0)&&n.limit>0)return this._read(s=>{var r=no(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:r,range:n.range}})}).then(({result:s})=>s).then(e);n.keysOnly=!n.isMatch;var o=[];return this.each(function(s,r){o.push(r.primaryKey)}).then(function(){return o}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var o={};return Yo(this._ctx,function(s){var r=s.primaryKey.toString(),a=be(o,r);return o[r]=!0,!a}),this}modify(e){var n=this._ctx;return this._write(o=>{var s;if(typeof e=="function")s=e;else{var r=se(e),a=r.length;s=function(y){for(var x=!1,b=0;b<a;++b){var _=r[b],w=e[_];ze(y,_)!==w&&(Ne(y,_,w),x=!0)}return x}}const u=n.table.core,{outbound:c,extractKey:d}=u.schema.primaryKey,f=this.db._options.modifyChunkSize||200,m=[];let p=0;const g=[],v=(y,x)=>{const{failures:b,numFailures:_}=x;p+=y-_;for(let w of se(b))m.push(b[w])};return this.clone().primaryKeys().then(y=>{const x=b=>{const _=Math.min(f,y.length-b);return u.getMany({trans:o,keys:y.slice(b,b+_),cache:"immutable"}).then(w=>{const C=[],I=[],k=c?[]:null,T=[];for(let E=0;E<_;++E){const R=w[E],A={value:Mn(R),primKey:y[b+E]};s.call(A,A.value,A)!==!1&&(A.value==null?T.push(y[b+E]):c||me(d(R),d(A.value))===0?(I.push(A.value),c&&k.push(y[b+E])):(T.push(y[b+E]),C.push(A.value)))}const U=Rt(n)&&n.limit===1/0&&(typeof e!="function"||e===Xo)&&{index:n.index,range:n.range};return Promise.resolve(C.length>0&&u.mutate({trans:o,type:"add",values:C}).then(E=>{for(let R in E.failures)T.splice(parseInt(R),1);v(C.length,E)})).then(()=>(I.length>0||U&&typeof e=="object")&&u.mutate({trans:o,type:"put",keys:k,values:I,criteria:U,changeSpec:typeof e!="function"&&e}).then(E=>v(I.length,E))).then(()=>(T.length>0||U&&e===Xo)&&u.mutate({trans:o,type:"delete",keys:T,criteria:U}).then(E=>v(T.length,E))).then(()=>y.length>b+_&&x(b+f))})};return x(0).then(()=>{if(m.length>0)throw new go("Error modifying one or more objects",m,p,g);return y.length})})})}delete(){var e=this._ctx,n=e.range;return Rt(e)&&(e.isPrimKey&&!fh||n.type===3)?this._write(o=>{const{primaryKey:s}=e.table.core.schema,r=n;return e.table.core.count({trans:o,query:{index:s,range:r}}).then(a=>e.table.core.mutate({trans:o,type:"deleteRange",range:r}).then(({failures:u,lastResult:c,results:d,numFailures:f})=>{if(f)throw new go("Could not delete some values",Object.keys(u).map(m=>u[m]),a-f);return a-f}))}):this.modify(Xo)}}const Xo=(t,e)=>e.value=null;function mh(t,e){return t<e?-1:t===e?0:1}function gh(t,e){return t>e?-1:t===e?0:1}function xe(t,e,n){var o=t instanceof Ol?new t.Collection(t):t;return o._ctx.error=n?new n(e):new TypeError(e),o}function Mt(t){return new t.Collection(t,()=>$l("")).limit(0)}function yh(t,e,n,o,s,r){for(var a=Math.min(t.length,o.length),u=-1,c=0;c<a;++c){var d=e[c];if(d!==o[c])return s(t[c],n[c])<0?t.substr(0,c)+n[c]+n.substr(c+1):s(t[c],o[c])<0?t.substr(0,c)+o[c]+n.substr(c+1):u>=0?t.substr(0,u)+e[u]+n.substr(u+1):null;s(t[c],d)<0&&(u=c)}return a<o.length&&r==="next"?t+n.substr(t.length):a<t.length&&r==="prev"?t.substr(0,n.length):u<0?null:t.substr(0,u)+o[u]+n.substr(u+1)}function On(t,e,n,o){var s,r,a,u,c,d,f,m=n.length;if(!n.every(y=>typeof y=="string"))return xe(t,Vl);function p(y){s=function(b){return b==="next"?_=>_.toUpperCase():_=>_.toLowerCase()}(y),r=function(b){return b==="next"?_=>_.toLowerCase():_=>_.toUpperCase()}(y),a=y==="next"?mh:gh;var x=n.map(function(b){return{lower:r(b),upper:s(b)}}).sort(function(b,_){return a(b.lower,_.lower)});u=x.map(function(b){return b.upper}),c=x.map(function(b){return b.lower}),d=y,f=y==="next"?"":o}p("next");var g=new t.Collection(t,()=>tt(u[0],c[m-1]+o));g._ondirectionchange=function(y){p(y)};var v=0;return g._addAlgorithm(function(y,x,b){var _=y.key;if(typeof _!="string")return!1;var w=r(_);if(e(w,c,v))return!0;for(var C=null,I=v;I<m;++I){var k=yh(_,w,u[I],c[I],a,d);k===null&&C===null?v=I+1:(C===null||a(C,k)>0)&&(C=k)}return x(C!==null?function(){y.continue(C+f)}:b),!1}),g}function tt(t,e,n,o){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:o}}function $l(t){return{type:1,lower:t,upper:t}}class Ol{get Collection(){return this._ctx.table.db.Collection}between(e,n,o,s){o=o!==!1,s=s===!0;try{return this._cmp(e,n)>0||this._cmp(e,n)===0&&(o||s)&&(!o||!s)?Mt(this):new this.Collection(this,()=>tt(e,n,!o,!s))}catch{return xe(this,Ve)}}equals(e){return e==null?xe(this,Ve):new this.Collection(this,()=>$l(e))}above(e){return e==null?xe(this,Ve):new this.Collection(this,()=>tt(e,void 0,!0))}aboveOrEqual(e){return e==null?xe(this,Ve):new this.Collection(this,()=>tt(e,void 0,!1))}below(e){return e==null?xe(this,Ve):new this.Collection(this,()=>tt(void 0,e,!1,!0))}belowOrEqual(e){return e==null?xe(this,Ve):new this.Collection(this,()=>tt(void 0,e))}startsWith(e){return typeof e!="string"?xe(this,Vl):this.between(e,e+vt,!0,!0)}startsWithIgnoreCase(e){return e===""?this.startsWith(e):On(this,(n,o)=>n.indexOf(o[0])===0,[e],vt)}equalsIgnoreCase(e){return On(this,(n,o)=>n===o[0],[e],"")}anyOfIgnoreCase(){var e=Oe.apply(Dt,arguments);return e.length===0?Mt(this):On(this,(n,o)=>o.indexOf(n)!==-1,e,"")}startsWithAnyOfIgnoreCase(){var e=Oe.apply(Dt,arguments);return e.length===0?Mt(this):On(this,(n,o)=>o.some(s=>n.indexOf(s)===0),e,vt)}anyOf(){const e=Oe.apply(Dt,arguments);let n=this._cmp;try{e.sort(n)}catch{return xe(this,Ve)}if(e.length===0)return Mt(this);const o=new this.Collection(this,()=>tt(e[0],e[e.length-1]));o._ondirectionchange=r=>{n=r==="next"?this._ascending:this._descending,e.sort(n)};let s=0;return o._addAlgorithm((r,a,u)=>{const c=r.key;for(;n(c,e[s])>0;)if(++s,s===e.length)return a(u),!1;return n(c,e[s])===0||(a(()=>{r.continue(e[s])}),!1)}),o}notEqual(e){return this.inAnyRange([[Cs,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=Oe.apply(Dt,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return xe(this,Ve)}const n=e.reduce((o,s)=>o?o.concat([[o[o.length-1][1],s]]):[[Cs,s]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const o=this._cmp,s=this._ascending,r=this._descending,a=this._min,u=this._max;if(e.length===0)return Mt(this);if(!e.every(_=>_[0]!==void 0&&_[1]!==void 0&&s(_[0],_[1])<=0))return xe(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",O.InvalidArgument);const c=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0;let f,m=s;function p(_,w){return m(_[0],w[0])}try{f=e.reduce(function(_,w){let C=0,I=_.length;for(;C<I;++C){const k=_[C];if(o(w[0],k[1])<0&&o(w[1],k[0])>0){k[0]=a(k[0],w[0]),k[1]=u(k[1],w[1]);break}}return C===I&&_.push(w),_},[]),f.sort(p)}catch{return xe(this,Ve)}let g=0;const v=d?_=>s(_,f[g][1])>0:_=>s(_,f[g][1])>=0,y=c?_=>r(_,f[g][0])>0:_=>r(_,f[g][0])>=0;let x=v;const b=new this.Collection(this,()=>tt(f[0][0],f[f.length-1][1],!c,!d));return b._ondirectionchange=_=>{_==="next"?(x=v,m=s):(x=y,m=r),f.sort(p)},b._addAlgorithm((_,w,C)=>{for(var I=_.key;x(I);)if(++g,g===f.length)return w(C),!1;return!!function(k){return!v(k)&&!y(k)}(I)||(this._cmp(I,f[g][1])===0||this._cmp(I,f[g][0])===0||w(()=>{m===s?_.continue(f[g][0]):_.continue(f[g][1])}),!1)}),b}startsWithAnyOf(){const e=Oe.apply(Dt,arguments);return e.every(n=>typeof n=="string")?e.length===0?Mt(this):this.inAnyRange(e.map(n=>[n,n+vt])):xe(this,"startsWithAnyOf() only works with strings")}}function De(t){return ne(function(e){return En(e),t(e.target.error),!1})}function En(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const In="storagemutated",ot="x-storagemutated-1",pt=gn(null,In);class vh{_lock(){return cn(!H.global),++this._reculock,this._reculock!==1||H.global||(H.lockOwnerFor=this),this}_unlock(){if(cn(!H.global),--this._reculock==0)for(H.global||(H.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{tn(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&H.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,o=this.db._state.dbOpenError;if(cn(!this.idbtrans),!e&&!n)switch(o&&o.name){case"DatabaseClosedError":throw new O.DatabaseClosed(o);case"MissingAPIError":throw new O.MissingAPI(o.message,o);default:throw new O.OpenFailed(o)}if(!this.active)throw new O.TransactionInactive;return cn(this._completion._state===null),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=ne(s=>{En(s),this._reject(e.error)}),e.onabort=ne(s=>{En(s),this.active&&this._reject(new O.Abort(e.error)),this.active=!1,this.on("abort").fire(s)}),e.oncomplete=ne(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&pt.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,o){if(e==="readwrite"&&this.mode!=="readwrite")return re(new O.ReadOnly("Transaction is readonly"));if(!this.active)return re(new O.TransactionInactive);if(this._locked())return new L((r,a)=>{this._blockedFuncs.push([()=>{this._promise(e,n,o).then(r,a)},H])});if(o)return ft(()=>{var r=new L((a,u)=>{this._lock();const c=n(a,u,this);c&&c.then&&c.then(a,u)});return r.finally(()=>this._unlock()),r._lib=!0,r});var s=new L((r,a)=>{var u=n(r,a,this);u&&u.then&&u.then(r,a)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const o=L.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>o);else{n._waitingFor=o,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);(function a(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=a)})()}var r=n._waitingFor;return new L((a,u)=>{o.then(c=>n._waitingQueue.push(ne(a.bind(null,c))),c=>n._waitingQueue.push(ne(u.bind(null,c)))).finally(()=>{n._waitingFor===r&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new O.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(be(n,e))return n[e];const o=this.schema[e];if(!o)throw new O.NotFound("Table "+e+" not part of transaction");const s=new this.db.Table(e,o,this);return s.core=this.db.core.table(e),n[e]=s,s}}function Ts(t,e,n,o,s,r,a){return{name:t,keyPath:e,unique:n,multi:o,auto:s,compound:r,src:(n&&!a?"&":"")+(o?"*":"")+(s?"++":"")+Kl(e)}}function Kl(t){return typeof t=="string"?t:t?"["+[].join.call(t,"+")+"]":""}function Jl(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:Cl(n,o=>[o.name,o])}}let kn=t=>{try{return t.only([[]]),kn=()=>[[]],[[]]}catch{return kn=()=>vt,vt}};function Ss(t){return t==null?()=>{}:typeof t=="string"?function(e){return e.split(".").length===1?o=>o[e]:o=>ze(o,e)}(t):e=>ze(e,t)}function ei(t){return[].slice.call(t)}let xh=0;function yn(t){return t==null?":id":typeof t=="string"?t:`[${t.join("+")}]`}function bh(t,e,n){function o(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:d,upper:f,lowerOpen:m,upperOpen:p}=c;return d===void 0?f===void 0?null:e.upperBound(f,!!p):f===void 0?e.lowerBound(d,!!m):e.bound(d,f,!!m,!!p)}const{schema:s,hasGetAll:r}=function(c,d){const f=ei(c.objectStoreNames);return{schema:{name:c.name,tables:f.map(m=>d.objectStore(m)).map(m=>{const{keyPath:p,autoIncrement:g}=m,v=ce(p),y=p==null,x={},b={name:m.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y,compound:v,keyPath:p,autoIncrement:g,unique:!0,extractKey:Ss(p)},indexes:ei(m.indexNames).map(_=>m.index(_)).map(_=>{const{name:w,unique:C,multiEntry:I,keyPath:k}=_,T={name:w,compound:ce(k),keyPath:k,unique:C,multiEntry:I,extractKey:Ss(k)};return x[yn(k)]=T,T}),getIndexByKeyPath:_=>x[yn(_)]};return x[":id"]=b.primaryKey,p!=null&&(x[yn(p)]=b.primaryKey),b})},hasGetAll:f.length>0&&"getAll"in d.objectStore(f[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),a=s.tables.map(c=>function(d){const f=d.name;return{name:f,schema:d,mutate:function({trans:m,type:p,keys:g,values:v,range:y}){return new Promise((x,b)=>{x=ne(x);const _=m.objectStore(f),w=_.keyPath==null,C=p==="put"||p==="add";if(!C&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:I}=g||v||{length:1};if(g&&v&&g.length!==v.length)throw new Error("Given keys array must have same length as given values array.");if(I===0)return x({numFailures:0,failures:{},results:[],lastResult:void 0});let k;const T=[],U=[];let E=0;const R=z=>{++E,En(z)};if(p==="deleteRange"){if(y.type===4)return x({numFailures:E,failures:U,results:[],lastResult:void 0});y.type===3?T.push(k=_.clear()):T.push(k=_.delete(o(y)))}else{const[z,V]=C?w?[v,g]:[v,null]:[g,null];if(C)for(let j=0;j<I;++j)T.push(k=V&&V[j]!==void 0?_[p](z[j],V[j]):_[p](z[j])),k.onerror=R;else for(let j=0;j<I;++j)T.push(k=_[p](z[j])),k.onerror=R}const A=z=>{const V=z.target.result;T.forEach((j,q)=>j.error!=null&&(U[q]=j.error)),x({numFailures:E,failures:U,results:p==="delete"?g:T.map(j=>j.result),lastResult:V})};k.onerror=z=>{R(z),A(z)},k.onsuccess=A})},getMany:({trans:m,keys:p})=>new Promise((g,v)=>{g=ne(g);const y=m.objectStore(f),x=p.length,b=new Array(x);let _,w=0,C=0;const I=T=>{const U=T.target;b[U._pos]=U.result,++C===w&&g(b)},k=De(v);for(let T=0;T<x;++T)p[T]!=null&&(_=y.get(p[T]),_._pos=T,_.onsuccess=I,_.onerror=k,++w);w===0&&g(b)}),get:({trans:m,key:p})=>new Promise((g,v)=>{g=ne(g);const y=m.objectStore(f).get(p);y.onsuccess=x=>g(x.target.result),y.onerror=De(v)}),query:function(m){return p=>new Promise((g,v)=>{g=ne(g);const{trans:y,values:x,limit:b,query:_}=p,w=b===1/0?void 0:b,{index:C,range:I}=_,k=y.objectStore(f),T=C.isPrimaryKey?k:k.index(C.name),U=o(I);if(b===0)return g({result:[]});if(m){const E=x?T.getAll(U,w):T.getAllKeys(U,w);E.onsuccess=R=>g({result:R.target.result}),E.onerror=De(v)}else{let E=0;const R=x||!("openKeyCursor"in T)?T.openCursor(U):T.openKeyCursor(U),A=[];R.onsuccess=z=>{const V=R.result;return V?(A.push(x?V.value:V.primaryKey),++E===b?g({result:A}):void V.continue()):g({result:A})},R.onerror=De(v)}})}(r),openCursor:function({trans:m,values:p,query:g,reverse:v,unique:y}){return new Promise((x,b)=>{x=ne(x);const{index:_,range:w}=g,C=m.objectStore(f),I=_.isPrimaryKey?C:C.index(_.name),k=v?y?"prevunique":"prev":y?"nextunique":"next",T=p||!("openKeyCursor"in I)?I.openCursor(o(w),k):I.openKeyCursor(o(w),k);T.onerror=De(b),T.onsuccess=ne(U=>{const E=T.result;if(!E)return void x(null);E.___id=++xh,E.done=!1;const R=E.continue.bind(E);let A=E.continuePrimaryKey;A&&(A=A.bind(E));const z=E.advance.bind(E),V=()=>{throw new Error("Cursor not stopped")};E.trans=m,E.stop=E.continue=E.continuePrimaryKey=E.advance=()=>{throw new Error("Cursor not started")},E.fail=ne(b),E.next=function(){let j=1;return this.start(()=>j--?this.continue():this.stop()).then(()=>this)},E.start=j=>{const q=new Promise((P,W)=>{P=ne(P),T.onerror=De(W),E.fail=W,E.stop=Z=>{E.stop=E.continue=E.continuePrimaryKey=E.advance=V,P(Z)}}),$=()=>{if(T.result)try{j()}catch(P){E.fail(P)}else E.done=!0,E.start=()=>{throw new Error("Cursor behind last entry")},E.stop()};return T.onsuccess=ne(P=>{T.onsuccess=$,$()}),E.continue=R,E.continuePrimaryKey=A,E.advance=z,$(),q},x(E)},b)})},count({query:m,trans:p}){const{index:g,range:v}=m;return new Promise((y,x)=>{const b=p.objectStore(f),_=g.isPrimaryKey?b:b.index(g.name),w=o(v),C=w?_.count(w):_.count();C.onsuccess=ne(I=>y(I.target.result)),C.onerror=De(x)})}}}(c)),u={};return a.forEach(c=>u[c.name]=c),{stack:"dbcore",transaction:t.transaction.bind(t),table(c){if(!u[c])throw new Error(`Table '${c}' not found`);return u[c]},MIN_KEY:-1/0,MAX_KEY:kn(e),schema:s}}function Es({_novip:t},e){const n=e.db,o=function(s,r,{IDBKeyRange:a,indexedDB:u},c){return{dbcore:function(f,m){return m.reduce((p,{create:g})=>({...p,...g(p)}),f)}(bh(r,a,c),s.dbcore)}}(t._middlewares,n,t._deps,e);t.core=o.dbcore,t.tables.forEach(s=>{const r=s.name;t.core.schema.tables.some(a=>a.name===r)&&(s.core=t.core.table(r),t[r]instanceof t.Table&&(t[r].core=s.core))})}function _o({_novip:t},e,n,o){n.forEach(s=>{const r=o[s];e.forEach(a=>{const u=er(a,s);(!u||"value"in u&&u.value===void 0)&&(a===t.Transaction.prototype||a instanceof t.Transaction?Je(a,s,{get(){return this.table(s)},set(c){bl(this,s,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):a[s]=new t.Table(s,r))})})}function Is({_novip:t},e){e.forEach(n=>{for(let o in n)n[o]instanceof t.Table&&delete n[o]})}function _h(t,e){return t._cfg.version-e._cfg.version}function wh(t,e,n,o){const s=t._dbSchema,r=t._createTransaction("readwrite",t._storeNames,s);r.create(n),r._completion.catch(o);const a=r._reject.bind(r),u=H.transless||H;ft(()=>{H.trans=r,H.transless=u,e===0?(se(s).forEach(c=>{Zo(n,c,s[c].primKey,s[c].indexes)}),Es(t,n),L.follow(()=>t.on.populate.fire(r)).catch(a)):function({_novip:c},d,f,m){const p=[],g=c._versions;let v=c._dbSchema=Ns(c,c.idbdb,m),y=!1;const x=g.filter(_=>_._cfg.version>=d);function b(){return p.length?L.resolve(p.shift()(f.idbtrans)).then(b):L.resolve()}return x.forEach(_=>{p.push(()=>{const w=v,C=_._cfg.dbschema;As(c,w,m),As(c,C,m),v=c._dbSchema=C;const I=zl(w,C);I.add.forEach(T=>{Zo(m,T[0],T[1].primKey,T[1].indexes)}),I.change.forEach(T=>{if(T.recreate)throw new O.Upgrade("Not yet support for changing primary key");{const U=m.objectStore(T.name);T.add.forEach(E=>ks(U,E)),T.change.forEach(E=>{U.deleteIndex(E.name),ks(U,E)}),T.del.forEach(E=>U.deleteIndex(E))}});const k=_._cfg.contentUpgrade;if(k&&_._cfg.version>d){Es(c,m),f._memoizedTables={},y=!0;let T=Tl(C);I.del.forEach(A=>{T[A]=w[A]}),Is(c,[c.Transaction.prototype]),_o(c,[c.Transaction.prototype],se(T),T),f.schema=T;const U=tr(k);let E;U&&en();const R=L.follow(()=>{if(E=k(f),E&&U){var A=je.bind(null,null);E.then(A,A)}});return E&&typeof E.then=="function"?L.resolve(E):R.then(()=>E)}}),p.push(w=>{(!y||!dh)&&function(C,I){[].slice.call(I.db.objectStoreNames).forEach(k=>C[k]==null&&I.db.deleteObjectStore(k))}(_._cfg.dbschema,w),Is(c,[c.Transaction.prototype]),_o(c,[c.Transaction.prototype],c._storeNames,c._dbSchema),f.schema=c._dbSchema})}),b().then(()=>{var _,w;w=m,se(_=v).forEach(C=>{w.db.objectStoreNames.contains(C)||Zo(w,C,_[C].primKey,_[C].indexes)})})}(t,e,r,n).catch(a)})}function zl(t,e){const n={del:[],add:[],change:[]};let o;for(o in t)e[o]||n.del.push(o);for(o in e){const s=t[o],r=e[o];if(s){const a={name:o,def:r,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(r.primKey.keyPath||"")||s.primKey.auto!==r.primKey.auto&&!Do)a.recreate=!0,n.change.push(a);else{const u=s.idxByName,c=r.idxByName;let d;for(d in u)c[d]||a.del.push(d);for(d in c){const f=u[d],m=c[d];f?f.src!==m.src&&a.change.push(m):a.add.push(m)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([o,r])}return n}function Zo(t,e,n,o){const s=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return o.forEach(r=>ks(s,r)),s}function ks(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function Ns(t,e,n){const o={};return mo(e.objectStoreNames,0).forEach(s=>{const r=n.objectStore(s);let a=r.keyPath;const u=Ts(Kl(a),a||"",!1,!1,!!r.autoIncrement,a&&typeof a!="string",!0),c=[];for(let f=0;f<r.indexNames.length;++f){const m=r.index(r.indexNames[f]);a=m.keyPath;var d=Ts(m.name,a,!!m.unique,!!m.multiEntry,!1,a&&typeof a!="string",!1);c.push(d)}o[s]=Jl(s,u,c)}),o}function As({_novip:t},e,n){const o=n.db.objectStoreNames;for(let s=0;s<o.length;++s){const r=o[s],a=n.objectStore(r);t._hasGetAll="getAll"in a;for(let u=0;u<a.indexNames.length;++u){const c=a.indexNames[u],d=a.index(c).keyPath,f=typeof d=="string"?d:"["+mo(d).join("+")+"]";if(e[r]){const m=e[r].idxByName[f];m&&(m.name=c,delete e[r].idxByName[f],e[r].idxByName[c]=m)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&te.WorkerGlobalScope&&te instanceof te.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Ch{_parseStoresSpec(e,n){se(e).forEach(o=>{if(e[o]!==null){var s=e[o].split(",").map((a,u)=>{const c=(a=a.trim()).replace(/([&*]|\+\+)/g,""),d=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return Ts(c,d||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),ce(d),u===0)}),r=s.shift();if(r.multi)throw new O.Schema("Primary key cannot be multi-valued");s.forEach(a=>{if(a.auto)throw new O.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new O.Schema("Index must have a name and cannot be an empty string")}),n[o]=Jl(o,r,s)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?ye(this._cfg.storesSource,e):e;const o=n._versions,s={};let r={};return o.forEach(a=>{ye(s,a._cfg.storesSource),r=a._cfg.dbschema={},a._parseStoresSpec(s,r)}),n._dbSchema=r,Is(n,[n._allTables,n,n.Transaction.prototype]),_o(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],se(r),r),n._storeNames=se(r),this}upgrade(e){return this._cfg.contentUpgrade=sr(this._cfg.contentUpgrade||ee,e),this}}function lr(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new It(Uo,{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function ur(t){return t&&typeof t.databases=="function"}function Ps(t){return ft(function(){return H.letThrough=!0,t()})}function Th(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Sh(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?re(e.dbOpenError):t);qe&&(e.openCanceller._stackHolder=At()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const o=e.openCanceller;function s(){if(e.openCanceller!==o)throw new O.DatabaseClosed("db.open() was cancelled")}let r=e.dbReadyResolve,a=null,u=!1;const c=()=>new L((d,f)=>{if(s(),!n)throw new O.MissingAPI;const m=t.name,p=e.autoSchema?n.open(m):n.open(m,Math.round(10*t.verno));if(!p)throw new O.MissingAPI;p.onerror=De(f),p.onblocked=ne(t._fireOnBlocked),p.onupgradeneeded=ne(g=>{if(a=p.transaction,e.autoSchema&&!t._options.allowEmptyDB){p.onerror=En,a.abort(),p.result.close();const y=n.deleteDatabase(m);y.onsuccess=y.onerror=ne(()=>{f(new O.NoSuchDatabase(`Database ${m} doesnt exist`))})}else{a.onerror=De(f);var v=g.oldVersion>Math.pow(2,62)?0:g.oldVersion;u=v<1,t._novip.idbdb=p.result,wh(t,v/10,a,f)}},f),p.onsuccess=ne(()=>{a=null;const g=t._novip.idbdb=p.result,v=mo(g.objectStoreNames);if(v.length>0)try{const x=g.transaction((y=v).length===1?y[0]:y,"readonly");e.autoSchema?function({_novip:b},_,w){b.verno=_.version/10;const C=b._dbSchema=Ns(0,_,w);b._storeNames=mo(_.objectStoreNames,0),_o(b,[b._allTables],se(C),C)}(t,g,x):(As(t,t._dbSchema,x),function(b,_){const w=zl(Ns(0,b.idbdb,_),b._dbSchema);return!(w.add.length||w.change.some(C=>C.add.length||C.change.length))}(t,x)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Es(t,x)}catch{}var y;mn.push(t),g.onversionchange=ne(x=>{e.vcFired=!0,t.on("versionchange").fire(x)}),g.onclose=ne(x=>{t.on("close").fire(x)}),u&&function({indexedDB:x,IDBKeyRange:b},_){!ur(x)&&_!==Uo&&lr(x,b).put({name:_}).catch(ee)}(t._deps,m),d()},f)}).catch(d=>d&&d.name==="UnknownError"&&e.PR1398_maxLoop>0?(e.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c()):L.reject(d));return L.race([o,(typeof navigator>"u"?L.resolve():Th()).then(c)]).then(()=>(s(),e.onReadyBeingFired=[],L.resolve(Ps(()=>t.on.ready.fire(t.vip))).then(function d(){if(e.onReadyBeingFired.length>0){let f=e.onReadyBeingFired.reduce(sr,ee);return e.onReadyBeingFired=[],L.resolve(Ps(()=>f(t.vip))).then(d)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(d=>{e.dbOpenError=d;try{a&&a.abort()}catch{}return o===e.openCanceller&&t._close(),re(d)}).finally(()=>{e.openComplete=!0,r()})}function Rs(t){var e=r=>t.next(r),n=s(e),o=s(r=>t.throw(r));function s(r){return a=>{var u=r(a),c=u.value;return u.done?c:c&&typeof c.then=="function"?c.then(n,o):ce(c)?Promise.all(c).then(n,o):n(c)}}return s(e)()}function Eh(t,e,n){var o=arguments.length;if(o<2)throw new O.InvalidArgument("Too few arguments");for(var s=new Array(o-1);--o;)s[o-1]=arguments[o];return n=s.pop(),[t,Sl(s),n]}function jl(t,e,n,o,s){return L.resolve().then(()=>{const r=H.transless||H,a=t._createTransaction(e,n,t._dbSchema,o),u={trans:a,transless:r};if(o)a.idbtrans=o.idbtrans;else try{a.create(),t._state.PR1398_maxLoop=3}catch(m){return m.name===or.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>jl(t,e,n,null,s))):re(m)}const c=tr(s);let d;c&&en();const f=L.follow(()=>{if(d=s.call(a,a),d)if(c){var m=je.bind(null,null);d.then(m,m)}else typeof d.next=="function"&&typeof d.throw=="function"&&(d=Rs(d))},u);return(d&&typeof d.then=="function"?L.resolve(d).then(m=>a.active?m:re(new O.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):f.then(()=>d)).then(m=>(o&&a._resolve(),a._completion.then(()=>m))).catch(m=>(a._reject(m),re(m)))})}function Kn(t,e,n){const o=ce(t)?t.slice():[t];for(let s=0;s<n;++s)o.push(e);return o}const Ih={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:o}=n,s={},r=[];function a(f,m,p){const g=yn(f),v=s[g]=s[g]||[],y=f==null?0:typeof f=="string"?1:f.length,x=m>0,b={...p,isVirtual:x,keyTail:m,keyLength:y,extractKey:Ss(f),unique:!x&&p.unique};return v.push(b),b.isPrimaryKey||r.push(b),y>1&&a(y===2?f[0]:f.slice(0,y-1),m+1,p),v.sort((_,w)=>_.keyTail-w.keyTail),b}const u=a(o.primaryKey.keyPath,0,o.primaryKey);s[":id"]=[u];for(const f of o.indexes)a(f.keyPath,0,f);function c(f){const m=f.query.index;return m.isVirtual?{...f,query:{index:m,range:(p=f.query.range,g=m.keyTail,{type:p.type===1?2:p.type,lower:Kn(p.lower,p.lowerOpen?t.MAX_KEY:t.MIN_KEY,g),lowerOpen:!0,upper:Kn(p.upper,p.upperOpen?t.MIN_KEY:t.MAX_KEY,g),upperOpen:!0})}}:f;var p,g}return{...n,schema:{...o,primaryKey:u,indexes:r,getIndexByKeyPath:function(f){const m=s[yn(f)];return m&&m[0]}},count:f=>n.count(c(f)),query:f=>n.query(c(f)),openCursor(f){const{keyTail:m,isVirtual:p,keyLength:g}=f.query.index;return p?n.openCursor(c(f)).then(v=>v&&function(y){return Object.create(y,{continue:{value:function(b){b!=null?y.continue(Kn(b,f.reverse?t.MAX_KEY:t.MIN_KEY,m)):f.unique?y.continue(y.key.slice(0,g).concat(f.reverse?t.MIN_KEY:t.MAX_KEY,m)):y.continue()}},continuePrimaryKey:{value(b,_){y.continuePrimaryKey(Kn(b,t.MAX_KEY,m),_)}},primaryKey:{get:()=>y.primaryKey},key:{get(){const b=y.key;return g===1?b[0]:b.slice(0,g)}},value:{get:()=>y.value}})}(v)):n.openCursor(f)}}}}}};function cr(t,e,n,o){return n=n||{},o=o||"",se(t).forEach(s=>{if(be(e,s)){var r=t[s],a=e[s];if(typeof r=="object"&&typeof a=="object"&&r&&a){const u=ds(r);u!==ds(a)?n[o+s]=e[s]:u==="Object"?cr(r,a,n,o+s+"."):r!==a&&(n[o+s]=e[s])}else r!==a&&(n[o+s]=e[s])}else n[o+s]=void 0}),se(e).forEach(s=>{be(t,s)||(n[o+s]=e[s])}),n}const kh={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:o}=n.schema;return{...n,mutate(r){const a=H.trans,{deleting:u,creating:c,updating:d}=a.table(e).hook;switch(r.type){case"add":if(c.fire===ee)break;return a._promise("readwrite",()=>f(r),!0);case"put":if(c.fire===ee&&d.fire===ee)break;return a._promise("readwrite",()=>f(r),!0);case"delete":if(u.fire===ee)break;return a._promise("readwrite",()=>f(r),!0);case"deleteRange":if(u.fire===ee)break;return a._promise("readwrite",()=>function(p){return m(p.trans,p.range,1e4)}(r),!0)}return n.mutate(r);function f(p){const g=H.trans,v=p.keys||function(y,x){return x.type==="delete"?x.keys:x.keys||x.values.map(y.extractKey)}(o,p);if(!v)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:v}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(y,x,b){return x.type==="add"?Promise.resolve([]):y.getMany({trans:x.trans,keys:b,cache:"immutable"})}(n,p,v).then(y=>{const x=v.map((b,_)=>{const w=y[_],C={onerror:null,onsuccess:null};if(p.type==="delete")u.fire.call(C,b,w,g);else if(p.type==="add"||w===void 0){const I=c.fire.call(C,b,p.values[_],g);b==null&&I!=null&&(b=I,p.keys[_]=b,o.outbound||Ne(p.values[_],o.keyPath,b))}else{const I=cr(w,p.values[_]),k=d.fire.call(C,I,b,w,g);if(k){const T=p.values[_];Object.keys(k).forEach(U=>{be(T,U)?T[U]=k[U]:Ne(T,U,k[U])})}}return C});return n.mutate(p).then(({failures:b,results:_,numFailures:w,lastResult:C})=>{for(let I=0;I<v.length;++I){const k=_?_[I]:v[I],T=x[I];k==null?T.onerror&&T.onerror(b[I]):T.onsuccess&&T.onsuccess(p.type==="put"&&y[I]?p.values[I]:k)}return{failures:b,results:_,numFailures:w,lastResult:C}}).catch(b=>(x.forEach(_=>_.onerror&&_.onerror(b)),Promise.reject(b)))})}function m(p,g,v){return n.query({trans:p,values:!1,query:{index:o,range:g},limit:v}).then(({result:y})=>f({type:"delete",keys:y,trans:p}).then(x=>x.numFailures>0?Promise.reject(x.failures[0]):y.length<v?{failures:[],numFailures:0,lastResult:void 0}:m(p,{...g,lower:y[y.length-1],lowerOpen:!0},v)))}}}}})};function Wl(t,e,n){try{if(!e||e.keys.length<t.length)return null;const o=[];for(let s=0,r=0;s<e.keys.length&&r<t.length;++s)me(e.keys[s],t[r])===0&&(o.push(n?Mn(e.values[s]):e.values[s]),++r);return o.length===t.length?o:null}catch{return null}}const Nh={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:o=>{if(!o.cache)return n.getMany(o);const s=Wl(o.keys,o.trans._cache,o.cache==="clone");return s?L.resolve(s):n.getMany(o).then(r=>(o.trans._cache={keys:o.keys,values:o.cache==="clone"?Mn(r):r},r))},mutate:o=>(o.type!=="add"&&(o.trans._cache=null),n.mutate(o))}}})};function dr(t){return!("from"in t)}const Be=function(t,e){if(!this){const n=new Be;return t&&"d"in t&&ye(n,t),n}ye(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Nn(t,e,n){const o=me(e,n);if(isNaN(o))return;if(o>0)throw RangeError();if(dr(t))return ye(t,{from:e,to:n,d:1});const s=t.l,r=t.r;if(me(n,t.from)<0)return s?Nn(s,e,n):t.l={from:e,to:n,d:1,l:null,r:null},ti(t);if(me(e,t.to)>0)return r?Nn(r,e,n):t.r={from:e,to:n,d:1,l:null,r:null},ti(t);me(e,t.from)<0&&(t.from=e,t.l=null,t.d=r?r.d+1:1),me(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const a=!t.r;s&&!t.l&&wo(t,s),r&&a&&wo(t,r)}function wo(t,e){dr(e)||function n(o,{from:s,to:r,l:a,r:u}){Nn(o,s,r),a&&n(o,a),u&&n(o,u)}(t,e)}function Ah(t,e){const n=Ms(e);let o=n.next();if(o.done)return!1;let s=o.value;const r=Ms(t);let a=r.next(s.from),u=a.value;for(;!o.done&&!a.done;){if(me(u.from,s.to)<=0&&me(u.to,s.from)>=0)return!0;me(s.from,u.from)<0?s=(o=n.next(u.from)).value:u=(a=r.next(s.from)).value}return!1}function Ms(t){let e=dr(t)?null:{s:0,n:t};return{next(n){const o=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,o)for(;e.n.l&&me(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!o||me(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function ti(t){var e,n;const o=(((e=t.r)===null||e===void 0?void 0:e.d)||0)-(((n=t.l)===null||n===void 0?void 0:n.d)||0),s=o>1?"r":o<-1?"l":"";if(s){const r=s==="r"?"l":"r",a={...t},u=t[s];t.from=u.from,t.to=u.to,t[s]=u[s],a[s]=u[r],t[r]=a,a.d=ni(a)}t.d=ni(t)}function ni({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}Zt(Be.prototype,{add(t){return wo(this,t),this},addKey(t){return Nn(this,t,t),this},addKeys(t){return t.forEach(e=>Nn(this,e,e)),this},[fs](){return Ms(this)}});const Ph={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new Be(t.MIN_KEY,t.MAX_KEY);return{...t,table:o=>{const s=t.table(o),{schema:r}=s,{primaryKey:a}=r,{extractKey:u,outbound:c}=a,d={...s,mutate:p=>{const g=p.trans,v=g.mutatedParts||(g.mutatedParts={}),y=k=>{const T=`idb://${e}/${o}/${k}`;return v[T]||(v[T]=new Be)},x=y(""),b=y(":dels"),{type:_}=p;let[w,C]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const I=p.trans._cache;return s.mutate(p).then(k=>{if(ce(w)){_!=="delete"&&(w=k.results),x.addKeys(w);const T=Wl(w,I);T||_==="add"||b.addKeys(w),(T||C)&&function(U,E,R,A){function z(V){const j=U(V.name||"");function q(P){return P!=null?V.extractKey(P):null}const $=P=>V.multiEntry&&ce(P)?P.forEach(W=>j.addKey(W)):j.addKey(P);(R||A).forEach((P,W)=>{const Z=R&&q(R[W]),S=A&&q(A[W]);me(Z,S)!==0&&(Z!=null&&$(Z),S!=null&&$(S))})}E.indexes.forEach(z)}(y,r,T,C)}else if(w){const T={from:w.lower,to:w.upper};b.add(T),x.add(T)}else x.add(n),b.add(n),r.indexes.forEach(T=>y(T.name).add(n));return k})}},f=({query:{index:p,range:g}})=>{var v,y;return[p,new Be((v=g.lower)!==null&&v!==void 0?v:t.MIN_KEY,(y=g.upper)!==null&&y!==void 0?y:t.MAX_KEY)]},m={get:p=>[a,new Be(p.key)],getMany:p=>[a,new Be().addKeys(p.keys)],count:f,query:f,openCursor:f};return se(m).forEach(p=>{d[p]=function(g){const{subscr:v}=H;if(v){const y=C=>{const I=`idb://${e}/${o}/${C}`;return v[I]||(v[I]=new Be)},x=y(""),b=y(":dels"),[_,w]=m[p](g);if(y(_.name||"").add(w),!_.isPrimaryKey){if(p!=="count"){const C=p==="query"&&c&&g.values&&s.query({...g,values:!1});return s[p].apply(this,arguments).then(I=>{if(p==="query"){if(c&&g.values)return C.then(({result:T})=>(x.addKeys(T),I));const k=g.values?I.result.map(u):I.result;g.values?x.addKeys(k):b.addKeys(k)}else if(p==="openCursor"){const k=I,T=g.values;return k&&Object.create(k,{key:{get:()=>(b.addKey(k.primaryKey),k.key)},primaryKey:{get(){const U=k.primaryKey;return b.addKey(U),U}},value:{get:()=>(T&&x.addKey(k.primaryKey),k.value)}})}return I})}b.add(n)}}return s[p].apply(this,arguments)}}),d}}}};class It{constructor(e,n){this._middlewares={},this.verno=0;const o=It.dependencies;this._options=n={addons:It.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const r={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ee,dbReadyPromise:null,cancelOpen:ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;r.dbReadyPromise=new L(u=>{r.dbReadyResolve=u}),r.openCanceller=new L((u,c)=>{r.cancelOpen=c}),this._state=r,this.name=e,this.on=gn(this,"populate","blocked","versionchange","close",{ready:[sr,ee]}),this.on.ready.subscribe=_l(this.on.ready.subscribe,u=>(c,d)=>{It.vip(()=>{const f=this._state;if(f.openComplete)f.dbOpenError||L.resolve().then(c),d&&u(c);else if(f.onReadyBeingFired)f.onReadyBeingFired.push(c),d&&u(c);else{u(c);const m=this;d||u(function p(){m.on.ready.unsubscribe(c),m.on.ready.unsubscribe(p)})}})}),this.Collection=(a=this,rn(ph.prototype,function(u,c){this.db=a;let d=Bl,f=null;if(c)try{d=c()}catch(v){f=v}const m=u._ctx,p=m.table,g=p.hook.reading.fire;this._ctx={table:p,index:m.index,isPrimKey:!m.index||p.schema.primKey.keyPath&&m.index===p.schema.primKey.name,range:d,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:f,or:m.or,valueMapper:g!==Tn?g:null}})),this.Table=function(u){return rn(hh.prototype,function(c,d,f){this.db=u,this._tx=f,this.name=c,this.schema=d,this.hook=u._allTables[c]?u._allTables[c].hook:gn(null,{creating:[th,ee],reading:[eh,Tn],updating:[oh,ee],deleting:[nh,ee]})})}(this),this.Transaction=function(u){return rn(vh.prototype,function(c,d,f,m,p){this.db=u,this.mode=c,this.storeNames=d,this.schema=f,this.chromeTransactionDurability=m,this.idbtrans=null,this.on=gn(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new L((g,v)=>{this._resolve=g,this._reject=v}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},g=>{var v=this.active;return this.active=!1,this.on.error.fire(g),this.parent?this.parent._reject(g):v&&this.idbtrans&&this.idbtrans.abort(),re(g)})})}(this),this.Version=function(u){return rn(Ch.prototype,function(c){this.db=u,this._cfg={version:c,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(u){return rn(Ol.prototype,function(c,d,f){this.db=u,this._ctx={table:c,index:d===":id"?null:d,or:f};const m=u._deps.indexedDB;if(!m)throw new O.MissingAPI;this._cmp=this._ascending=m.cmp.bind(m),this._descending=(p,g)=>m.cmp(g,p),this._max=(p,g)=>m.cmp(p,g)>0?p:g,this._min=(p,g)=>m.cmp(p,g)<0?p:g,this._IDBKeyRange=u._deps.IDBKeyRange})}(this),this.on("versionchange",u=>{u.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",u=>{!u.newVersion||u.newVersion<u.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${u.oldVersion/10}`)}),this._maxKey=kn(n.IDBKeyRange),this._createTransaction=(u,c,d,f)=>new this.Transaction(u,c,d,this._options.chromeTransactionDurability,f),this._fireOnBlocked=u=>{this.on("blocked").fire(u),mn.filter(c=>c.name===this.name&&c!==this&&!c._state.vcFired).map(c=>c.on("versionchange").fire(u))},this.use(Ih),this.use(kh),this.use(Ph),this.use(Nh),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(u=>u(this))}version(e){if(isNaN(e)||e<.1)throw new O.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new O.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var o=n.filter(s=>s._cfg.version===e)[0];return o||(o=new this.Version(e),n.push(o),n.sort(_h),o.stores({}),this._state.autoSchema=!1,o)}_whenReady(e){return this.idbdb&&(this._state.openComplete||H.letThrough||this._vip)?e():new L((n,o)=>{if(this._state.openComplete)return o(new O.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void o(new O.DatabaseClosed);this.open().catch(ee)}this._state.dbReadyPromise.then(n,o)}).then(e)}use({stack:e,create:n,level:o,name:s}){s&&this.unuse({stack:e,name:s});const r=this._middlewares[e]||(this._middlewares[e]=[]);return r.push({stack:e,create:n,level:o??10,name:s}),r.sort((a,u)=>a.level-u.level),this}unuse({stack:e,name:n,create:o}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(s=>o?s.create!==o:!!n&&s.name!==n)),this}open(){return Sh(this)}_close(){const e=this._state,n=mn.indexOf(this);if(n>=0&&mn.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new L(o=>{e.dbReadyResolve=o}),e.openCanceller=new L((o,s)=>{e.cancelOpen=s})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new O.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new L((o,s)=>{const r=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=ne(()=>{(function({indexedDB:u,IDBKeyRange:c},d){!ur(u)&&d!==Uo&&lr(u,c).delete(d).catch(ee)})(this._deps,this.name),o()}),a.onerror=De(s),a.onblocked=this._fireOnBlocked};if(e)throw new O.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(r):r()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return se(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Eh.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,o){let s=H.trans;s&&s.db===this&&e.indexOf("!")===-1||(s=null);const r=e.indexOf("?")!==-1;let a,u;e=e.replace("!","").replace("?","");try{if(u=n.map(d=>{var f=d instanceof this.Table?d.name:d;if(typeof f!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),e=="r"||e===jo)a=jo;else{if(e!="rw"&&e!=Wo)throw new O.InvalidArgument("Invalid transaction mode: "+e);a=Wo}if(s){if(s.mode===jo&&a===Wo){if(!r)throw new O.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&u.forEach(d=>{if(s&&s.storeNames.indexOf(d)===-1){if(!r)throw new O.SubTransaction("Table "+d+" not included in parent transaction.");s=null}}),r&&s&&!s.active&&(s=null)}}catch(d){return s?s._promise(null,(f,m)=>{m(d)}):re(d)}const c=jl.bind(null,this,a,u,s,o);return s?s._promise(a,c,"lock"):H.trans?tn(H.transless,()=>this._whenReady(c)):this._whenReady(c)}table(e){if(!be(this._allTables,e))throw new O.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const Rh=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Mh{constructor(e){this._subscribe=e}subscribe(e,n,o){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:n,complete:o})}[Rh](){return this}}function Yl(t,e){return se(e).forEach(n=>{wo(t[n]||(t[n]=new Be),e[n])}),t}function Dh(t){let e,n=!1;const o=new Mh(s=>{const r=tr(t);let a=!1,u={},c={};const d={get closed(){return a},unsubscribe:()=>{a=!0,pt.storagemutated.unsubscribe(g)}};s.start&&s.start(d);let f=!1,m=!1;function p(){return se(c).some(y=>u[y]&&Ah(u[y],c[y]))}const g=y=>{Yl(u,y),p()&&v()},v=()=>{if(f||a)return;u={};const y={},x=function(b){r&&en();const _=()=>ft(t,{subscr:b,trans:null}),w=H.trans?tn(H.transless,_):_();return r&&w.then(je,je),w}(y);m||(pt(In,g),m=!0),f=!0,Promise.resolve(x).then(b=>{n=!0,e=b,f=!1,a||(p()?v():(u={},c=y,s.next&&s.next(b)))},b=>{f=!1,n=!1,s.error&&s.error(b),d.unsubscribe()})};return v(),d});return o.hasValue=()=>n,o.getValue=()=>e,o}let Ds;try{Ds={indexedDB:te.indexedDB||te.mozIndexedDB||te.webkitIndexedDB||te.msIndexedDB,IDBKeyRange:te.IDBKeyRange||te.webkitIDBKeyRange}}catch{Ds={indexedDB:null,IDBKeyRange:null}}const gt=It;function oo(t){let e=Ke;try{Ke=!0,pt.storagemutated.fire(t)}finally{Ke=e}}Zt(gt,{...Qn,delete:t=>new gt(t,{addons:[]}).delete(),exists:t=>new gt(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return ur(e)?Promise.resolve(e.databases()).then(o=>o.map(s=>s.name).filter(s=>s!==Uo)):lr(e,n).toCollection().primaryKeys()}(gt.dependencies).then(t)}catch{return re(new O.MissingAPI)}},defineClass:()=>function(t){ye(this,t)},ignoreTransaction:t=>H.trans?tn(H.transless,t):t(),vip:Ps,async:function(t){return function(){try{var e=Rs(t.apply(this,arguments));return e&&typeof e.then=="function"?e:L.resolve(e)}catch(n){return re(n)}}},spawn:function(t,e,n){try{var o=Rs(t.apply(n,e||[]));return o&&typeof o.then=="function"?o:L.resolve(o)}catch(s){return re(s)}},currentTransaction:{get:()=>H.trans||null},waitFor:function(t,e){const n=L.resolve(typeof t=="function"?gt.ignoreTransaction(t):t).timeout(e||6e4);return H.trans?H.trans.waitFor(n):n},Promise:L,debug:{get:()=>qe,set:t=>{Il(t,t==="dexie"?()=>!0:Hl)}},derive:qt,extend:ye,props:Zt,override:_l,Events:gn,on:pt,liveQuery:Dh,extendObservabilitySet:Yl,getByKeyPath:ze,setByKeyPath:Ne,delByKeyPath:function(t,e){typeof e=="string"?Ne(t,e,void 0):"length"in e&&[].map.call(e,function(n){Ne(t,n,void 0)})},shallowClone:Tl,deepClone:Mn,getObjectDiff:cr,cmp:me,asap:wl,minKey:Cs,addons:[],connections:mn,errnames:or,dependencies:Ds,semVer:Wr,version:Wr.split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),gt.maxKey=kn(gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(pt(In,t=>{if(!Ke){let e;Do?(e=document.createEvent("CustomEvent"),e.initCustomEvent(ot,!0,!0,t)):e=new CustomEvent(ot,{detail:t}),Ke=!0,dispatchEvent(e),Ke=!1}}),addEventListener(ot,({detail:t})=>{Ke||oo(t)}));let Ke=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel(ot);typeof t.unref=="function"&&t.unref(),pt(In,e=>{Ke||t.postMessage(e)}),t.onmessage=e=>{e.data&&oo(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){pt(In,e=>{try{Ke||(typeof localStorage<"u"&&localStorage.setItem(ot,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:ot,changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if(e.key===ot){const n=JSON.parse(e.newValue);n&&oo(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&e.type===ot&&oo(e.changedParts)})}L.rejectionMapper=function(t,e){if(!t||t instanceof Vt||t instanceof TypeError||t instanceof SyntaxError||!t.name||!Kr[t.name])return t;var n=new Kr[t.name](e||t.message,t);return"stack"in t&&Je(n,"stack",{get:function(){return this.inner.stack}}),n},Il(qe,Hl);class Uh extends It{constructor(){super("FTCManagerDB");Xe(this,"tasks");Xe(this,"checklists");Xe(this,"scoutingReports");Xe(this,"matchPlans");Xe(this,"syncQueue");Xe(this,"members");Xe(this,"teams");this.version(1).stores({tasks:"id, organizationId, teamId, status, syncStatus, updatedAt",checklists:"id, organizationId, syncStatus",scoutingReports:"id, organizationId, opponentTeamNumber, matchNumber, syncStatus",matchPlans:"id, organizationId, syncStatus",syncQueue:"id, tableName, timestamp, retryCount",members:"id, organizationId, syncStatus",teams:"id, organizationId, syncStatus"})}}const ct=new Uh;function Me(){return crypto.randomUUID()}async function Ze(t,e,n,o){await ct.syncQueue.add({id:Me(),tableName:t,recordId:e,operation:n,data:o,timestamp:Date.now(),retryCount:0})}async function oi(){return await ct.syncQueue.count()}const si={id:"season-2025-2026",name:"2025-2026 Decode",fieldImageUrl:"",createdAt:Date.now()},ri=[{id:"m1",firstName:"Abby",lastNameInitial:"B"},{id:"m2",firstName:"Ben",lastNameInitial:"C"},{id:"m3",firstName:"Charlie",lastNameInitial:"D"},{id:"m4",firstName:"Dana",lastNameInitial:"E"},{id:"m5",firstName:"Evan",lastNameInitial:"F"}],ii=[{id:"t1",name:"Programming",memberIds:["m1"]},{id:"t2",name:"Build",memberIds:["m2"]},{id:"t3",name:"Drive",memberIds:["m3"]},{id:"t4",name:"Scouting",memberIds:["m5"]},{id:"t5",name:"Outreach",memberIds:["m4"]}],ai=[{id:"1",text:"Turn off robot",checked:!1},{id:"2",text:"Swap main battery",checked:!1},{id:"3",text:"Charge old battery",checked:!1},{id:"4",text:"Charge Driver Hub",checked:!1},{id:"5",text:"Tighten chassis screws",checked:!1},{id:"6",text:"Check wiring connections",checked:!1},{id:"7",text:"Clean wheels",checked:!1},{id:"8",text:"Reset servo positions",checked:!1}],ge=Lf()($f((t,e)=>({currentOrganizationId:null,isDemoMode:!Zs(),tasks:[],members:ri,teams:ii,scoutingReports:[],checklist:ai,matchPlans:[],portfolioHistory:[],seasons:[si],currentSeasonId:si.id,theme:"light",geminiApiKey:null,setTheme:n=>{t({theme:n}),n==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},setGeminiApiKey:n=>t({geminiApiKey:n}),addTask:n=>{const o={...n,id:Me(),createdAt:Date.now(),seasonId:e().currentSeasonId||void 0,timeline:[{id:Me(),type:"history",authorId:"System",content:"Task created",timestamp:Date.now()}]};t(s=>({tasks:[...s.tasks,o]})),e().isDemoMode||Ze("tasks",o.id,"create",o)},updateTask:(n,o)=>{if(t(s=>({tasks:s.tasks.map(r=>r.id===n?{...r,...o}:r)})),!e().isDemoMode){const s=e().tasks.find(r=>r.id===n);s&&Ze("tasks",n,"update",{...s,...o})}},deleteTask:n=>{t(o=>({tasks:o.tasks.filter(s=>s.id!==n)})),e().isDemoMode||Ze("tasks",n,"delete",null)},addMember:(n,o)=>{const s={id:Me(),firstName:n,lastNameInitial:o,seasonId:e().currentSeasonId||void 0};t(r=>({members:[...r.members,s]}))},removeMember:n=>{t(o=>({members:o.members.filter(s=>s.id!==n),teams:o.teams.map(s=>({...s,memberIds:s.memberIds.filter(r=>r!==n)}))}))},setMembers:n=>t({members:n}),addTeam:n=>{const o={id:Me(),name:n,memberIds:[],seasonId:e().currentSeasonId||void 0};t(s=>({teams:[...s.teams,o]}))},removeTeam:n=>{t(o=>({teams:o.teams.filter(s=>s.id!==n)}))},toggleMemberInTeam:(n,o)=>{t(s=>({teams:s.teams.map(r=>{if(r.id!==n)return r;const a=r.memberIds.includes(o)?r.memberIds.filter(u=>u!==o):[...r.memberIds,o];return{...r,memberIds:a}})}))},setTeams:n=>t({teams:n}),addScoutingReport:n=>{const o={...n,id:Me(),seasonId:e().currentSeasonId||void 0};t(s=>({scoutingReports:[...s.scoutingReports,o]})),e().isDemoMode||Ze("scoutingReports",o.id,"create",o)},deleteScoutingReport:n=>{t(o=>({scoutingReports:o.scoutingReports.filter(s=>s.id!==n)})),e().isDemoMode||Ze("scoutingReports",n,"delete",null)},toggleChecklistItem:n=>{t(o=>({checklist:o.checklist.map(s=>s.id===n?{...s,checked:!s.checked}:s)}))},resetChecklist:()=>{t(n=>({checklist:n.checklist.map(o=>({...o,checked:!1}))}))},addChecklistItem:n=>{const o={id:Me(),text:n,checked:!1,seasonId:e().currentSeasonId||void 0};t(s=>({checklist:[...s.checklist,o]}))},deleteChecklistItem:n=>{t(o=>({checklist:o.checklist.filter(s=>s.id!==n)}))},updateChecklistAssignment:(n,o)=>{t(s=>({checklist:s.checklist.map(r=>r.id===n?{...r,assignedTo:o}:r)}))},addMatchPlan:n=>{const o={...n,id:Me(),updatedAt:Date.now(),seasonId:e().currentSeasonId||void 0};t(s=>({matchPlans:[...s.matchPlans,o]})),e().isDemoMode||Ze("matchPlans",o.id,"create",o)},deleteMatchPlan:n=>{t(o=>({matchPlans:o.matchPlans.filter(s=>s.id!==n)})),e().isDemoMode||Ze("matchPlans",n,"delete",null)},updateMatchPlan:(n,o)=>{if(t(s=>({matchPlans:s.matchPlans.map(r=>r.id===n?{...r,...o,updatedAt:Date.now()}:r)})),!e().isDemoMode){const s=e().matchPlans.find(r=>r.id===n);s&&Ze("matchPlans",n,"update",{...s,...o})}},addPortfolioEntry:(n,o)=>{const s={id:Me(),content:n,createdAt:Date.now(),taskCount:o,seasonId:e().currentSeasonId||void 0};t(r=>({portfolioHistory:[s,...r.portfolioHistory]}))},deletePortfolioEntry:n=>{t(o=>({portfolioHistory:o.portfolioHistory.filter(s=>s.id!==n)}))},addSeason:(n,o="")=>{const s={id:Me(),name:n,fieldImageUrl:o,createdAt:Date.now()};t(r=>({seasons:[...r.seasons,s],currentSeasonId:s.id}))},updateSeason:(n,o)=>{t(s=>({seasons:s.seasons.map(r=>r.id===n?{...r,...o}:r)}))},deleteSeason:n=>{e().seasons.length<=1||t(s=>{var r;return{seasons:s.seasons.filter(a=>a.id!==n),tasks:s.tasks.filter(a=>a.seasonId!==n),members:s.members.filter(a=>a.seasonId!==n),teams:s.teams.filter(a=>a.seasonId!==n),scoutingReports:s.scoutingReports.filter(a=>a.seasonId!==n),checklist:s.checklist.filter(a=>a.seasonId!==n),matchPlans:s.matchPlans.filter(a=>a.seasonId!==n),portfolioHistory:s.portfolioHistory.filter(a=>a.seasonId!==n),currentSeasonId:s.currentSeasonId===n?((r=s.seasons.find(a=>a.id!==n))==null?void 0:r.id)||null:s.currentSeasonId}})},setCurrentSeason:n=>t({currentSeasonId:n}),getCurrentSeason:()=>{const n=e();return n.seasons.find(o=>o.id===n.currentSeasonId)||null},initializeStore:async()=>{try{const n=await ct.tasks.toArray();n.length>0&&t({tasks:n.map(s=>({id:s.id,title:s.title,description:s.description||"",status:s.status,type:s.type,assignedTo:s.assignedTo||"",department:s.teamId||"",tags:s.tags,checklist:s.checklist,timeline:Array.isArray(s.timeline)?s.timeline.map(r=>({...r,type:r.type})):[],createdAt:s.createdAt,dueDate:s.dueDate}))});const o=await ct.matchPlans.toArray();o.length>0&&t({matchPlans:o.map(s=>({id:s.id,title:s.title||`Match ${s.matchNumber||"?"}`,drawingData:s.drawingData,notes:s.notes||"",allianceTeam:s.allianceTeam||"",partnerAutonomous:s.partnerAutonomous||!1,partnerPark:s.partnerPark||!1,updatedAt:s.updatedAt}))})}catch(n){console.warn("Failed to load from IndexedDB:",n)}},resetToDefaults:()=>{t({tasks:[],members:ri,teams:ii,scoutingReports:[],checklist:ai,matchPlans:[]})}}),{name:"ftc-team-manager-storage",partialize:t=>({tasks:t.tasks,members:t.members,teams:t.teams,scoutingReports:t.scoutingReports,checklist:t.checklist,matchPlans:t.matchPlans,portfolioHistory:t.portfolioHistory,seasons:t.seasons,currentSeasonId:t.currentSeasonId,theme:t.theme,geminiApiKey:t.geminiApiKey})}));if(typeof window<"u"){const t=localStorage.getItem("ftc-team-manager-storage");if(t)try{const{state:e}=JSON.parse(t);(e==null?void 0:e.theme)==="dark"&&document.documentElement.classList.add("dark")}catch{}}function Fh(){const{signInWithEmail:t,signUpWithEmail:e,signInWithGoogle:n,signInWithMicrosoft:o,resetPassword:s,isConfigured:r}=Ro(),[a,u]=D.useState("login"),[c,d]=D.useState(""),[f,m]=D.useState(""),[p,g]=D.useState(""),[v,y]=D.useState(!1),[x,b]=D.useState(null),[_,w]=D.useState(null),C=async T=>{T.preventDefault(),y(!0),b(null),w(null);try{if(a==="login"){const{error:U}=await t(c,f);U&&b(U.message)}else if(a==="signup"){const{error:U}=await e(c,f,p);U?b(U.message):w("Check your email for a confirmation link!")}else if(a==="forgot"){const{error:U}=await s(c);U?b(U.message):w("Password reset email sent!")}}catch{b("An unexpected error occurred")}finally{y(!1)}},I=async()=>{y(!0),b(null);const{error:T}=await n();T&&(b(T.message),y(!1))},k=async()=>{y(!0),b(null);const{error:T}=await o();T&&(b(T.message),y(!1))};return r?h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:h.jsxs("div",{className:"max-w-md w-full",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl shadow-xl border border-slate-700/50 mb-4 p-4",children:h.jsx("img",{src:"/ftc-team-manager/logo.png",className:"w-full h-full object-contain",alt:"Logo"})}),h.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"FTC Team Manager"}),h.jsxs("p",{className:"text-slate-400",children:[a==="login"&&"Sign in to your account",a==="signup"&&"Create your account",a==="forgot"&&"Reset your password"]})]}),h.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-xl border border-slate-700 rounded-2xl p-6 shadow-xl",children:[x&&h.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-3 mb-4",children:h.jsx("p",{className:"text-red-400 text-sm",children:x})}),_&&h.jsx("div",{className:"bg-green-500/10 border border-green-500/20 rounded-xl p-3 mb-4",children:h.jsx("p",{className:"text-green-400 text-sm",children:_})}),a!=="forgot"&&h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"space-y-3 mb-6",children:[h.jsxs("button",{onClick:I,disabled:v,className:"w-full flex items-center justify-center gap-3 bg-white text-slate-900 font-medium py-3 px-4 rounded-xl hover:bg-slate-100 transition-all disabled:opacity-50",children:[h.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[h.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),h.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),h.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),h.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]}),h.jsxs("button",{onClick:k,disabled:v,className:"w-full flex items-center justify-center gap-3 bg-slate-700 text-white font-medium py-3 px-4 rounded-xl hover:bg-slate-600 transition-all disabled:opacity-50",children:[h.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[h.jsx("path",{fill:"#F25022",d:"M1 1h10v10H1z"}),h.jsx("path",{fill:"#00A4EF",d:"M1 13h10v10H1z"}),h.jsx("path",{fill:"#7FBA00",d:"M13 1h10v10H13z"}),h.jsx("path",{fill:"#FFB900",d:"M13 13h10v10H13z"})]}),"Continue with Microsoft"]})]}),h.jsxs("div",{className:"relative mb-6",children:[h.jsx("div",{className:"absolute inset-0 flex items-center",children:h.jsx("div",{className:"w-full border-t border-slate-600"})}),h.jsx("div",{className:"relative flex justify-center text-sm",children:h.jsx("span",{className:"px-4 bg-slate-800/50 text-slate-400",children:"or continue with email"})})]})]}),h.jsxs("form",{onSubmit:C,className:"space-y-4",children:[a==="signup"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Full Name"}),h.jsxs("div",{className:"relative",children:[h.jsx(pl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),h.jsx("input",{type:"text",value:p,onChange:T=>g(T.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-700/50 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"John Smith",required:!0})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Email"}),h.jsxs("div",{className:"relative",children:[h.jsx(Ed,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),h.jsx("input",{type:"email",value:c,onChange:T=>d(T.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-700/50 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"you@team12345.org",required:!0})]})]}),a!=="forgot"&&h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-1.5",children:"Password"}),h.jsxs("div",{className:"relative",children:[h.jsx(Cd,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),h.jsx("input",{type:"password",value:f,onChange:T=>m(T.target.value),className:"w-full pl-10 pr-4 py-3 bg-slate-700/50 border border-slate-600 rounded-xl text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"",required:!0,minLength:6})]})]}),h.jsx("button",{type:"submit",disabled:v,className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold py-3 px-4 rounded-xl hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg shadow-orange-500/25 disabled:opacity-50",children:v?h.jsx(us,{className:"w-5 h-5 animate-spin"}):h.jsxs(h.Fragment,{children:[a==="login"&&"Sign In",a==="signup"&&"Create Account",a==="forgot"&&"Send Reset Link",h.jsx(ao,{className:"w-4 h-4"})]})})]}),h.jsxs("div",{className:"mt-6 text-center text-sm",children:[a==="login"&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>u("forgot"),className:"text-slate-400 hover:text-orange-400 transition-colors",children:"Forgot password?"}),h.jsxs("p",{className:"mt-4 text-slate-400",children:["Don't have an account?"," ",h.jsx("button",{onClick:()=>u("signup"),className:"text-orange-400 hover:text-orange-300 font-medium",children:"Sign up"})]})]}),a==="signup"&&h.jsxs("p",{className:"text-slate-400",children:["Already have an account?"," ",h.jsx("button",{onClick:()=>u("login"),className:"text-orange-400 hover:text-orange-300 font-medium",children:"Sign in"})]}),a==="forgot"&&h.jsx("button",{onClick:()=>u("login"),className:"text-orange-400 hover:text-orange-300 font-medium",children:"Back to sign in"})]})]})]})}):h.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:h.jsxs("div",{className:"max-w-md w-full",children:[h.jsxs("div",{className:"text-center mb-8",children:[h.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-orange-500 to-orange-600 rounded-2xl shadow-lg shadow-orange-500/25 mb-4",children:h.jsx("img",{src:"/ftc-team-manager/logo.png",className:"w-full h-full object-contain",alt:"Logo"})}),h.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"FTC Team Manager"}),h.jsx("p",{className:"text-slate-400",children:"Running in Demo Mode"})]}),h.jsxs("div",{className:"bg-slate-800/50 backdrop-blur-xl border border-slate-700 rounded-2xl p-6 shadow-xl",children:[h.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-xl p-4 mb-6",children:h.jsxs("p",{className:"text-amber-200 text-sm",children:[h.jsx("strong",{children:"Demo Mode:"})," Cloud sync is disabled. Your data will be saved locally in this browser. To enable authentication and cloud sync, configure your Supabase credentials in ",h.jsx("code",{className:"bg-slate-700 px-1 rounded",children:".env.local"})]})}),h.jsxs("a",{href:"/",className:"w-full flex items-center justify-center gap-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold py-3 px-4 rounded-xl hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg shadow-orange-500/25",children:["Continue to App",h.jsx(ao,{className:"w-4 h-4"})]})]})]})})}function Ql(){const[t,e]=D.useState(navigator.onLine),[n,o]=D.useState("idle"),[s,r]=D.useState(0),[a,u]=D.useState(null),[c,d]=D.useState(null),f=D.useRef(!1);D.useEffect(()=>{const p=()=>{e(!0),o("idle")},g=()=>{e(!1),o("offline"),f.current=!1};return window.addEventListener("online",p),window.addEventListener("offline",g),()=>{window.removeEventListener("online",p),window.removeEventListener("offline",g)}},[]),D.useEffect(()=>{const p=async()=>{const v=await oi();r(v)};p();const g=setInterval(p,5e3);return()=>clearInterval(g)},[]),D.useEffect(()=>{t&&s>0&&n==="idle"&&!f.current&&m()},[t,s,n]);const m=D.useCallback(async()=>{if(!f.current){if(!t||!X){o("offline");return}f.current=!0,o("syncing"),d(null);try{const p=await ct.syncQueue.toArray();for(const v of p)try{await Lh(v),await ct.syncQueue.delete(v.id)}catch(y){const x=(v.retryCount||0)+1;x>=5?(console.error(`Sync item ${v.id} failed after 5 retries. Removing from queue.`,y),await ct.syncQueue.delete(v.id)):await ct.syncQueue.update(v.id,{retryCount:x,lastError:y instanceof Error?y.message:"Unknown error"})}await Gh(),u(new Date),o("idle");const g=await oi();r(g)}catch(p){console.error("Sync failed:",p),d(p instanceof Error?p.message:"Sync failed"),o("error")}finally{f.current=!1}}},[t]);return{isOnline:t,syncStatus:n,pendingChanges:s,lastSyncTime:a,sync:m,error:c}}async function Lh(t){if(!X)throw new Error("Supabase not configured");const{tableName:e,operation:n,data:o,recordId:s}=t;switch(n){case"create":const{error:r}=await X.from(e).insert(o);if(r)throw r;break;case"update":const{error:a}=await X.from(e).update(o).eq("id",s);if(a)throw a;break;case"delete":const{error:u}=await X.from(e).delete().eq("id",s);if(u)throw u;break}}async function Gh(){X&&console.log("Pull from server completed")}function li({variant:t="full"}){const{isOnline:e,syncStatus:n,pendingChanges:o,lastSyncTime:s,sync:r,error:a}=Ql();if(!Zs())return null;const c=()=>{if(!e)return h.jsx(uo,{className:"w-4 h-4 text-slate-400"});switch(n){case"syncing":return h.jsx(Ld,{className:"w-4 h-4 text-blue-400 animate-spin"});case"error":return h.jsx(Zc,{className:"w-4 h-4 text-red-400"});case"idle":return o>0?h.jsx(cd,{className:"w-4 h-4 text-amber-400"}):h.jsx(dl,{className:"w-4 h-4 text-green-400"});default:return h.jsx(uo,{className:"w-4 h-4 text-slate-400"})}},d=()=>{if(!e)return"Offline";switch(n){case"syncing":return"Syncing...";case"error":return"Sync Error";case"idle":return o>0?`${o} pending`:"Synced";default:return"Offline"}},f=()=>{if(!e)return"bg-slate-500/10 border-slate-500/20";switch(n){case"syncing":return"bg-blue-500/10 border-blue-500/20";case"error":return"bg-red-500/10 border-red-500/20";case"idle":return o>0?"bg-amber-500/10 border-amber-500/20":"bg-green-500/10 border-green-500/20";default:return"bg-slate-500/10 border-slate-500/20"}};return h.jsxs("button",{onClick:()=>r(),disabled:n==="syncing"||!e,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${f()} ${t==="icon"?"aspect-square justify-center":""}`,title:a||(s?`Last synced: ${s.toLocaleTimeString()}`:"Click to sync"),children:[h.jsx("span",{className:n==="syncing"?"animate-spin":"",children:c()}),t==="full"&&h.jsx("span",{children:d()})]})}const we={Backlog:"Backlog",ToDo:"To Do",InProgress:"In Progress",Validation:"Validation",Done:"Done",Archived:"Archived"},an={Feature:"Feature",Bug:"Bug"},ui=[we.Backlog,we.ToDo,we.InProgress,we.Validation,we.Done],qh=[{id:"m1",firstName:"Abby",lastNameInitial:"B"},{id:"m2",firstName:"Ben",lastNameInitial:"C"},{id:"m3",firstName:"Charlie",lastNameInitial:"D"},{id:"m4",firstName:"Dana",lastNameInitial:"E"},{id:"m5",firstName:"Evan",lastNameInitial:"F"}],Vh=[{id:"t1",name:"Programming",memberIds:["m1"]},{id:"t2",name:"Build",memberIds:["m2"]},{id:"t3",name:"Drive",memberIds:["m3"]},{id:"t4",name:"Scouting",memberIds:["m5"]},{id:"t5",name:"Outreach",memberIds:["m4"]}],Hh=[{id:"1",text:"Turn off robot",checked:!1},{id:"2",text:"Swap main battery",checked:!1},{id:"3",text:"Charge old battery",checked:!1},{id:"4",text:"Charge Driver Hub",checked:!1},{id:"5",text:"Tighten chassis screws",checked:!1},{id:"6",text:"Check wiring connections",checked:!1},{id:"7",text:"Clean wheels",checked:!1},{id:"8",text:"Reset servo positions",checked:!1}],Bh="DecodeField.png",$h=({tasks:t,setTasks:e,members:n,teams:o})=>{const[s,r]=D.useState(null),[a,u]=D.useState(!1),[c,d]=D.useState(!1),[f,m]=D.useState("board"),[p,g]=D.useState(""),[v,y]=D.useState({}),[x,b]=D.useState(null),_=D.useRef(null),w=D.useRef(null);D.useEffect(()=>{a&&c&&w.current&&(w.current.focus(),w.current.select())},[a,c]);const C=S=>{const M=n.find(G=>G.id===S);return M?`${M.firstName} ${M.lastNameInitial}.`:"Unassigned"},I=S=>{const M=o.find(G=>G.id===S);return M?M.name:"General"},k=S=>{const M=n.find(G=>G.id===S);return M?`${M.firstName[0]}${M.lastNameInitial}`:"?"},T=S=>{r(S),d(!1),u(!0)},U=()=>{var M,G;const S={id:Date.now().toString(),title:"New Task",description:"",status:we.Backlog,type:an.Feature,assignedTo:((M=n[0])==null?void 0:M.id)||"",department:((G=o[0])==null?void 0:G.id)||"",tags:[],checklist:[],timeline:[],createdAt:Date.now()};r(S),d(!0),u(!0)},E=()=>{if(!s)return;const S=t.find(G=>G.id===s.id);let M={...s};if(!c&&S&&S.status!==s.status){const G={id:Date.now().toString(),type:"history",authorId:"System",content:`moved to ${s.status}`,timestamp:Date.now()};M.timeline=[G,...M.timeline]}e(c?[...t,M]:t.map(G=>G.id===M.id?M:G)),u(!1)},R=()=>{var G;if(!p.trim()||!s)return;const S={id:Date.now().toString(),type:"comment",authorId:((G=n[0])==null?void 0:G.id)||"user",content:p,timestamp:Date.now()},M={...s,timeline:[S,...s.timeline]};r(M),e(c?[...t.filter(Se=>Se.id!==s.id),M]:t.map(Se=>Se.id===M.id?M:Se)),g("")},A=S=>{if(!s)return;const M={...s,timeline:s.timeline.filter(G=>G.id!==S)};r(M),c||e(t.map(G=>G.id===M.id?M:G))},z=S=>{e(t.filter(M=>M.id!==S)),b(null),u(!1)},V=()=>{if(!s)return;const S={...s,status:we.Archived,archivedAt:Date.now()};e(t.map(M=>M.id===S.id?S:M)),u(!1)},j=S=>{e(t.map(M=>M.id===S?{...M,status:we.Done,archivedAt:void 0}:M))},q=S=>{y(M=>({...M,[S]:!M[S]}))},$=()=>h.jsx("div",{className:"flex flex-col md:flex-row gap-4 h-full md:pb-4 overflow-y-auto md:overflow-x-auto",children:ui.map(S=>{const M=v[S];return h.jsxs("div",{className:`bg-slate-100 dark:bg-slate-800 rounded-xl flex flex-col flex-shrink-0 transition-all ${M?"md:w-12 h-auto":"md:w-[280px] md:h-full"}`,children:[h.jsxs("div",{className:"p-3 font-semibold text-slate-600 dark:text-slate-300 border-b border-slate-200 dark:border-slate-700 flex justify-between items-center cursor-pointer md:cursor-default",onClick:()=>{window.innerWidth<768&&q(S)},children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("span",{className:"md:hidden",children:M?h.jsx(Qc,{size:16}):h.jsx(ls,{size:16})}),h.jsx("span",{className:M?"md:hidden":"",children:S})]}),h.jsx("span",{className:"bg-slate-200 dark:bg-slate-700 text-slate-600 dark:text-slate-300 text-xs px-2 py-1 rounded-full",children:t.filter(G=>G.status===S).length})]}),h.jsx("div",{className:`flex-1 overflow-y-auto p-2 space-y-2 transition-all ${M?"hidden":"block"} min-h-[50px] md:min-h-0`,children:t.filter(G=>G.status===S).map(G=>h.jsxs("div",{onClick:()=>T(G),className:"bg-white dark:bg-slate-700 p-3 rounded-lg shadow-sm border border-slate-200 dark:border-slate-600 cursor-pointer hover:shadow-md transition group relative",children:[h.jsxs("div",{className:"flex justify-between items-start mb-2",children:[h.jsx("span",{className:`text-[10px] uppercase font-bold px-2 py-0.5 rounded ${G.type===an.Bug?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:G.type}),h.jsx("div",{className:"text-xs text-slate-400 dark:text-slate-500",children:new Date(G.createdAt).toLocaleDateString()})]}),h.jsx("h4",{className:"font-medium text-slate-800 dark:text-slate-200 mb-1",children:G.title||"Untitled"}),h.jsxs("div",{className:"flex items-center gap-2 mt-3 text-xs text-slate-500 dark:text-slate-400",children:[h.jsx("span",{className:"bg-slate-100 dark:bg-slate-600 px-1.5 py-0.5 rounded",children:I(G.department)}),G.dueDate&&h.jsxs("span",{className:"flex items-center gap-1 text-orange-600 dark:text-orange-400",children:[h.jsx(fl,{size:10}),new Date(G.dueDate).toLocaleDateString()]}),h.jsx("div",{className:"flex-1"}),G.assignedTo&&h.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-100 dark:bg-orange-900 text-orange-600 dark:text-orange-400 flex items-center justify-center font-bold text-[10px] border border-orange-200 dark:border-orange-800",children:k(G.assignedTo)})]})]},G.id))})]},S)})}),P=()=>h.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-x-auto",children:h.jsxs("table",{className:"w-full text-left text-sm text-slate-600 dark:text-slate-300 min-w-[600px]",children:[h.jsx("thead",{className:"bg-slate-50 dark:bg-slate-700 text-xs uppercase font-bold text-slate-500 dark:text-slate-400",children:h.jsxs("tr",{children:[h.jsx("th",{className:"p-4",children:"Title"}),h.jsx("th",{className:"p-4",children:"Type"}),h.jsx("th",{className:"p-4",children:"Status"}),h.jsx("th",{className:"p-4",children:"Assigned"}),h.jsx("th",{className:"p-4",children:"Due Date"}),h.jsx("th",{className:"p-4",children:"Created"})]})}),h.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:t.map(S=>h.jsxs("tr",{onClick:()=>T(S),className:"hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition",children:[h.jsx("td",{className:"p-4 font-medium text-slate-900 dark:text-white",children:S.title||"Untitled"}),h.jsx("td",{className:"p-4",children:h.jsx("span",{className:`text-[10px] uppercase font-bold px-2 py-0.5 rounded ${S.type===an.Bug?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300":"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"}`,children:S.type})}),h.jsx("td",{className:"p-4",children:S.status}),h.jsx("td",{className:"p-4",children:C(S.assignedTo)}),h.jsx("td",{className:"p-4",children:S.dueDate?new Date(S.dueDate).toLocaleDateString():"-"}),h.jsx("td",{className:"p-4 text-slate-400",children:new Date(S.createdAt).toLocaleDateString()})]},S.id))})]})}),W=()=>{const S=t.filter(M=>M.dueDate).sort((M,G)=>(M.dueDate||0)-(G.dueDate||0));return h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 overflow-y-auto",children:[h.jsx("h3",{className:"font-bold text-lg mb-4 text-slate-800 dark:text-white",children:"Upcoming Deadlines"}),S.length===0?h.jsx("div",{className:"text-center text-slate-400 py-10",children:"No tasks with due dates found."}):h.jsx("div",{className:"space-y-6",children:S.map(M=>h.jsxs("div",{onClick:()=>T(M),className:"flex items-center gap-4 p-4 border border-slate-100 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50 cursor-pointer transition",children:[h.jsxs("div",{className:"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 p-3 rounded-lg flex flex-col items-center min-w-[60px]",children:[h.jsx("span",{className:"text-xs uppercase font-bold",children:new Date(M.dueDate).toLocaleString("default",{month:"short"})}),h.jsx("span",{className:"text-xl font-bold",children:new Date(M.dueDate).getDate()})]}),h.jsxs("div",{className:"flex-1",children:[h.jsx("h4",{className:"font-bold text-slate-800 dark:text-white",children:M.title}),h.jsxs("div",{className:"flex gap-2 text-xs text-slate-500 dark:text-slate-400 mt-1",children:[h.jsx("span",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded",children:M.status}),h.jsx("span",{children:""}),h.jsx("span",{children:C(M.assignedTo)})]})]})]},M.id))})]})},Z=()=>{const S=t.filter(M=>M.status===we.Archived).sort((M,G)=>(G.archivedAt||0)-(M.archivedAt||0));return h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-6 overflow-y-auto",children:[h.jsxs("h3",{className:"font-bold text-lg mb-4 text-slate-800 dark:text-white flex items-center gap-2",children:[h.jsx(Ko,{size:20,className:"text-slate-500"}),"Archived Tasks"]}),S.length===0?h.jsx("div",{className:"text-center text-slate-400 py-10",children:"No archived tasks yet. Complete tasks and archive them when done."}):h.jsx("div",{className:"space-y-3",children:S.map(M=>h.jsxs("div",{className:"flex items-center gap-4 p-4 border border-slate-100 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-700/30 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-700/50 transition",onClick:()=>T(M),children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("h4",{className:"font-medium text-slate-800 dark:text-white truncate",children:M.title}),h.jsxs("div",{className:"flex gap-2 text-xs text-slate-500 dark:text-slate-400 mt-1",children:[h.jsx("span",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-0.5 rounded",children:I(M.department)}),h.jsx("span",{children:""}),h.jsx("span",{children:C(M.assignedTo)}),M.archivedAt&&h.jsxs(h.Fragment,{children:[h.jsx("span",{children:""}),h.jsxs("span",{children:["Archived ",new Date(M.archivedAt).toLocaleDateString()]})]})]})]}),h.jsxs("button",{onClick:G=>{G.stopPropagation(),j(M.id)},className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-orange-600 dark:text-orange-400 border border-orange-300 dark:border-orange-700 rounded-lg hover:bg-orange-50 dark:hover:bg-orange-900/20 transition",children:[h.jsx(hl,{size:14}),"Restore"]})]},M.id))})]})};return h.jsxs("div",{className:"h-full flex flex-col",children:[h.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-3 md:mb-4 px-2 md:px-4 gap-3 md:gap-4",children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white self-start md:self-auto",children:"Sprint Planning"}),h.jsxs("div",{className:"flex flex-row items-center gap-3 w-full md:w-auto",children:[h.jsxs("div",{className:"flex items-center gap-1 bg-slate-200 dark:bg-slate-700 p-1 rounded-lg",children:[h.jsx("button",{onClick:()=>m("board"),className:`p-2 rounded-md transition flex items-center justify-center ${f==="board"?"bg-white dark:bg-slate-600 shadow text-orange-600 dark:text-orange-400":"text-slate-500 dark:text-slate-400"}`,title:"Board",children:h.jsx(Rd,{size:18})}),h.jsx("button",{onClick:()=>m("list"),className:`p-2 rounded-md transition flex items-center justify-center ${f==="list"?"bg-white dark:bg-slate-600 shadow text-orange-600 dark:text-orange-400":"text-slate-500 dark:text-slate-400"}`,title:"List",children:h.jsx(bd,{size:18})}),h.jsx("button",{onClick:()=>m("calendar"),className:`p-2 rounded-md transition flex items-center justify-center ${f==="calendar"?"bg-white dark:bg-slate-600 shadow text-orange-600 dark:text-orange-400":"text-slate-500 dark:text-slate-400"}`,title:"Calendar",children:h.jsx(cl,{size:18})}),h.jsx("button",{onClick:()=>m("archived"),className:`p-2 rounded-md transition flex items-center justify-center ${f==="archived"?"bg-white dark:bg-slate-600 shadow text-orange-600 dark:text-orange-400":"text-slate-500 dark:text-slate-400"}`,title:"Archived",children:h.jsx(Ko,{size:18})})]}),h.jsxs("button",{onClick:U,className:"flex-1 md:flex-none flex items-center justify-center gap-2 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition",children:[h.jsx(Gt,{size:20})," ",h.jsx("span",{className:"hidden md:inline",children:"New Item"})]})]})]}),h.jsxs("div",{className:"flex-1 overflow-hidden px-2 md:px-4",children:[f==="board"&&h.jsx($,{}),f==="list"&&h.jsx(P,{}),f==="calendar"&&h.jsx(W,{}),f==="archived"&&h.jsx(Z,{})]}),a&&s&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-2xl max-h-[90vh] flex flex-col shadow-2xl overflow-hidden",children:[h.jsxs("div",{className:"p-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center bg-slate-50 dark:bg-slate-900/50",children:[h.jsx("div",{className:"flex-1 mr-4",children:h.jsx("input",{ref:w,value:s.title,onChange:S=>r({...s,title:S.target.value}),placeholder:"Task Title",className:"text-xl font-bold bg-white dark:bg-slate-800 border-2 border-slate-200 dark:border-slate-600 rounded-lg p-2 focus:ring-2 focus:ring-orange-500 w-full placeholder-slate-400 dark:placeholder-slate-500 text-slate-900 dark:text-white"})}),h.jsxs("button",{onClick:()=>u(!1),className:"text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 bg-slate-100 dark:bg-slate-700 p-2 rounded-full flex items-center justify-center w-8 h-8",children:[h.jsx("span",{className:"sr-only",children:"Close"}),h.jsx(_n,{size:18})]})]}),h.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Type"}),h.jsxs("select",{value:s.type,onChange:S=>r({...s,type:S.target.value}),className:"w-full p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm",children:[h.jsx("option",{value:an.Feature,children:"Feature"}),h.jsx("option",{value:an.Bug,children:"Bug"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Status"}),h.jsxs("select",{value:s.status,onChange:S=>r({...s,status:S.target.value}),className:"w-full p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm",children:[ui.map(S=>h.jsx("option",{value:S,children:S},S)),s.status===we.Archived&&h.jsx("option",{value:we.Archived,children:"Archived"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Team"}),h.jsx("select",{value:s.department,onChange:S=>r({...s,department:S.target.value}),className:"w-full p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm",children:o.map(S=>h.jsx("option",{value:S.id,children:S.name},S.id))})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Assigned To"}),h.jsxs("select",{value:s.assignedTo,onChange:S=>r({...s,assignedTo:S.target.value}),className:"w-full p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm",children:[h.jsx("option",{value:"",children:"Unassigned"}),n.map(S=>h.jsxs("option",{value:S.id,children:[S.firstName," ",S.lastNameInitial,"."]},S.id))]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Due Date"}),h.jsx("input",{type:"date",value:s.dueDate?new Date(s.dueDate).toISOString().substr(0,10):"",onChange:S=>r({...s,dueDate:S.target.valueAsNumber}),className:"w-full p-2 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Description / Notes"}),h.jsx("textarea",{value:s.description,onChange:S=>r({...s,description:S.target.value}),className:"w-full h-32 p-3 rounded-lg border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-slate-900 dark:text-white text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Describe the task, paste meeting minutes, or log bug details..."})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2",children:"Checklist"}),h.jsxs("div",{className:"space-y-2",children:[s.checklist.map((S,M)=>h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("input",{type:"checkbox",checked:S.completed,onChange:G=>{const Se=[...s.checklist];Se[M].completed=G.target.checked,r({...s,checklist:Se})},className:"rounded text-orange-600 focus:ring-orange-500"}),h.jsx("input",{ref:M===s.checklist.length-1?_:null,type:"text",value:S.text,placeholder:"Enter checklist item...",onChange:G=>{const Se=[...s.checklist];Se[M].text=G.target.value,r({...s,checklist:Se})},className:"flex-1 text-sm border border-slate-200 dark:border-slate-600 bg-white dark:bg-slate-700 rounded px-2 py-1 focus:ring-1 focus:ring-orange-500 text-slate-900 dark:text-white placeholder-slate-400"}),h.jsx("button",{onClick:()=>{const G=s.checklist.filter((Se,Ju)=>Ju!==M);r({...s,checklist:G})},className:"text-slate-400 hover:text-red-500 border border-slate-300 dark:border-slate-600 hover:border-red-400 rounded p-1 transition-colors",children:h.jsx(_n,{size:14})})]},M)),h.jsx("button",{onClick:()=>{r({...s,checklist:[...s.checklist,{id:Date.now().toString(),text:"",completed:!1}]}),setTimeout(()=>{var S;(S=_.current)==null||S.focus()},50)},className:"text-sm text-orange-600 dark:text-orange-400 font-medium hover:underline",children:"+ Add Checklist Item"})]})]}),h.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-700 pt-6",children:[h.jsx("h3",{className:"font-bold text-slate-800 dark:text-white mb-4",children:"Activity & Comments"}),h.jsxs("div",{className:"flex gap-2 mb-6",children:[h.jsx("input",{type:"text",value:p,onChange:S=>g(S.target.value),placeholder:"Add a comment...",className:"flex-1 border rounded-lg px-3 py-2 text-sm bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white",onKeyDown:S=>S.key==="Enter"&&R()}),h.jsx("button",{onClick:R,className:"bg-orange-600 text-white p-2 rounded-lg hover:bg-orange-700",children:h.jsx(Hd,{size:18})})]}),h.jsx("div",{className:"space-y-4",children:s.timeline.map(S=>h.jsxs("div",{className:"flex gap-3 text-sm",children:[h.jsx("div",{className:"mt-1 w-6 h-6 rounded-full bg-slate-200 dark:bg-slate-600 flex items-center justify-center text-xs font-bold text-slate-600 dark:text-slate-300 flex-shrink-0",children:S.authorId==="System"?"S":k(S.authorId)}),h.jsxs("div",{className:"flex-1 bg-slate-50 dark:bg-slate-700/50 p-3 rounded-r-lg rounded-bl-lg",children:[h.jsxs("div",{className:"flex justify-between items-start mb-1",children:[h.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:S.authorId==="System"?"System":C(S.authorId)}),h.jsx("span",{className:"text-xs text-slate-400",children:new Date(S.timestamp).toLocaleDateString()})]}),h.jsx("div",{className:S.type==="history"?"italic text-slate-500":"text-slate-800 dark:text-slate-300",children:S.content}),S.type==="comment"&&h.jsx("div",{className:"flex justify-end mt-1",children:h.jsxs("button",{onClick:()=>A(S.id),className:"text-xs text-red-400 hover:text-red-600 flex items-center gap-1",children:[h.jsx(Ge,{size:10})," Delete"]})})]})]},S.id))})]})]}),h.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-slate-700 flex justify-between bg-slate-50 dark:bg-slate-900/50",children:[h.jsxs("div",{className:"flex gap-2",children:[!c&&h.jsxs("button",{onClick:()=>b(s.id),className:"px-3 py-2 rounded-lg text-red-600 dark:text-red-400 border border-red-300 dark:border-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 font-medium flex items-center gap-1 transition",children:[h.jsx(Ge,{size:16}),"Delete"]}),!c&&s.status===we.Done&&h.jsxs("button",{onClick:V,className:"px-3 py-2 rounded-lg text-slate-600 dark:text-slate-300 border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700 font-medium flex items-center gap-1 transition",children:[h.jsx(Ko,{size:16}),"Archive"]})]}),h.jsxs("div",{className:"flex gap-3",children:[h.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 rounded-lg text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 font-medium",children:"Cancel"}),h.jsx("button",{onClick:E,className:"px-6 py-2 rounded-lg bg-orange-600 text-white font-medium hover:bg-orange-700 shadow-sm",children:"Save Task"})]})]})]})}),x&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 max-w-sm w-full shadow-2xl",children:[h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white mb-2",children:"Delete Task?"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"This task will be permanently deleted. This action cannot be undone."}),h.jsxs("div",{className:"flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>b(null),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition",children:"Cancel"}),h.jsx("button",{onClick:()=>z(x),className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition",children:"Delete"})]})]})})]})},Oh=()=>{const{scoutingReports:t,addScoutingReport:e,deleteScoutingReport:n}=ge(),[o,s]=D.useState(!1),[r,a]=D.useState(null),[u,c]=D.useState({hasAutonomous:!1,autoScore:0,intakeType:"No Intake",autoAim:!1,farShooting:!1,shotsTaken:0,shotsMissed:0,parking:"No Park",rating:3,endGameNotes:""}),d=()=>{u.teamNumber&&(e({teamNumber:u.teamNumber||"",matchNumber:u.matchNumber||0,hasAutonomous:u.hasAutonomous||!1,autoScore:u.autoScore||0,intakeType:u.intakeType||"No Intake",autoAim:u.autoAim||!1,farShooting:u.farShooting||!1,shotsTaken:u.shotsTaken||0,shotsMissed:u.shotsMissed||0,parking:u.parking||"No Park",endGameNotes:u.endGameNotes||"",rating:u.rating||3}),s(!1),m())},f=g=>{n(g),a(null)},m=()=>{c({hasAutonomous:!1,autoScore:0,intakeType:"No Intake",autoAim:!1,farShooting:!1,shotsTaken:0,shotsMissed:0,parking:"No Park",rating:3,endGameNotes:""})},p=(g,v)=>{c(y=>({...y,[g]:Math.max(0,(y[g]||0)+v)}))};return h.jsxs("div",{className:"h-full flex flex-col max-w-5xl mx-auto w-full p-2 md:p-6",children:[h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"flex justify-between items-center",children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Scouting Reports"}),h.jsxs("button",{onClick:()=>s(!0),className:"bg-orange-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-orange-700 transition shadow-sm",children:[h.jsx(Gt,{size:20})," Scout Match"]})]}),h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:[t.map(g=>h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 md:p-5 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md transition",children:[h.jsxs("div",{className:"flex justify-between items-start mb-4",children:[h.jsx("div",{children:h.jsxs("div",{className:"text-2xl font-black text-slate-800 dark:text-white",children:["#",g.teamNumber]})}),h.jsxs("div",{className:"bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded text-xs font-bold text-slate-600 dark:text-slate-300",children:["Match ",g.matchNumber]})]}),h.jsxs("div",{className:"space-y-2 text-sm text-slate-600 dark:text-slate-300 mb-4",children:[h.jsxs("div",{className:"flex justify-between border-b border-slate-100 dark:border-slate-700 pb-1",children:[h.jsx("span",{children:"Autonomous"}),h.jsx("span",{className:g.hasAutonomous?"text-green-600 dark:text-green-400 font-bold":"text-slate-400",children:g.hasAutonomous?`${g.autoScore} pts`:"No"})]}),h.jsxs("div",{className:"flex justify-between border-b border-slate-100 dark:border-slate-700 pb-1",children:[h.jsx("span",{children:"Intake"}),h.jsx("span",{className:"font-medium",children:g.intakeType})]}),h.jsxs("div",{className:"flex justify-between border-b border-slate-100 dark:border-slate-700 pb-1",children:[h.jsx("span",{children:"Shooting"}),h.jsxs("div",{className:"text-right",children:[h.jsxs("div",{children:[g.shotsTaken," / ",g.shotsTaken+g.shotsMissed," Hits"]}),h.jsxs("div",{className:"text-xs text-slate-400",children:[g.farShooting&&"Far ",g.autoAim&&"Auto-Aim"]})]})]}),h.jsxs("div",{className:"flex justify-between border-b border-slate-100 dark:border-slate-700 pb-1",children:[h.jsx("span",{children:"Parking"}),h.jsx("span",{className:"font-medium text-orange-600 dark:text-orange-400",children:g.parking})]})]}),h.jsxs("div",{className:"flex items-center justify-between mb-2",children:[h.jsx("div",{className:"flex items-center gap-1 text-yellow-500",children:[...Array(5)].map((v,y)=>h.jsx(ef,{size:14,fill:y<g.rating?"currentColor":"none",className:y<g.rating?"":"text-slate-300 dark:text-slate-600"},y))}),h.jsx("button",{onClick:()=>a(g.id),className:"p-1.5 text-slate-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:"Delete report",children:h.jsx(Ge,{size:16})})]}),g.endGameNotes&&h.jsxs("p",{className:"text-xs bg-slate-50 dark:bg-slate-700 p-2 rounded text-slate-500 dark:text-slate-300 italic",children:['"',g.endGameNotes,'"']})]},g.id)),t.length===0&&h.jsx("div",{className:"col-span-full text-center py-12 text-slate-400 bg-slate-50 dark:bg-slate-800 rounded-xl border border-dashed border-slate-300 dark:border-slate-700",children:'No scouting data yet. Click "Scout Match" to begin.'})]})]}),r&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 max-w-sm w-full shadow-2xl",children:[h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white mb-2",children:"Delete Report?"}),h.jsx("p",{className:"text-slate-600 dark:text-slate-300 mb-6",children:"This scouting report will be permanently deleted. This action cannot be undone."}),h.jsxs("div",{className:"flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>a(null),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition",children:"Cancel"}),h.jsx("button",{onClick:()=>f(r),className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition",children:"Delete"})]})]})}),o&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh] shadow-2xl",children:[h.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700 font-bold text-lg text-slate-900 dark:text-white",children:"New Scouting Report"}),h.jsxs("div",{className:"p-6 space-y-4 overflow-y-auto",children:[h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Team #"}),h.jsx("input",{type:"text",className:"w-full border dark:border-slate-600 rounded p-2 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",value:u.teamNumber||"",onChange:g=>c({...u,teamNumber:g.target.value})})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Match #"}),h.jsx("input",{type:"number",className:"w-full border dark:border-slate-600 rounded p-2 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",value:u.matchNumber||"",onChange:g=>c({...u,matchNumber:parseInt(g.target.value)})})]})]}),h.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/50 p-4 rounded-lg space-y-3",children:[h.jsx("h4",{className:"font-bold text-slate-700 dark:text-white text-sm",children:"Autonomous"}),h.jsxs("label",{className:"flex items-center gap-3 text-slate-800 dark:text-white",children:[h.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded text-orange-600",checked:u.hasAutonomous,onChange:g=>c({...u,hasAutonomous:g.target.checked})}),h.jsx("span",{className:"font-medium",children:"Has Autonomous"})]}),u.hasAutonomous&&h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Auto Score"}),h.jsx("input",{type:"number",className:"w-full border dark:border-slate-600 rounded p-2 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",value:u.autoScore,onChange:g=>c({...u,autoScore:parseInt(g.target.value)})})]})]}),h.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/50 p-4 rounded-lg space-y-3",children:[h.jsx("h4",{className:"font-bold text-slate-700 dark:text-white text-sm",children:"TeleOp"}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase mb-1 block",children:"Intake Type"}),h.jsxs("select",{className:"w-full border dark:border-slate-600 rounded p-2 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",value:u.intakeType,onChange:g=>c({...u,intakeType:g.target.value}),children:[h.jsx("option",{children:"No Intake"}),h.jsx("option",{children:"Human Player"}),h.jsx("option",{children:"Automatic"})]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("label",{className:"flex items-center gap-2 text-slate-800 dark:text-white text-sm",children:[h.jsx("input",{type:"checkbox",checked:u.autoAim,onChange:g=>c({...u,autoAim:g.target.checked})}),"Auto Aim"]}),h.jsxs("label",{className:"flex items-center gap-2 text-slate-800 dark:text-white text-sm",children:[h.jsx("input",{type:"checkbox",checked:u.farShooting,onChange:g=>c({...u,farShooting:g.target.checked})}),"Far Shooting"]})]}),h.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase block mb-1",children:"Shots Taken"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>p("shotsTaken",-1),className:"p-2 bg-slate-200 dark:bg-slate-600 rounded",children:h.jsx(Gr,{size:14})}),h.jsx("span",{className:"flex-1 text-center font-mono font-bold text-lg dark:text-white",children:u.shotsTaken}),h.jsx("button",{onClick:()=>p("shotsTaken",1),className:"p-2 bg-slate-200 dark:bg-slate-600 rounded",children:h.jsx(Gt,{size:14})})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase block mb-1",children:"Shots Missed"}),h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("button",{onClick:()=>p("shotsMissed",-1),className:"p-2 bg-slate-200 dark:bg-slate-600 rounded",children:h.jsx(Gr,{size:14})}),h.jsx("span",{className:"flex-1 text-center font-mono font-bold text-lg dark:text-white",children:u.shotsMissed}),h.jsx("button",{onClick:()=>p("shotsMissed",1),className:"p-2 bg-slate-200 dark:bg-slate-600 rounded",children:h.jsx(Gt,{size:14})})]})]})]})]}),h.jsxs("div",{className:"bg-slate-50 dark:bg-slate-700/50 p-4 rounded-lg space-y-3",children:[h.jsx("h4",{className:"font-bold text-slate-700 dark:text-white text-sm",children:"End Game"}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase block mb-1",children:"Parking"}),h.jsxs("select",{className:"w-full border dark:border-slate-600 rounded p-2 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",value:u.parking,onChange:g=>c({...u,parking:g.target.value}),children:[h.jsx("option",{children:"No Park"}),h.jsx("option",{children:"Partial Park"}),h.jsx("option",{children:"Full Park"})]})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Driver Rating (1-5)"}),h.jsx("input",{type:"range",min:"1",max:"5",className:"w-full accent-orange-600",value:u.rating||3,onChange:g=>c({...u,rating:parseInt(g.target.value)})}),h.jsxs("div",{className:"flex justify-between text-xs text-slate-400",children:[h.jsx("span",{children:"Novice"}),h.jsx("span",{children:"Expert"})]})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase",children:"Notes"}),h.jsx("textarea",{className:"w-full border dark:border-slate-600 rounded p-2 h-20 bg-white dark:bg-slate-700 text-slate-900 dark:text-white",value:u.endGameNotes||"",onChange:g=>c({...u,endGameNotes:g.target.value})})]})]}),h.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 border-t border-slate-200 dark:border-slate-700 flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-700 rounded",children:"Cancel"}),h.jsx("button",{onClick:d,className:"px-6 py-2 bg-orange-600 text-white rounded font-medium hover:bg-orange-700",children:"Save Report"})]})]})})]})},Kh=()=>{const[t,e]=D.useState(Hh),[n,o]=D.useState(!1),[s,r]=D.useState(""),a=m=>{n||e(t.map(p=>p.id===m?{...p,checked:!p.checked}:p))},u=()=>{e(t.map(m=>({...m,checked:!1})))},c=()=>{s.trim()&&(e([...t,{id:Date.now().toString(),text:s.trim(),checked:!1}]),r(""))},d=m=>{e(t.filter(p=>p.id!==m))},f=(m,p)=>{e(t.map(g=>g.id===m?{...g,assignedTo:p}:g))};return h.jsx("div",{className:"h-full flex flex-col max-w-3xl mx-auto w-full p-2 md:p-6",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex flex-col h-full",children:[h.jsxs("div",{className:"p-4 md:p-6 border-b border-slate-100 dark:border-slate-700 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 bg-slate-50 dark:bg-slate-900/50",children:[h.jsxs("div",{children:[h.jsx("h2",{className:"text-xl font-bold text-slate-800 dark:text-white",children:"Pre-Match Checklist"}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Reset this list before every match."})]}),h.jsxs("div",{className:"flex gap-2 self-end sm:self-auto",children:[h.jsx("button",{onClick:()=>o(!n),className:`p-2 rounded-full transition flex items-center justify-center w-9 h-9 ${n?"bg-orange-100 text-orange-600":"text-slate-500 hover:text-slate-900 hover:bg-slate-200 dark:text-slate-400 dark:hover:bg-slate-700"}`,title:"Edit Checklist",children:h.jsx(Jd,{size:20})}),h.jsx("button",{onClick:u,className:"text-slate-500 hover:text-orange-600 p-2 rounded-full hover:bg-orange-50 dark:text-slate-400 dark:hover:bg-slate-700 transition flex items-center justify-center w-9 h-9",title:"Reset Checklist",children:h.jsx(hl,{size:20})})]})]}),h.jsxs("div",{className:"divide-y divide-slate-100 dark:divide-slate-700 overflow-y-auto flex-1 pr-1 custom-scrollbar",children:[t.map(m=>h.jsxs("div",{className:`p-4 flex items-center gap-4 transition ${m.checked?"bg-green-50/50 dark:bg-green-900/20":"hover:bg-slate-50 dark:hover:bg-slate-700/50"}`,children:[h.jsx("div",{className:"cursor-pointer flex-shrink-0",onClick:()=>a(m.id),children:!n&&h.jsx("div",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center transition ${m.checked?"bg-green-500 border-green-500 text-white":"border-slate-300 dark:border-slate-500 text-transparent"}`,children:h.jsx(td,{size:16,fill:"currentColor",className:m.checked?"text-white":""})})}),h.jsx("span",{onClick:()=>a(m.id),className:`text-lg font-medium flex-1 cursor-pointer transition ${m.checked?"text-slate-400 line-through dark:text-slate-500":"text-slate-700 dark:text-slate-200"}`,children:m.text}),n&&h.jsx("div",{className:"relative",children:h.jsxs("select",{className:"text-xs border border-slate-200 dark:border-slate-600 rounded p-1 bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-300 max-w-[120px]",value:m.assignedTo||"",onChange:p=>f(m.id,p.target.value),children:[h.jsx("option",{value:"",children:"Anyone"}),h.jsx("optgroup",{label:"Teams",children:Vh.map(p=>h.jsx("option",{value:p.name,children:p.name},p.id))}),h.jsx("optgroup",{label:"Members",children:qh.map(p=>h.jsxs("option",{value:p.firstName,children:[p.firstName," ",p.lastNameInitial,"."]},p.id))})]})}),!n&&m.assignedTo&&h.jsx("span",{className:"text-xs bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400 px-2 py-1 rounded flex-shrink-0",children:m.assignedTo}),n&&h.jsx("button",{onClick:p=>{p.stopPropagation(),d(m.id)},className:"text-red-500 hover:text-red-700 p-2",children:h.jsx(Ge,{size:18})})]},m.id)),n&&h.jsxs("div",{className:"p-4 flex gap-2 bg-slate-50 dark:bg-slate-700/50",children:[h.jsx("input",{type:"text",value:s,onChange:m=>r(m.target.value),onKeyDown:m=>m.key==="Enter"&&c(),placeholder:"Add new item...",className:"flex-1 border rounded px-3 py-2 bg-white dark:bg-slate-800 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white"}),h.jsx("button",{onClick:c,className:"bg-orange-600 text-white px-4 py-2 rounded font-bold",children:"Add"})]})]})]})})},Jh=()=>{const t=D.useRef(null),[e,n]=D.useState("#ef4444"),[o,s]=D.useState("draw"),{matchPlans:r,addMatchPlan:a,deleteMatchPlan:u,getCurrentSeason:c,currentSeasonId:d}=ge(),f=c(),m=(f==null?void 0:f.fieldImageUrl)||Bh,p=r.filter(S=>!S.seasonId||S.seasonId===d),[g,v]=D.useState([]),[y,x]=D.useState(""),[b,_]=D.useState(""),[w,C]=D.useState(""),[I,k]=D.useState(!1),[T,U]=D.useState(!1),[E,R]=D.useState(!1),[A,z]=D.useState(!1),[V,j]=D.useState(""),q=()=>{a({title:V||`Match Plan ${new Date().toLocaleString()}`,drawingData:g,notes:w,allianceTeam:b,partnerAutonomous:I,partnerPark:T}),R(!1),j(""),alert("Plan saved!")},$=S=>{v(S.drawingData),_(S.allianceTeam),C(S.notes),k(S.partnerAutonomous),U(S.partnerPark),z(!1)};D.useEffect(()=>{if(!t.current)return;const S=Ln(t.current),M=tc().on("start",function(G){Ln(this).raise().attr("stroke","white").attr("stroke-width",3)}).on("drag",function(G){o==="drag"&&Ln(this).attr("cx",G.x).attr("cy",G.y)}).on("end",function(G){Ln(this).attr("stroke","white").attr("stroke-width",2)});S.selectAll(".draggable-robot").call(M)},[o]);const P=S=>{if(o!=="draw")return;const M=t.current;if(!M)return;const G=M.createSVGPoint();G.x=S.nativeEvent.offsetX,G.y=S.nativeEvent.offsetY,x(`M ${G.x} ${G.y}`),M.setPointerCapture(S.pointerId)},W=S=>{o!=="draw"||!y||x(M=>`${M} L ${S.nativeEvent.offsetX} ${S.nativeEvent.offsetY}`)},Z=S=>{o!=="draw"||!y||(v([...g,{d:y,stroke:e,width:3}]),x(""),t.current&&t.current.releasePointerCapture(S.pointerId))};return h.jsxs("div",{className:"flex flex-col lg:flex-row gap-2 md:gap-4 lg:h-full h-auto lg:overflow-hidden overflow-visible",children:[h.jsxs("div",{className:"flex-1 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 flex flex-col overflow-hidden relative min-h-[500px] lg:min-h-0",children:[h.jsxs("div",{className:"sticky top-0 z-20 bg-slate-100 dark:bg-slate-700 p-2 flex items-center justify-between border-b border-slate-200 dark:border-slate-600 shadow-sm",children:[h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>s("draw"),className:`p-2 rounded ${o==="draw"?"bg-white dark:bg-slate-600 shadow text-orange-600 dark:text-orange-400":"text-slate-500 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-600"}`,children:h.jsx(Dd,{size:18})}),h.jsx("div",{className:"h-8 w-px bg-slate-300 dark:bg-slate-600 mx-1"}),h.jsx("button",{onClick:()=>n("#ef4444"),className:`w-6 h-6 rounded-full bg-red-500 border-2 ${e==="#ef4444"?"border-slate-800 dark:border-white":"border-transparent"}`}),h.jsx("button",{onClick:()=>n("#3b82f6"),className:`w-6 h-6 rounded-full bg-blue-500 border-2 ${e==="#3b82f6"?"border-slate-800 dark:border-white":"border-transparent"}`}),h.jsx("button",{onClick:()=>n("#22c55e"),className:`w-6 h-6 rounded-full bg-green-500 border-2 ${e==="#22c55e"?"border-slate-800 dark:border-white":"border-transparent"}`}),h.jsx("button",{onClick:()=>n("#facc15"),className:`w-6 h-6 rounded-full bg-yellow-400 border-2 ${e==="#facc15"?"border-slate-800 dark:border-white":"border-transparent"}`})]}),h.jsxs("div",{className:"flex gap-2",children:[h.jsx("button",{onClick:()=>{const S=[...g];S.pop(),v(S)},className:"p-2 text-slate-500 dark:text-slate-400 hover:text-slate-800 dark:hover:text-white hover:bg-slate-200 dark:hover:bg-slate-600 rounded",title:"Undo",children:h.jsx(nf,{size:18})}),h.jsx("button",{onClick:()=>v([]),className:"p-2 text-slate-500 dark:text-slate-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded",title:"Clear",children:h.jsx(Ge,{size:18})}),h.jsx("div",{className:"h-8 w-px bg-slate-300 dark:bg-slate-600 mx-1"}),h.jsx("button",{onClick:()=>z(!0),className:"p-2 text-slate-500 dark:text-slate-400 hover:text-orange-600 hover:bg-orange-50 dark:hover:bg-orange-900/30 rounded",title:"Load Plans",children:h.jsx(Ur,{size:18})}),h.jsx("button",{onClick:()=>R(!0),className:"p-2 text-slate-500 dark:text-slate-400 hover:text-green-600 hover:bg-green-50 dark:hover:bg-green-900/30 rounded",title:"Save Plan",children:h.jsx(Vr,{size:18})})]})]}),h.jsxs("div",{className:"relative flex-1 bg-slate-900 overflow-hidden cursor-crosshair",children:[h.jsx("img",{src:m,className:"absolute inset-0 w-full h-full object-contain opacity-50 pointer-events-none select-none",alt:"Field"}),h.jsxs("svg",{ref:t,className:"absolute inset-0 w-full h-full z-10 touch-none",onPointerDown:P,onPointerMove:W,onPointerUp:Z,onPointerCancel:Z,onPointerLeave:Z,children:[g.map((S,M)=>h.jsx("path",{d:S.d,stroke:S.stroke,strokeWidth:S.width,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},M)),y&&h.jsx("path",{d:y,stroke:e,strokeWidth:3,fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]})]})]}),h.jsxs("div",{className:"w-full lg:w-80 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-3 md:p-4 flex flex-col",children:[h.jsx("h3",{className:"font-bold text-slate-800 dark:text-white mb-4",children:"Match Notes"}),h.jsxs("div",{className:"space-y-3 md:space-y-4 flex-1",children:[h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Alliance Partner"}),h.jsx("input",{type:"text",value:b,onChange:S=>_(S.target.value),placeholder:"Team # / Name",className:"w-full p-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm text-slate-900 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Our Strategy"}),h.jsx("textarea",{value:w,onChange:S=>C(S.target.value),className:"w-full h-32 p-2 bg-slate-50 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg text-sm resize-none text-slate-900 dark:text-white",placeholder:`1. Autonomous path...
2. TeleOp focus...`})]}),h.jsxs("div",{children:[h.jsx("label",{className:"block text-xs font-semibold text-slate-500 dark:text-slate-400 mb-1",children:"Partner Capabilities"}),h.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[h.jsxs("label",{className:"flex items-center gap-2 p-2 border border-slate-200 dark:border-slate-600 rounded bg-slate-50 dark:bg-slate-700 text-xs text-slate-800 dark:text-slate-200",children:[h.jsx("input",{type:"checkbox",checked:I,onChange:S=>k(S.target.checked)})," Autonomous"]}),h.jsxs("label",{className:"flex items-center gap-2 p-2 border border-slate-200 dark:border-slate-600 rounded bg-slate-50 dark:bg-slate-700 text-xs text-slate-800 dark:text-slate-200",children:[h.jsx("input",{type:"checkbox",checked:T,onChange:S=>U(S.target.checked)})," Lifted Park"]})]})]})]}),h.jsxs("div",{className:"flex gap-2 mt-4 lg:hidden",children:[h.jsxs("button",{onClick:()=>z(!0),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-200 rounded-lg font-semibold text-sm",children:[h.jsx(Ur,{size:18})," Load"]}),h.jsxs("button",{onClick:()=>R(!0),className:"flex-1 flex items-center justify-center gap-1.5 px-3 py-2.5 bg-green-600 text-white rounded-lg font-semibold text-sm shadow-md",children:[h.jsx(Vr,{size:18})," Save"]})]})]}),E&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 w-full max-w-sm",children:[h.jsx("h3",{className:"text-lg font-bold mb-4 text-slate-900 dark:text-white",children:"Save Match Plan"}),h.jsx("input",{autoFocus:!0,type:"text",placeholder:"Plan Name (e.g. Match 1)",value:V,onChange:S=>j(S.target.value),onKeyDown:S=>S.key==="Enter"&&q(),className:"w-full p-2 border border-slate-300 dark:border-slate-600 rounded mb-4 bg-white dark:bg-slate-700 text-slate-900 dark:text-white"}),h.jsxs("div",{className:"flex justify-end gap-2",children:[h.jsx("button",{onClick:()=>R(!1),className:"px-4 py-2 text-slate-600 dark:text-slate-300",children:"Cancel"}),h.jsx("button",{onClick:q,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Save"})]})]})}),A&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 w-full max-w-md max-h-[80vh] flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Saved Plans"}),h.jsx("button",{onClick:()=>z(!1),children:h.jsx(_n,{})})]}),h.jsx("div",{className:"flex-1 overflow-y-auto space-y-2",children:p.length===0?h.jsx("div",{className:"text-center text-slate-500 py-8",children:"No saved plans found."}):p.map(S=>h.jsxs("div",{className:"flex items-center justify-between p-3 border border-slate-200 dark:border-slate-700 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-700/50",children:[h.jsxs("div",{className:"cursor-pointer flex-1",onClick:()=>$(S),children:[h.jsx("div",{className:"font-bold text-slate-800 dark:text-white",children:S.title}),h.jsxs("div",{className:"text-xs text-slate-500",children:[new Date(S.updatedAt).toLocaleDateString(),"  ",S.allianceTeam||"No Team"]})]}),h.jsx("button",{onClick:()=>{u(S.id)},className:"p-2 text-red-400 hover:text-red-600",children:h.jsx(Ge,{size:16})})]},S.id))})]})})]})};var zh={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let jh,Wh;function Yh(){return{geminiUrl:jh,vertexUrl:Wh}}function Qh(t,e,n,o){var s,r;if(!(t!=null&&t.baseUrl)){const a=Yh();return e?(s=a.vertexUrl)!==null&&s!==void 0?s:n:(r=a.geminiUrl)!==null&&r!==void 0?r:o}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ye{}function F(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(o,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];return r!=null?String(r):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function l(t,e,n){for(let r=0;r<e.length-1;r++){const a=e[r];if(a.endsWith("[]")){const u=a.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(t[u])){const c=t[u];if(Array.isArray(n))for(let d=0;d<c.length;d++){const f=c[d];l(f,e.slice(r+1),n[d])}else for(const d of c)l(d,e.slice(r+1),n)}return}else if(a.endsWith("[0]")){const u=a.slice(0,-3);u in t||(t[u]=[{}]);const c=t[u];l(c[0],e.slice(r+1),n);return}(!t[a]||typeof t[a]!="object")&&(t[a]={}),t=t[a]}const o=e[e.length-1],s=t[o];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${o}`)}else o==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[o]=n}function i(t,e,n=void 0){try{if(e.length===1&&e[0]==="_self")return t;for(let o=0;o<e.length;o++){if(typeof t!="object"||t===null)return n;const s=e[o];if(s.endsWith("[]")){const r=s.slice(0,-2);if(r in t){const a=t[r];return Array.isArray(a)?a.map(u=>i(u,e.slice(o+1),n)):n}else return n}else t=t[s]}return t}catch(o){if(o instanceof TypeError)return n;throw o}}function Xh(t,e){for(const[n,o]of Object.entries(e)){const s=n.split("."),r=o.split("."),a=new Set;let u=-1;for(let c=0;c<s.length;c++)if(s[c]==="*"){u=c;break}if(u!==-1&&r.length>u)for(let c=u;c<r.length;c++){const d=r[c];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&a.add(d)}Us(t,s,r,0,a)}}function Us(t,e,n,o,s){if(o>=e.length||typeof t!="object"||t===null)return;const r=e[o];if(r.endsWith("[]")){const a=r.slice(0,-2),u=t;if(a in u&&Array.isArray(u[a]))for(const c of u[a])Us(c,e,n,o+1,s)}else if(r==="*"){if(typeof t=="object"&&t!==null&&!Array.isArray(t)){const a=t,u=Object.keys(a).filter(d=>!d.startsWith("_")&&!s.has(d)),c={};for(const d of u)c[d]=a[d];for(const[d,f]of Object.entries(c)){const m=[];for(const p of n.slice(o))p==="*"?m.push(d):m.push(p);l(a,m,f)}for(const d of u)delete a[d]}}else{const a=t;r in a&&Us(a[r],e,n,o+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fr(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zh(t){const e={},n=i(t,["operationName"]);n!=null&&l(e,["operationName"],n);const o=i(t,["resourceName"]);return o!=null&&l(e,["_url","resourceName"],o),e}function ep(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata"]);o!=null&&l(e,["metadata"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["response","generateVideoResponse"]);return a!=null&&l(e,["response"],np(a)),e}function tp(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata"]);o!=null&&l(e,["metadata"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["response"]);return a!=null&&l(e,["response"],op(a)),e}function np(t){const e={},n=i(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>sp(a))),l(e,["generatedVideos"],r)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&l(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&l(e,["raiMediaFilteredReasons"],s),e}function op(t){const e={},n=i(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>rp(a))),l(e,["generatedVideos"],r)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&l(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&l(e,["raiMediaFilteredReasons"],s),e}function sp(t){const e={},n=i(t,["video"]);return n!=null&&l(e,["video"],dp(n)),e}function rp(t){const e={},n=i(t,["_self"]);return n!=null&&l(e,["video"],fp(n)),e}function ip(t){const e={},n=i(t,["operationName"]);return n!=null&&l(e,["_url","operationName"],n),e}function ap(t){const e={},n=i(t,["operationName"]);return n!=null&&l(e,["_url","operationName"],n),e}function lp(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata"]);o!=null&&l(e,["metadata"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["response"]);return a!=null&&l(e,["response"],up(a)),e}function up(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["parent"]);o!=null&&l(e,["parent"],o);const s=i(t,["documentName"]);return s!=null&&l(e,["documentName"],s),e}function Xl(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata"]);o!=null&&l(e,["metadata"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["response"]);return a!=null&&l(e,["response"],cp(a)),e}function cp(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["parent"]);o!=null&&l(e,["parent"],o);const s=i(t,["documentName"]);return s!=null&&l(e,["documentName"],s),e}function dp(t){const e={},n=i(t,["uri"]);n!=null&&l(e,["uri"],n);const o=i(t,["encodedVideo"]);o!=null&&l(e,["videoBytes"],fr(o));const s=i(t,["encoding"]);return s!=null&&l(e,["mimeType"],s),e}function fp(t){const e={},n=i(t,["gcsUri"]);n!=null&&l(e,["uri"],n);const o=i(t,["bytesBase64Encoded"]);o!=null&&l(e,["videoBytes"],fr(o));const s=i(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ci;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(ci||(ci={}));var di;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(di||(di={}));var fi;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(fi||(fi={}));var dt;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(dt||(dt={}));var hi;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(hi||(hi={}));var pi;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(pi||(pi={}));var mi;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(mi||(mi={}));var gi;(function(t){t.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",t.HTTP_IN_QUERY="HTTP_IN_QUERY",t.HTTP_IN_HEADER="HTTP_IN_HEADER",t.HTTP_IN_PATH="HTTP_IN_PATH",t.HTTP_IN_BODY="HTTP_IN_BODY",t.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(gi||(gi={}));var yi;(function(t){t.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",t.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",t.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",t.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(yi||(yi={}));var vi;(function(t){t.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH",t.MINIMAL="MINIMAL"})(vi||(vi={}));var xi;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(xi||(xi={}));var bi;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(bi||(bi={}));var _i;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(_i||(_i={}));var wi;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",t.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",t.NO_IMAGE="NO_IMAGE",t.IMAGE_RECITATION="IMAGE_RECITATION",t.IMAGE_OTHER="IMAGE_OTHER"})(wi||(wi={}));var Ci;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Ci||(Ci={}));var Ti;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Ti||(Ti={}));var Si;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Si||(Si={}));var Ei;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY",t.MODEL_ARMOR="MODEL_ARMOR",t.JAILBREAK="JAILBREAK"})(Ei||(Ei={}));var Ii;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Ii||(Ii={}));var Co;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(Co||(Co={}));var ki;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ki||(ki={}));var Ni;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Ni||(Ni={}));var Ai;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Ai||(Ai={}));var Fs;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Fs||(Fs={}));var Pi;(function(t){t.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",t.TUNING_TASK_I2V="TUNING_TASK_I2V",t.TUNING_TASK_T2V="TUNING_TASK_T2V",t.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Pi||(Pi={}));var Ri;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",t.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(Ri||(Ri={}));var Mi;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Mi||(Mi={}));var Di;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(Di||(Di={}));var Ui;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Ui||(Ui={}));var Fi;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Fi||(Fi={}));var Li;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(Li||(Li={}));var Gi;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Gi||(Gi={}));var qi;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(qi||(qi={}));var Vi;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Vi||(Vi={}));var Hi;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Hi||(Hi={}));var Bi;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Bi||(Bi={}));var $i;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})($i||($i={}));var Oi;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Oi||(Oi={}));var Ki;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Ki||(Ki={}));var Ji;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Ji||(Ji={}));var zi;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(zi||(zi={}));var ji;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(ji||(ji={}));var Wi;(function(t){t.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",t.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Wi||(Wi={}));var Yi;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.STATE_PENDING="STATE_PENDING",t.STATE_ACTIVE="STATE_ACTIVE",t.STATE_FAILED="STATE_FAILED"})(Yi||(Yi={}));var Qi;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Qi||(Qi={}));var Xi;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Xi||(Xi={}));var Zi;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Zi||(Zi={}));var ea;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(ea||(ea={}));var ta;(function(t){t.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",t.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",t.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(ta||(ta={}));var na;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(na||(na={}));var oa;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(oa||(oa={}));var sa;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(sa||(sa={}));var ra;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ra||(ra={}));var ia;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(ia||(ia={}));var aa;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(aa||(aa={}));var Ft;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})(Ft||(Ft={}));class Ls{constructor(e){const n={};for(const o of e.headers.entries())n[o[0]]=o[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class ln{get text(){var e,n,o,s,r,a,u,c;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",f=!1;const m=[];for(const p of(c=(u=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[g,v]of Object.entries(p))g!=="text"&&g!=="thought"&&g!=="thoughtSignature"&&(v!==null||v!==void 0)&&m.push(g);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;f=!0,d+=p.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),f?d:void 0}get data(){var e,n,o,s,r,a,u,c;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const f=[];for(const m of(c=(u=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[p,g]of Object.entries(m))p!=="inlineData"&&(g!==null||g!==void 0)&&f.push(p);m.inlineData&&typeof m.inlineData.data=="string"&&(d+=atob(m.inlineData.data))}return f.length>0&&console.warn(`there are non-data parts ${f} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,o,s,r,a,u,c;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(f=>f.functionCall).map(f=>f.functionCall).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,n,o,s,r,a,u,c,d;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const f=(c=(u=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,o,s,r,a,u,c,d;if(((s=(o=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||o===void 0?void 0:o.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const f=(c=(u=(a=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((f==null?void 0:f.length)!==0)return(d=f==null?void 0:f[0])===null||d===void 0?void 0:d.output}}class la{}class ua{}class hp{}class pp{}class mp{}class gp{}class ca{}class da{}class fa{}class yp{}class To{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new To;let s;const r=e;return n?s=tp(r):s=ep(r),Object.assign(o,s),o}}class ha{}class pa{}class ma{}class ga{}class vp{}class xp{}class bp{}class hr{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new hr,r=lp(e);return Object.assign(o,r),o}}class _p{}class wp{}class Cp{}class ya{}class Tp{get text(){var e,n,o;let s="",r=!1;const a=[];for(const u of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&a.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;r=!0,s+=u.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?s:void 0}get data(){var e,n,o;let s="";const r=[];for(const a of(o=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&o!==void 0?o:[]){for(const[u,c]of Object.entries(a))u!=="inlineData"&&c!==null&&r.push(u);a.inlineData&&typeof a.inlineData.data=="string"&&(s+=atob(a.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class Sp{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class pr{_fromAPIResponse({apiResponse:e,_isVertexAI:n}){const o=new pr,r=Xl(e);return Object.assign(o,r),o}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Q(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Zl(t,e){const n=Q(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function eu(t){return Array.isArray(t)?t.map(e=>So(e)):[So(t)]}function So(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function tu(t){const e=So(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function nu(t){const e=So(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function va(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function ou(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>va(e)):[va(t)]}function Gs(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function xa(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function ba(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function de(t){if(t==null)throw new Error("ContentUnion is required");return Gs(t)?t:{role:"user",parts:ou(t)}}function mr(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const o=de(n);return o.parts&&o.parts.length>0&&o.parts[0].text!==void 0?[o.parts[0].text]:[]});if(t.isVertexAI()){const n=de(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>de(n)):[de(e)]}function Ce(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(xa(t)||ba(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[de(t)]}const e=[],n=[],o=Gs(t[0]);for(const s of t){const r=Gs(s);if(r!=o)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(s);else{if(xa(s)||ba(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(s)}}return o||e.push({role:"user",parts:ou(n)}),e}function Ep(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(o=>o!=="null");if(n.length===1)e.type=Object.values(dt).includes(n[0].toUpperCase())?n[0].toUpperCase():dt.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const o of n)e.anyOf.push({type:Object.values(dt).includes(o.toUpperCase())?o.toUpperCase():dt.TYPE_UNSPECIFIED})}}function Bt(t){const e={},n=["items"],o=["anyOf"],s=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=t.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,t=r[1]):r[1].type==="null"&&(e.nullable=!0,t=r[0])),t.type instanceof Array&&Ep(t.type,e);for(const[a,u]of Object.entries(t))if(u!=null)if(a=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(dt).includes(u.toUpperCase())?u.toUpperCase():dt.TYPE_UNSPECIFIED}else if(n.includes(a))e[a]=Bt(u);else if(o.includes(a)){const c=[];for(const d of u){if(d.type=="null"){e.nullable=!0;continue}c.push(Bt(d))}e[a]=c}else if(s.includes(a)){const c={};for(const[d,f]of Object.entries(u))c[d]=Bt(f);e[a]=c}else{if(a==="additionalProperties")continue;e[a]=u}return e}function gr(t){return Bt(t)}function yr(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function vr(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function nn(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Bt(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Bt(e.response));return t}function on(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function Ip(t,e,n,o=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===o;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function Qe(t,e){if(typeof e!="string")throw new Error("name must be a string");return Ip(t,e,"cachedContents")}function su(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function mt(t){return fr(t)}function kp(t){return t!=null&&typeof t=="object"&&"name"in t}function Np(t){return t!=null&&typeof t=="object"&&"video"in t}function Ap(t){return t!=null&&typeof t=="object"&&"uri"in t}function ru(t){var e;let n;if(kp(t)&&(n=t.name),!(Ap(t)&&(n=t.uri,n===void 0))&&!(Np(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const s=n.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${n}`);n=s[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function iu(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function au(t){for(const e of["models","tunedModels","publisherModels"])if(Pp(t,e))return t[e];return[]}function Pp(t,e){return t!==null&&typeof t=="object"&&e in t}function Rp(t,e={}){const n=t,o={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(o.responseJsonSchema=n.outputSchema),e.behavior&&(o.behavior=e.behavior),{functionDeclarations:[o]}}function Mp(t,e={}){const n=[],o=new Set;for(const s of t){const r=s.name;if(o.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);o.add(r);const a=Rp(s,e);a.functionDeclarations&&n.push(...a.functionDeclarations)}return{functionDeclarations:n}}function lu(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const o=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,s=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(s>0||o!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(o>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function Dp(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function uu(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const s=n.inlinedResponses;if(!Array.isArray(s)||s.length===0)return t;let r=!1;for(const a of s){if(typeof a!="object"||a===null)continue;const c=a.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){r=!0;break}}return r&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function sn(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function cu(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Up(t){const e={},n=i(t,["responsesFile"]);n!=null&&l(e,["fileName"],n);const o=i(t,["inlinedResponses","inlinedResponses"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(a=>mm(a))),l(e,["inlinedResponses"],r)}const s=i(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["inlinedEmbedContentResponses"],r)}return e}function Fp(t){const e={},n=i(t,["predictionsFormat"]);n!=null&&l(e,["format"],n);const o=i(t,["gcsDestination","outputUriPrefix"]);o!=null&&l(e,["gcsUri"],o);const s=i(t,["bigqueryDestination","outputUri"]);return s!=null&&l(e,["bigqueryUri"],s),e}function Lp(t){const e={},n=i(t,["format"]);n!=null&&l(e,["predictionsFormat"],n);const o=i(t,["gcsUri"]);o!=null&&l(e,["gcsDestination","outputUriPrefix"],o);const s=i(t,["bigqueryUri"]);if(s!=null&&l(e,["bigqueryDestination","outputUri"],s),i(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(i(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(i(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function so(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata","displayName"]);o!=null&&l(e,["displayName"],o);const s=i(t,["metadata","state"]);s!=null&&l(e,["state"],cu(s));const r=i(t,["metadata","createTime"]);r!=null&&l(e,["createTime"],r);const a=i(t,["metadata","endTime"]);a!=null&&l(e,["endTime"],a);const u=i(t,["metadata","updateTime"]);u!=null&&l(e,["updateTime"],u);const c=i(t,["metadata","model"]);c!=null&&l(e,["model"],c);const d=i(t,["metadata","output"]);return d!=null&&l(e,["dest"],Up(uu(d))),e}function qs(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["displayName"]);o!=null&&l(e,["displayName"],o);const s=i(t,["state"]);s!=null&&l(e,["state"],cu(s));const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["createTime"]);a!=null&&l(e,["createTime"],a);const u=i(t,["startTime"]);u!=null&&l(e,["startTime"],u);const c=i(t,["endTime"]);c!=null&&l(e,["endTime"],c);const d=i(t,["updateTime"]);d!=null&&l(e,["updateTime"],d);const f=i(t,["model"]);f!=null&&l(e,["model"],f);const m=i(t,["inputConfig"]);m!=null&&l(e,["src"],Gp(m));const p=i(t,["outputConfig"]);p!=null&&l(e,["dest"],Fp(uu(p)));const g=i(t,["completionStats"]);return g!=null&&l(e,["completionStats"],g),e}function Gp(t){const e={},n=i(t,["instancesFormat"]);n!=null&&l(e,["format"],n);const o=i(t,["gcsSource","uris"]);o!=null&&l(e,["gcsUri"],o);const s=i(t,["bigquerySource","inputUri"]);return s!=null&&l(e,["bigqueryUri"],s),e}function qp(t,e){const n={};if(i(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(i(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(i(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const o=i(e,["fileName"]);o!=null&&l(n,["fileName"],o);const s=i(e,["inlinedRequests"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>pm(t,a))),l(n,["requests","requests"],r)}return n}function Vp(t){const e={},n=i(t,["format"]);n!=null&&l(e,["instancesFormat"],n);const o=i(t,["gcsUri"]);o!=null&&l(e,["gcsSource","uris"],o);const s=i(t,["bigqueryUri"]);if(s!=null&&l(e,["bigquerySource","inputUri"],s),i(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(i(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Hp(t){const e={},n=i(t,["data"]);if(n!=null&&l(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function Bp(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],sn(t,o)),n}function $p(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],sn(t,o)),n}function Op(t){const e={},n=i(t,["content"]);n!=null&&l(e,["content"],n);const o=i(t,["citationMetadata"]);o!=null&&l(e,["citationMetadata"],Kp(o));const s=i(t,["tokenCount"]);s!=null&&l(e,["tokenCount"],s);const r=i(t,["finishReason"]);r!=null&&l(e,["finishReason"],r);const a=i(t,["avgLogprobs"]);a!=null&&l(e,["avgLogprobs"],a);const u=i(t,["groundingMetadata"]);u!=null&&l(e,["groundingMetadata"],u);const c=i(t,["index"]);c!=null&&l(e,["index"],c);const d=i(t,["logprobsResult"]);d!=null&&l(e,["logprobsResult"],d);const f=i(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),l(e,["safetyRatings"],p)}const m=i(t,["urlContextMetadata"]);return m!=null&&l(e,["urlContextMetadata"],m),e}function Kp(t){const e={},n=i(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>s)),l(e,["citations"],o)}return e}function du(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>wm(r))),l(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&l(e,["role"],o),e}function Jp(t,e){const n={},o=i(t,["displayName"]);if(e!==void 0&&o!=null&&l(e,["batch","displayName"],o),i(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function zp(t,e){const n={},o=i(t,["displayName"]);e!==void 0&&o!=null&&l(e,["displayName"],o);const s=i(t,["dest"]);return e!==void 0&&s!=null&&l(e,["outputConfig"],Lp(Dp(s))),n}function _a(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["src"]);s!=null&&l(n,["batch","inputConfig"],qp(t,lu(t,s)));const r=i(e,["config"]);return r!=null&&Jp(r,n),n}function jp(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["model"],Q(t,o));const s=i(e,["src"]);s!=null&&l(n,["inputConfig"],Vp(lu(t,s)));const r=i(e,["config"]);return r!=null&&zp(r,n),n}function Wp(t,e){const n={},o=i(t,["displayName"]);return e!==void 0&&o!=null&&l(e,["batch","displayName"],o),n}function Yp(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["src"]);s!=null&&l(n,["batch","inputConfig"],om(t,s));const r=i(e,["config"]);return r!=null&&Wp(r,n),n}function Qp(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],sn(t,o)),n}function Xp(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],sn(t,o)),n}function Zp(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["name"]);o!=null&&l(e,["name"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);return r!=null&&l(e,["error"],r),e}function em(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["name"]);o!=null&&l(e,["name"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);return r!=null&&l(e,["error"],r),e}function tm(t,e){const n={},o=i(e,["contents"]);if(o!=null){let r=mr(t,o);Array.isArray(r)&&(r=r.map(a=>a)),l(n,["requests[]","request","content"],r)}const s=i(e,["config"]);return s!=null&&(l(n,["_self"],nm(s,n)),Xh(n,{"requests[].*":"requests[].request.*"})),n}function nm(t,e){const n={},o=i(t,["taskType"]);e!==void 0&&o!=null&&l(e,["requests[]","taskType"],o);const s=i(t,["title"]);e!==void 0&&s!=null&&l(e,["requests[]","title"],s);const r=i(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&l(e,["requests[]","outputDimensionality"],r),i(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function om(t,e){const n={},o=i(e,["fileName"]);o!=null&&l(n,["file_name"],o);const s=i(e,["inlinedRequests"]);return s!=null&&l(n,["requests"],tm(t,s)),n}function sm(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function rm(t){const e={},n=i(t,["id"]);n!=null&&l(e,["id"],n);const o=i(t,["args"]);o!=null&&l(e,["args"],o);const s=i(t,["name"]);if(s!=null&&l(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function im(t){const e={},n=i(t,["mode"]);n!=null&&l(e,["mode"],n);const o=i(t,["allowedFunctionNames"]);if(o!=null&&l(e,["allowedFunctionNames"],o),i(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function am(t,e,n){const o={},s=i(e,["systemInstruction"]);n!==void 0&&s!=null&&l(n,["systemInstruction"],du(de(s)));const r=i(e,["temperature"]);r!=null&&l(o,["temperature"],r);const a=i(e,["topP"]);a!=null&&l(o,["topP"],a);const u=i(e,["topK"]);u!=null&&l(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&l(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&l(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&l(o,["stopSequences"],f);const m=i(e,["responseLogprobs"]);m!=null&&l(o,["responseLogprobs"],m);const p=i(e,["logprobs"]);p!=null&&l(o,["logprobs"],p);const g=i(e,["presencePenalty"]);g!=null&&l(o,["presencePenalty"],g);const v=i(e,["frequencyPenalty"]);v!=null&&l(o,["frequencyPenalty"],v);const y=i(e,["seed"]);y!=null&&l(o,["seed"],y);const x=i(e,["responseMimeType"]);x!=null&&l(o,["responseMimeType"],x);const b=i(e,["responseSchema"]);b!=null&&l(o,["responseSchema"],gr(b));const _=i(e,["responseJsonSchema"]);if(_!=null&&l(o,["responseJsonSchema"],_),i(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=i(e,["safetySettings"]);if(n!==void 0&&w!=null){let V=w;Array.isArray(V)&&(V=V.map(j=>Cm(j))),l(n,["safetySettings"],V)}const C=i(e,["tools"]);if(n!==void 0&&C!=null){let V=on(C);Array.isArray(V)&&(V=V.map(j=>Sm(nn(j)))),l(n,["tools"],V)}const I=i(e,["toolConfig"]);if(n!==void 0&&I!=null&&l(n,["toolConfig"],Tm(I)),i(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=i(e,["cachedContent"]);n!==void 0&&k!=null&&l(n,["cachedContent"],Qe(t,k));const T=i(e,["responseModalities"]);T!=null&&l(o,["responseModalities"],T);const U=i(e,["mediaResolution"]);U!=null&&l(o,["mediaResolution"],U);const E=i(e,["speechConfig"]);if(E!=null&&l(o,["speechConfig"],yr(E)),i(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=i(e,["thinkingConfig"]);R!=null&&l(o,["thinkingConfig"],R);const A=i(e,["imageConfig"]);A!=null&&l(o,["imageConfig"],hm(A));const z=i(e,["enableEnhancedCivicAnswers"]);return z!=null&&l(o,["enableEnhancedCivicAnswers"],z),o}function lm(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>Op(d))),l(e,["candidates"],c)}const s=i(t,["modelVersion"]);s!=null&&l(e,["modelVersion"],s);const r=i(t,["promptFeedback"]);r!=null&&l(e,["promptFeedback"],r);const a=i(t,["responseId"]);a!=null&&l(e,["responseId"],a);const u=i(t,["usageMetadata"]);return u!=null&&l(e,["usageMetadata"],u),e}function um(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],sn(t,o)),n}function cm(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],sn(t,o)),n}function dm(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function fm(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function hm(t){const e={},n=i(t,["aspectRatio"]);n!=null&&l(e,["aspectRatio"],n);const o=i(t,["imageSize"]);if(o!=null&&l(e,["imageSize"],o),i(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(i(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function pm(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["request","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let u=Ce(s);Array.isArray(u)&&(u=u.map(c=>du(c))),l(n,["request","contents"],u)}const r=i(e,["metadata"]);r!=null&&l(n,["metadata"],r);const a=i(e,["config"]);return a!=null&&l(n,["request","generationConfig"],am(t,a,i(n,["request"],{}))),n}function mm(t){const e={},n=i(t,["response"]);n!=null&&l(e,["response"],lm(n));const o=i(t,["error"]);return o!=null&&l(e,["error"],o),e}function gm(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);if(e!==void 0&&s!=null&&l(e,["_query","pageToken"],s),i(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function ym(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);e!==void 0&&s!=null&&l(e,["_query","pageToken"],s);const r=i(t,["filter"]);return e!==void 0&&r!=null&&l(e,["_query","filter"],r),n}function vm(t){const e={},n=i(t,["config"]);return n!=null&&gm(n,e),e}function xm(t){const e={},n=i(t,["config"]);return n!=null&&ym(n,e),e}function bm(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["operations"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>so(a))),l(e,["batchJobs"],r)}return e}function _m(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["batchPredictionJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>qs(a))),l(e,["batchJobs"],r)}return e}function wm(t){const e={},n=i(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&l(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&l(e,["executableCode"],s);const r=i(t,["fileData"]);r!=null&&l(e,["fileData"],sm(r));const a=i(t,["functionCall"]);a!=null&&l(e,["functionCall"],rm(a));const u=i(t,["functionResponse"]);u!=null&&l(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&l(e,["inlineData"],Hp(c));const d=i(t,["text"]);d!=null&&l(e,["text"],d);const f=i(t,["thought"]);f!=null&&l(e,["thought"],f);const m=i(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const p=i(t,["videoMetadata"]);return p!=null&&l(e,["videoMetadata"],p),e}function Cm(t){const e={},n=i(t,["category"]);if(n!=null&&l(e,["category"],n),i(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=i(t,["threshold"]);return o!=null&&l(e,["threshold"],o),e}function Tm(t){const e={},n=i(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],im(n));const o=i(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],o),e}function Sm(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(t,["googleSearchRetrieval"]);o!=null&&l(e,["googleSearchRetrieval"],o);const s=i(t,["computerUse"]);s!=null&&l(e,["computerUse"],s);const r=i(t,["fileSearch"]);r!=null&&l(e,["fileSearch"],r);const a=i(t,["codeExecution"]);if(a!=null&&l(e,["codeExecution"],a),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=i(t,["googleMaps"]);u!=null&&l(e,["googleMaps"],dm(u));const c=i(t,["googleSearch"]);c!=null&&l(e,["googleSearch"],fm(c));const d=i(t,["urlContext"]);return d!=null&&l(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var We;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents",t.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",t.PAGED_ITEM_DOCUMENTS="documents"})(We||(We={}));class Pt{constructor(e,n,o,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,o,s)}init(e,n,o){var s,r;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!o||Object.keys(o).length===0?a={config:{}}:typeof o=="object"?a=Object.assign({},o):a=o,a.config&&(a.config.pageToken=n.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(r=(s=a.config)===null||s===void 0?void 0:s.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Em extends Ye{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Pt(We.PAGED_ITEM_BATCH_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)}}createInlinedGenerateContentRequest(e){const n=_a(this.apiClient,e),o=n._url,s=F("{model}:batchGenerateContent",o),u=n.batch.inputConfig.requests,c=u.requests,d=[];for(const f of c){const m=Object.assign({},f);if(m.systemInstruction){const p=m.systemInstruction;delete m.systemInstruction;const g=m.request;g.systemInstruction=p,m.request=g}d.push(m)}return u.requests=d,delete n.config,delete n._url,delete n._query,{path:s,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const o=n?Object.assign({},n):{},s=Date.now().toString();if(o.displayName||(o.displayName=`genaiBatchJob_${s}`),o.dest===void 0){const r=this.getGcsUri(e),a=this.getBigqueryUri(e);if(r)r.endsWith(".jsonl")?o.dest=`${r.slice(0,-6)}/dest`:o.dest=`${r}_dest_${s}`;else if(a)o.dest=`${a}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return o}async createInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=jp(this.apiClient,e);return u=F("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>qs(f))}else{const d=_a(this.apiClient,e);return u=F("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>so(f))}}async createEmbeddingsInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Yp(this.apiClient,e);return r=F("{model}:asyncBatchEmbedContent",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>so(c))}}async get(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=cm(this.apiClient,e);return u=F("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>qs(f))}else{const d=um(this.apiClient,e);return u=F("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>so(f))}}async cancel(e){var n,o,s,r;let a="",u={};if(this.apiClient.isVertexAI()){const c=$p(this.apiClient,e);a=F("batchPredictionJobs/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}else{const c=Bp(this.apiClient,e);a=F("batches/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:a,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=xm(e);return u=F("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=_m(f),p=new ya;return Object.assign(p,m),p})}else{const d=vm(e);return u=F("batches",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=bm(f),p=new ya;return Object.assign(p,m),p})}}async delete(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Xp(this.apiClient,e);return u=F("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>em(f))}else{const d=Qp(this.apiClient,e);return u=F("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>Zp(f))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Im(t){const e={},n=i(t,["data"]);if(n!=null&&l(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function wa(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>Ym(r))),l(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&l(e,["role"],o),e}function km(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const s=i(t,["expireTime"]);e!==void 0&&s!=null&&l(e,["expireTime"],s);const r=i(t,["displayName"]);e!==void 0&&r!=null&&l(e,["displayName"],r);const a=i(t,["contents"]);if(e!==void 0&&a!=null){let f=Ce(a);Array.isArray(f)&&(f=f.map(m=>wa(m))),l(e,["contents"],f)}const u=i(t,["systemInstruction"]);e!==void 0&&u!=null&&l(e,["systemInstruction"],wa(de(u)));const c=i(t,["tools"]);if(e!==void 0&&c!=null){let f=c;Array.isArray(f)&&(f=f.map(m=>Xm(m))),l(e,["tools"],f)}const d=i(t,["toolConfig"]);if(e!==void 0&&d!=null&&l(e,["toolConfig"],Qm(d)),i(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Nm(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const s=i(t,["expireTime"]);e!==void 0&&s!=null&&l(e,["expireTime"],s);const r=i(t,["displayName"]);e!==void 0&&r!=null&&l(e,["displayName"],r);const a=i(t,["contents"]);if(e!==void 0&&a!=null){let m=Ce(a);Array.isArray(m)&&(m=m.map(p=>p)),l(e,["contents"],m)}const u=i(t,["systemInstruction"]);e!==void 0&&u!=null&&l(e,["systemInstruction"],de(u));const c=i(t,["tools"]);if(e!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(p=>Zm(p))),l(e,["tools"],m)}const d=i(t,["toolConfig"]);e!==void 0&&d!=null&&l(e,["toolConfig"],d);const f=i(t,["kmsKeyName"]);return e!==void 0&&f!=null&&l(e,["encryption_spec","kmsKeyName"],f),n}function Am(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["model"],Zl(t,o));const s=i(e,["config"]);return s!=null&&km(s,n),n}function Pm(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["model"],Zl(t,o));const s=i(e,["config"]);return s!=null&&Nm(s,n),n}function Rm(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],Qe(t,o)),n}function Mm(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],Qe(t,o)),n}function Dm(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function Um(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function Fm(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function Lm(t){const e={},n=i(t,["id"]);n!=null&&l(e,["id"],n);const o=i(t,["args"]);o!=null&&l(e,["args"],o);const s=i(t,["name"]);if(s!=null&&l(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Gm(t){const e={},n=i(t,["mode"]);n!=null&&l(e,["mode"],n);const o=i(t,["allowedFunctionNames"]);if(o!=null&&l(e,["allowedFunctionNames"],o),i(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function qm(t){const e={};if(i(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=i(t,["description"]);n!=null&&l(e,["description"],n);const o=i(t,["name"]);o!=null&&l(e,["name"],o);const s=i(t,["parameters"]);s!=null&&l(e,["parameters"],s);const r=i(t,["parametersJsonSchema"]);r!=null&&l(e,["parametersJsonSchema"],r);const a=i(t,["response"]);a!=null&&l(e,["response"],a);const u=i(t,["responseJsonSchema"]);return u!=null&&l(e,["responseJsonSchema"],u),e}function Vm(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],Qe(t,o)),n}function Hm(t,e){const n={},o=i(e,["name"]);return o!=null&&l(n,["_url","name"],Qe(t,o)),n}function Bm(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function $m(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function Om(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&l(e,["_query","pageToken"],s),n}function Km(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&l(e,["_query","pageToken"],s),n}function Jm(t){const e={},n=i(t,["config"]);return n!=null&&Om(n,e),e}function zm(t){const e={},n=i(t,["config"]);return n!=null&&Km(n,e),e}function jm(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["cachedContents"],r)}return e}function Wm(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["cachedContents"],r)}return e}function Ym(t){const e={},n=i(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&l(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&l(e,["executableCode"],s);const r=i(t,["fileData"]);r!=null&&l(e,["fileData"],Fm(r));const a=i(t,["functionCall"]);a!=null&&l(e,["functionCall"],Lm(a));const u=i(t,["functionResponse"]);u!=null&&l(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&l(e,["inlineData"],Im(c));const d=i(t,["text"]);d!=null&&l(e,["text"],d);const f=i(t,["thought"]);f!=null&&l(e,["thought"],f);const m=i(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const p=i(t,["videoMetadata"]);return p!=null&&l(e,["videoMetadata"],p),e}function Qm(t){const e={},n=i(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],Gm(n));const o=i(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],o),e}function Xm(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(t,["googleSearchRetrieval"]);o!=null&&l(e,["googleSearchRetrieval"],o);const s=i(t,["computerUse"]);s!=null&&l(e,["computerUse"],s);const r=i(t,["fileSearch"]);r!=null&&l(e,["fileSearch"],r);const a=i(t,["codeExecution"]);if(a!=null&&l(e,["codeExecution"],a),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=i(t,["googleMaps"]);u!=null&&l(e,["googleMaps"],Bm(u));const c=i(t,["googleSearch"]);c!=null&&l(e,["googleSearch"],$m(c));const d=i(t,["urlContext"]);return d!=null&&l(e,["urlContext"],d),e}function Zm(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>qm(p))),l(e,["functionDeclarations"],m)}const o=i(t,["retrieval"]);o!=null&&l(e,["retrieval"],o);const s=i(t,["googleSearchRetrieval"]);s!=null&&l(e,["googleSearchRetrieval"],s);const r=i(t,["computerUse"]);if(r!=null&&l(e,["computerUse"],r),i(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=i(t,["codeExecution"]);a!=null&&l(e,["codeExecution"],a);const u=i(t,["enterpriseWebSearch"]);u!=null&&l(e,["enterpriseWebSearch"],u);const c=i(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],c);const d=i(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],d);const f=i(t,["urlContext"]);return f!=null&&l(e,["urlContext"],f),e}function eg(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const s=i(t,["expireTime"]);return e!==void 0&&s!=null&&l(e,["expireTime"],s),n}function tg(t,e){const n={},o=i(t,["ttl"]);e!==void 0&&o!=null&&l(e,["ttl"],o);const s=i(t,["expireTime"]);return e!==void 0&&s!=null&&l(e,["expireTime"],s),n}function ng(t,e){const n={},o=i(e,["name"]);o!=null&&l(n,["_url","name"],Qe(t,o));const s=i(e,["config"]);return s!=null&&eg(s,n),n}function og(t,e){const n={},o=i(e,["name"]);o!=null&&l(n,["_url","name"],Qe(t,o));const s=i(e,["config"]);return s!=null&&tg(s,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class sg extends Ye{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Pt(We.PAGED_ITEM_CACHED_CONTENTS,o=>this.listInternal(o),await this.listInternal(n),n)}async create(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Pm(this.apiClient,e);return u=F("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=Am(this.apiClient,e);return u=F("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async get(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Hm(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=Vm(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async delete(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Mm(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Um(f),p=new ma;return Object.assign(p,m),p})}else{const d=Rm(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Dm(f),p=new ma;return Object.assign(p,m),p})}}async update(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=og(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>f)}else{const d=ng(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>f)}}async listInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=zm(e);return u=F("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Wm(f),p=new ga;return Object.assign(p,m),p})}else{const d=Jm(e);return u=F("cachedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=jm(f),p=new ga;return Object.assign(p,m),p})}}}function Eo(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,o=Object.getOwnPropertySymbols(t);s<o.length;s++)e.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(t,o[s])&&(n[o[s]]=t[o[s]]);return n}function Ca(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function J(t){return this instanceof J?(this.v=t,this):new J(t)}function Ae(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=n.apply(t,e||[]),s,r=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",a),s[Symbol.asyncIterator]=function(){return this},s;function a(g){return function(v){return Promise.resolve(v).then(g,m)}}function u(g,v){o[g]&&(s[g]=function(y){return new Promise(function(x,b){r.push([g,y,x,b])>1||c(g,y)})},v&&(s[g]=v(s[g])))}function c(g,v){try{d(o[g](v))}catch(y){p(r[0][3],y)}}function d(g){g.value instanceof J?Promise.resolve(g.value.v).then(f,m):p(r[0][2],g)}function f(g){c("next",g)}function m(g){c("throw",g)}function p(g,v){g(v),r.shift(),r.length&&c(r[0][0],r[0][1])}}function Pe(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Ca=="function"?Ca(t):t[Symbol.iterator](),n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n);function o(r){n[r]=t[r]&&function(a){return new Promise(function(u,c){a=t[r](a),s(u,c,a.done,a.value)})}}function s(r,a,u,c){Promise.resolve(c).then(function(d){r({value:d,done:u})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rg(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:fu(n)}function fu(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function ig(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function Ta(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let o=0;for(;o<n;)if(t[o].role==="user")e.push(t[o]),o++;else{const s=[];let r=!0;for(;o<n&&t[o].role==="model";)s.push(t[o]),r&&!fu(t[o])&&(r=!1),o++;r?e.push(...s):e.pop()}return e}class ag{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new lg(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class lg{constructor(e,n,o,s={},r=[]){this.apiClient=e,this.modelsModule=n,this.model=o,this.config=s,this.history=r,this.sendPromise=Promise.resolve(),ig(r)}async sendMessage(e){var n;await this.sendPromise;const o=de(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var r,a,u;const c=await s,d=(a=(r=c.candidates)===null||r===void 0?void 0:r[0])===null||a===void 0?void 0:a.content,f=c.automaticFunctionCallingHistory,m=this.getHistory(!0).length;let p=[];f!=null&&(p=(u=f.slice(m))!==null&&u!==void 0?u:[]);const g=d?[d]:[];this.recordHistory(o,g,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var n;await this.sendPromise;const o=de(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(o),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const r=await s;return this.processStreamResponse(r,o)}getHistory(e=!1){const n=e?Ta(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){return Ae(this,arguments,function*(){var s,r,a,u,c,d;const f=[];try{for(var m=!0,p=Pe(e),g;g=yield J(p.next()),s=g.done,!s;m=!0){u=g.value,m=!1;const v=u;if(rg(v)){const y=(d=(c=v.candidates)===null||c===void 0?void 0:c[0])===null||d===void 0?void 0:d.content;y!==void 0&&f.push(y)}yield yield J(v)}}catch(v){r={error:v}}finally{try{!m&&!s&&(a=p.return)&&(yield J(a.call(p)))}finally{if(r)throw r.error}}this.recordHistory(n,f)})}recordHistory(e,n,o){let s=[];n.length>0&&n.every(r=>r.role!==void 0)?s=n:s.push({role:"model",parts:[]}),o&&o.length>0?this.history.push(...Ta(o)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fo extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Fo.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ug(t){const e={},n=i(t,["file"]);return n!=null&&l(e,["file"],n),e}function cg(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function dg(t){const e={},n=i(t,["name"]);return n!=null&&l(e,["_url","file"],ru(n)),e}function fg(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function hg(t){const e={},n=i(t,["name"]);return n!=null&&l(e,["_url","file"],ru(n)),e}function pg(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&l(e,["_query","pageToken"],s),n}function mg(t){const e={},n=i(t,["config"]);return n!=null&&pg(n,e),e}function gg(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["files"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yg extends Ye{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Pt(We.PAGED_ITEM_FILES,o=>this.listInternal(o),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>n)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=mg(e);return r=F("files",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=gg(c),f=new _p;return Object.assign(f,d),f})}}async createInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ug(e);return r=F("upload/v1beta/files",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=cg(c),f=new wp;return Object.assign(f,d),f})}}async get(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=hg(e);return r=F("files/{file}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=dg(e);return r=F("files/{file}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=fg(c),f=new Cp;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ro(t){const e={},n=i(t,["data"]);if(n!=null&&l(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function vg(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>Dg(r))),l(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&l(e,["role"],o),e}function xg(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function bg(t){const e={},n=i(t,["id"]);n!=null&&l(e,["id"],n);const o=i(t,["args"]);o!=null&&l(e,["args"],o);const s=i(t,["name"]);if(s!=null&&l(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function _g(t){const e={};if(i(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=i(t,["description"]);n!=null&&l(e,["description"],n);const o=i(t,["name"]);o!=null&&l(e,["name"],o);const s=i(t,["parameters"]);s!=null&&l(e,["parameters"],s);const r=i(t,["parametersJsonSchema"]);r!=null&&l(e,["parametersJsonSchema"],r);const a=i(t,["response"]);a!=null&&l(e,["response"],a);const u=i(t,["responseJsonSchema"]);return u!=null&&l(e,["responseJsonSchema"],u),e}function wg(t){const e={},n=i(t,["modelSelectionConfig"]);n!=null&&l(e,["modelConfig"],n);const o=i(t,["responseJsonSchema"]);o!=null&&l(e,["responseJsonSchema"],o);const s=i(t,["audioTimestamp"]);s!=null&&l(e,["audioTimestamp"],s);const r=i(t,["candidateCount"]);r!=null&&l(e,["candidateCount"],r);const a=i(t,["enableAffectiveDialog"]);a!=null&&l(e,["enableAffectiveDialog"],a);const u=i(t,["frequencyPenalty"]);u!=null&&l(e,["frequencyPenalty"],u);const c=i(t,["logprobs"]);c!=null&&l(e,["logprobs"],c);const d=i(t,["maxOutputTokens"]);d!=null&&l(e,["maxOutputTokens"],d);const f=i(t,["mediaResolution"]);f!=null&&l(e,["mediaResolution"],f);const m=i(t,["presencePenalty"]);m!=null&&l(e,["presencePenalty"],m);const p=i(t,["responseLogprobs"]);p!=null&&l(e,["responseLogprobs"],p);const g=i(t,["responseMimeType"]);g!=null&&l(e,["responseMimeType"],g);const v=i(t,["responseModalities"]);v!=null&&l(e,["responseModalities"],v);const y=i(t,["responseSchema"]);y!=null&&l(e,["responseSchema"],y);const x=i(t,["routingConfig"]);x!=null&&l(e,["routingConfig"],x);const b=i(t,["seed"]);b!=null&&l(e,["seed"],b);const _=i(t,["speechConfig"]);_!=null&&l(e,["speechConfig"],_);const w=i(t,["stopSequences"]);w!=null&&l(e,["stopSequences"],w);const C=i(t,["temperature"]);C!=null&&l(e,["temperature"],C);const I=i(t,["thinkingConfig"]);I!=null&&l(e,["thinkingConfig"],I);const k=i(t,["topK"]);k!=null&&l(e,["topK"],k);const T=i(t,["topP"]);if(T!=null&&l(e,["topP"],T),i(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function Cg(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function Tg(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function Sg(t,e){const n={},o=i(t,["generationConfig"]);e!==void 0&&o!=null&&l(e,["setup","generationConfig"],o);const s=i(t,["responseModalities"]);e!==void 0&&s!=null&&l(e,["setup","generationConfig","responseModalities"],s);const r=i(t,["temperature"]);e!==void 0&&r!=null&&l(e,["setup","generationConfig","temperature"],r);const a=i(t,["topP"]);e!==void 0&&a!=null&&l(e,["setup","generationConfig","topP"],a);const u=i(t,["topK"]);e!==void 0&&u!=null&&l(e,["setup","generationConfig","topK"],u);const c=i(t,["maxOutputTokens"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(t,["mediaResolution"]);e!==void 0&&d!=null&&l(e,["setup","generationConfig","mediaResolution"],d);const f=i(t,["seed"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","seed"],f);const m=i(t,["speechConfig"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","speechConfig"],vr(m));const p=i(t,["thinkingConfig"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","thinkingConfig"],p);const g=i(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],g);const v=i(t,["systemInstruction"]);e!==void 0&&v!=null&&l(e,["setup","systemInstruction"],vg(de(v)));const y=i(t,["tools"]);if(e!==void 0&&y!=null){let k=on(y);Array.isArray(k)&&(k=k.map(T=>Fg(nn(T)))),l(e,["setup","tools"],k)}const x=i(t,["sessionResumption"]);e!==void 0&&x!=null&&l(e,["setup","sessionResumption"],Ug(x));const b=i(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&l(e,["setup","inputAudioTranscription"],b);const _=i(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&l(e,["setup","outputAudioTranscription"],_);const w=i(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&l(e,["setup","realtimeInputConfig"],w);const C=i(t,["contextWindowCompression"]);e!==void 0&&C!=null&&l(e,["setup","contextWindowCompression"],C);const I=i(t,["proactivity"]);if(e!==void 0&&I!=null&&l(e,["setup","proactivity"],I),i(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function Eg(t,e){const n={},o=i(t,["generationConfig"]);e!==void 0&&o!=null&&l(e,["setup","generationConfig"],wg(o));const s=i(t,["responseModalities"]);e!==void 0&&s!=null&&l(e,["setup","generationConfig","responseModalities"],s);const r=i(t,["temperature"]);e!==void 0&&r!=null&&l(e,["setup","generationConfig","temperature"],r);const a=i(t,["topP"]);e!==void 0&&a!=null&&l(e,["setup","generationConfig","topP"],a);const u=i(t,["topK"]);e!==void 0&&u!=null&&l(e,["setup","generationConfig","topK"],u);const c=i(t,["maxOutputTokens"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(t,["mediaResolution"]);e!==void 0&&d!=null&&l(e,["setup","generationConfig","mediaResolution"],d);const f=i(t,["seed"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","seed"],f);const m=i(t,["speechConfig"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","speechConfig"],vr(m));const p=i(t,["thinkingConfig"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","thinkingConfig"],p);const g=i(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],g);const v=i(t,["systemInstruction"]);e!==void 0&&v!=null&&l(e,["setup","systemInstruction"],de(v));const y=i(t,["tools"]);if(e!==void 0&&y!=null){let T=on(y);Array.isArray(T)&&(T=T.map(U=>Lg(nn(U)))),l(e,["setup","tools"],T)}const x=i(t,["sessionResumption"]);e!==void 0&&x!=null&&l(e,["setup","sessionResumption"],x);const b=i(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&l(e,["setup","inputAudioTranscription"],b);const _=i(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&l(e,["setup","outputAudioTranscription"],_);const w=i(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&l(e,["setup","realtimeInputConfig"],w);const C=i(t,["contextWindowCompression"]);e!==void 0&&C!=null&&l(e,["setup","contextWindowCompression"],C);const I=i(t,["proactivity"]);e!==void 0&&I!=null&&l(e,["setup","proactivity"],I);const k=i(t,["explicitVadSignal"]);return e!==void 0&&k!=null&&l(e,["setup","explicitVadSignal"],k),n}function Ig(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["setup","model"],Q(t,o));const s=i(e,["config"]);return s!=null&&l(n,["config"],Sg(s,n)),n}function kg(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["setup","model"],Q(t,o));const s=i(e,["config"]);return s!=null&&l(n,["config"],Eg(s,n)),n}function Ng(t){const e={},n=i(t,["musicGenerationConfig"]);return n!=null&&l(e,["musicGenerationConfig"],n),e}function Ag(t){const e={},n=i(t,["weightedPrompts"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>s)),l(e,["weightedPrompts"],o)}return e}function Pg(t){const e={},n=i(t,["media"]);if(n!=null){let d=eu(n);Array.isArray(d)&&(d=d.map(f=>ro(f))),l(e,["mediaChunks"],d)}const o=i(t,["audio"]);o!=null&&l(e,["audio"],ro(nu(o)));const s=i(t,["audioStreamEnd"]);s!=null&&l(e,["audioStreamEnd"],s);const r=i(t,["video"]);r!=null&&l(e,["video"],ro(tu(r)));const a=i(t,["text"]);a!=null&&l(e,["text"],a);const u=i(t,["activityStart"]);u!=null&&l(e,["activityStart"],u);const c=i(t,["activityEnd"]);return c!=null&&l(e,["activityEnd"],c),e}function Rg(t){const e={},n=i(t,["media"]);if(n!=null){let d=eu(n);Array.isArray(d)&&(d=d.map(f=>f)),l(e,["mediaChunks"],d)}const o=i(t,["audio"]);o!=null&&l(e,["audio"],nu(o));const s=i(t,["audioStreamEnd"]);s!=null&&l(e,["audioStreamEnd"],s);const r=i(t,["video"]);r!=null&&l(e,["video"],tu(r));const a=i(t,["text"]);a!=null&&l(e,["text"],a);const u=i(t,["activityStart"]);u!=null&&l(e,["activityStart"],u);const c=i(t,["activityEnd"]);return c!=null&&l(e,["activityEnd"],c),e}function Mg(t){const e={},n=i(t,["setupComplete"]);n!=null&&l(e,["setupComplete"],n);const o=i(t,["serverContent"]);o!=null&&l(e,["serverContent"],o);const s=i(t,["toolCall"]);s!=null&&l(e,["toolCall"],s);const r=i(t,["toolCallCancellation"]);r!=null&&l(e,["toolCallCancellation"],r);const a=i(t,["usageMetadata"]);a!=null&&l(e,["usageMetadata"],Gg(a));const u=i(t,["goAway"]);u!=null&&l(e,["goAway"],u);const c=i(t,["sessionResumptionUpdate"]);c!=null&&l(e,["sessionResumptionUpdate"],c);const d=i(t,["voiceActivityDetectionSignal"]);return d!=null&&l(e,["voiceActivityDetectionSignal"],d),e}function Dg(t){const e={},n=i(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&l(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&l(e,["executableCode"],s);const r=i(t,["fileData"]);r!=null&&l(e,["fileData"],xg(r));const a=i(t,["functionCall"]);a!=null&&l(e,["functionCall"],bg(a));const u=i(t,["functionResponse"]);u!=null&&l(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&l(e,["inlineData"],ro(c));const d=i(t,["text"]);d!=null&&l(e,["text"],d);const f=i(t,["thought"]);f!=null&&l(e,["thought"],f);const m=i(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const p=i(t,["videoMetadata"]);return p!=null&&l(e,["videoMetadata"],p),e}function Ug(t){const e={},n=i(t,["handle"]);if(n!=null&&l(e,["handle"],n),i(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Fg(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(t,["googleSearchRetrieval"]);o!=null&&l(e,["googleSearchRetrieval"],o);const s=i(t,["computerUse"]);s!=null&&l(e,["computerUse"],s);const r=i(t,["fileSearch"]);r!=null&&l(e,["fileSearch"],r);const a=i(t,["codeExecution"]);if(a!=null&&l(e,["codeExecution"],a),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=i(t,["googleMaps"]);u!=null&&l(e,["googleMaps"],Cg(u));const c=i(t,["googleSearch"]);c!=null&&l(e,["googleSearch"],Tg(c));const d=i(t,["urlContext"]);return d!=null&&l(e,["urlContext"],d),e}function Lg(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>_g(p))),l(e,["functionDeclarations"],m)}const o=i(t,["retrieval"]);o!=null&&l(e,["retrieval"],o);const s=i(t,["googleSearchRetrieval"]);s!=null&&l(e,["googleSearchRetrieval"],s);const r=i(t,["computerUse"]);if(r!=null&&l(e,["computerUse"],r),i(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=i(t,["codeExecution"]);a!=null&&l(e,["codeExecution"],a);const u=i(t,["enterpriseWebSearch"]);u!=null&&l(e,["enterpriseWebSearch"],u);const c=i(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],c);const d=i(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],d);const f=i(t,["urlContext"]);return f!=null&&l(e,["urlContext"],f),e}function Gg(t){const e={},n=i(t,["promptTokenCount"]);n!=null&&l(e,["promptTokenCount"],n);const o=i(t,["cachedContentTokenCount"]);o!=null&&l(e,["cachedContentTokenCount"],o);const s=i(t,["candidatesTokenCount"]);s!=null&&l(e,["responseTokenCount"],s);const r=i(t,["toolUsePromptTokenCount"]);r!=null&&l(e,["toolUsePromptTokenCount"],r);const a=i(t,["thoughtsTokenCount"]);a!=null&&l(e,["thoughtsTokenCount"],a);const u=i(t,["totalTokenCount"]);u!=null&&l(e,["totalTokenCount"],u);const c=i(t,["promptTokensDetails"]);if(c!=null){let g=c;Array.isArray(g)&&(g=g.map(v=>v)),l(e,["promptTokensDetails"],g)}const d=i(t,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(v=>v)),l(e,["cacheTokensDetails"],g)}const f=i(t,["candidatesTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(v=>v)),l(e,["responseTokensDetails"],g)}const m=i(t,["toolUsePromptTokensDetails"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(v=>v)),l(e,["toolUsePromptTokensDetails"],g)}const p=i(t,["trafficType"]);return p!=null&&l(e,["trafficType"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qg(t){const e={},n=i(t,["data"]);if(n!=null&&l(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function Vg(t){const e={},n=i(t,["content"]);n!=null&&l(e,["content"],n);const o=i(t,["citationMetadata"]);o!=null&&l(e,["citationMetadata"],Hg(o));const s=i(t,["tokenCount"]);s!=null&&l(e,["tokenCount"],s);const r=i(t,["finishReason"]);r!=null&&l(e,["finishReason"],r);const a=i(t,["avgLogprobs"]);a!=null&&l(e,["avgLogprobs"],a);const u=i(t,["groundingMetadata"]);u!=null&&l(e,["groundingMetadata"],u);const c=i(t,["index"]);c!=null&&l(e,["index"],c);const d=i(t,["logprobsResult"]);d!=null&&l(e,["logprobsResult"],d);const f=i(t,["safetyRatings"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>g)),l(e,["safetyRatings"],p)}const m=i(t,["urlContextMetadata"]);return m!=null&&l(e,["urlContextMetadata"],m),e}function Hg(t){const e={},n=i(t,["citationSources"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>s)),l(e,["citations"],o)}return e}function Bg(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let r=Ce(s);Array.isArray(r)&&(r=r.map(a=>a)),l(n,["contents"],r)}return n}function $g(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["tokensInfo"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(r=>r)),l(e,["tokensInfo"],s)}return e}function Og(t){const e={},n=i(t,["values"]);n!=null&&l(e,["values"],n);const o=i(t,["statistics"]);return o!=null&&l(e,["statistics"],Kg(o)),e}function Kg(t){const e={},n=i(t,["truncated"]);n!=null&&l(e,["truncated"],n);const o=i(t,["token_count"]);return o!=null&&l(e,["tokenCount"],o),e}function Lo(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>ey(r))),l(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&l(e,["role"],o),e}function Jg(t){const e={},n=i(t,["controlType"]);n!=null&&l(e,["controlType"],n);const o=i(t,["enableControlImageComputation"]);return o!=null&&l(e,["computeControl"],o),e}function zg(t){const e={};if(i(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(i(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(i(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function jg(t,e){const n={},o=i(t,["systemInstruction"]);e!==void 0&&o!=null&&l(e,["systemInstruction"],de(o));const s=i(t,["tools"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(u=>gu(u))),l(e,["tools"],a)}const r=i(t,["generationConfig"]);return e!==void 0&&r!=null&&l(e,["generationConfig"],q0(r)),n}function Wg(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let a=Ce(s);Array.isArray(a)&&(a=a.map(u=>Lo(u))),l(n,["contents"],a)}const r=i(e,["config"]);return r!=null&&zg(r),n}function Yg(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let a=Ce(s);Array.isArray(a)&&(a=a.map(u=>u)),l(n,["contents"],a)}const r=i(e,["config"]);return r!=null&&jg(r,n),n}function Qg(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["totalTokens"]);o!=null&&l(e,["totalTokens"],o);const s=i(t,["cachedContentTokenCount"]);return s!=null&&l(e,["cachedContentTokenCount"],s),e}function Xg(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["totalTokens"]);return o!=null&&l(e,["totalTokens"],o),e}function Zg(t,e){const n={},o=i(e,["model"]);return o!=null&&l(n,["_url","name"],Q(t,o)),n}function e0(t,e){const n={},o=i(e,["model"]);return o!=null&&l(n,["_url","name"],Q(t,o)),n}function t0(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function n0(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}function o0(t,e){const n={},o=i(t,["outputGcsUri"]);e!==void 0&&o!=null&&l(e,["parameters","storageUri"],o);const s=i(t,["negativePrompt"]);e!==void 0&&s!=null&&l(e,["parameters","negativePrompt"],s);const r=i(t,["numberOfImages"]);e!==void 0&&r!=null&&l(e,["parameters","sampleCount"],r);const a=i(t,["aspectRatio"]);e!==void 0&&a!=null&&l(e,["parameters","aspectRatio"],a);const u=i(t,["guidanceScale"]);e!==void 0&&u!=null&&l(e,["parameters","guidanceScale"],u);const c=i(t,["seed"]);e!==void 0&&c!=null&&l(e,["parameters","seed"],c);const d=i(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&l(e,["parameters","safetySetting"],d);const f=i(t,["personGeneration"]);e!==void 0&&f!=null&&l(e,["parameters","personGeneration"],f);const m=i(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&l(e,["parameters","includeSafetyAttributes"],m);const p=i(t,["includeRaiReason"]);e!==void 0&&p!=null&&l(e,["parameters","includeRaiReason"],p);const g=i(t,["language"]);e!==void 0&&g!=null&&l(e,["parameters","language"],g);const v=i(t,["outputMimeType"]);e!==void 0&&v!=null&&l(e,["parameters","outputOptions","mimeType"],v);const y=i(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&l(e,["parameters","outputOptions","compressionQuality"],y);const x=i(t,["addWatermark"]);e!==void 0&&x!=null&&l(e,["parameters","addWatermark"],x);const b=i(t,["labels"]);e!==void 0&&b!=null&&l(e,["labels"],b);const _=i(t,["editMode"]);e!==void 0&&_!=null&&l(e,["parameters","editMode"],_);const w=i(t,["baseSteps"]);return e!==void 0&&w!=null&&l(e,["parameters","editConfig","baseSteps"],w),n}function s0(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["prompt"]);s!=null&&l(n,["instances[0]","prompt"],s);const r=i(e,["referenceImages"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>iy(c))),l(n,["instances[0]","referenceImages"],u)}const a=i(e,["config"]);return a!=null&&o0(a,n),n}function r0(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(r=>Go(r))),l(e,["generatedImages"],s)}return e}function i0(t,e){const n={},o=i(t,["taskType"]);e!==void 0&&o!=null&&l(e,["requests[]","taskType"],o);const s=i(t,["title"]);e!==void 0&&s!=null&&l(e,["requests[]","title"],s);const r=i(t,["outputDimensionality"]);if(e!==void 0&&r!=null&&l(e,["requests[]","outputDimensionality"],r),i(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(i(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function a0(t,e){const n={},o=i(t,["taskType"]);e!==void 0&&o!=null&&l(e,["instances[]","task_type"],o);const s=i(t,["title"]);e!==void 0&&s!=null&&l(e,["instances[]","title"],s);const r=i(t,["outputDimensionality"]);e!==void 0&&r!=null&&l(e,["parameters","outputDimensionality"],r);const a=i(t,["mimeType"]);e!==void 0&&a!=null&&l(e,["instances[]","mimeType"],a);const u=i(t,["autoTruncate"]);return e!==void 0&&u!=null&&l(e,["parameters","autoTruncate"],u),n}function l0(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let u=mr(t,s);Array.isArray(u)&&(u=u.map(c=>c)),l(n,["requests[]","content"],u)}const r=i(e,["config"]);r!=null&&i0(r,n);const a=i(e,["model"]);return a!==void 0&&l(n,["requests[]","model"],Q(t,a)),n}function u0(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let a=mr(t,s);Array.isArray(a)&&(a=a.map(u=>u)),l(n,["instances[]","content"],a)}const r=i(e,["config"]);return r!=null&&a0(r,n),n}function c0(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["embeddings"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["embeddings"],r)}const s=i(t,["metadata"]);return s!=null&&l(e,["metadata"],s),e}function d0(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["predictions[]","embeddings"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(a=>Og(a))),l(e,["embeddings"],r)}const s=i(t,["metadata"]);return s!=null&&l(e,["metadata"],s),e}function f0(t){const e={},n=i(t,["endpoint"]);n!=null&&l(e,["name"],n);const o=i(t,["deployedModelId"]);return o!=null&&l(e,["deployedModelId"],o),e}function h0(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function p0(t){const e={},n=i(t,["id"]);n!=null&&l(e,["id"],n);const o=i(t,["args"]);o!=null&&l(e,["args"],o);const s=i(t,["name"]);if(s!=null&&l(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function m0(t){const e={},n=i(t,["mode"]);n!=null&&l(e,["mode"],n);const o=i(t,["allowedFunctionNames"]);if(o!=null&&l(e,["allowedFunctionNames"],o),i(t,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function g0(t){const e={};if(i(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=i(t,["description"]);n!=null&&l(e,["description"],n);const o=i(t,["name"]);o!=null&&l(e,["name"],o);const s=i(t,["parameters"]);s!=null&&l(e,["parameters"],s);const r=i(t,["parametersJsonSchema"]);r!=null&&l(e,["parametersJsonSchema"],r);const a=i(t,["response"]);a!=null&&l(e,["response"],a);const u=i(t,["responseJsonSchema"]);return u!=null&&l(e,["responseJsonSchema"],u),e}function y0(t,e,n){const o={},s=i(e,["systemInstruction"]);n!==void 0&&s!=null&&l(n,["systemInstruction"],Lo(de(s)));const r=i(e,["temperature"]);r!=null&&l(o,["temperature"],r);const a=i(e,["topP"]);a!=null&&l(o,["topP"],a);const u=i(e,["topK"]);u!=null&&l(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&l(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&l(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&l(o,["stopSequences"],f);const m=i(e,["responseLogprobs"]);m!=null&&l(o,["responseLogprobs"],m);const p=i(e,["logprobs"]);p!=null&&l(o,["logprobs"],p);const g=i(e,["presencePenalty"]);g!=null&&l(o,["presencePenalty"],g);const v=i(e,["frequencyPenalty"]);v!=null&&l(o,["frequencyPenalty"],v);const y=i(e,["seed"]);y!=null&&l(o,["seed"],y);const x=i(e,["responseMimeType"]);x!=null&&l(o,["responseMimeType"],x);const b=i(e,["responseSchema"]);b!=null&&l(o,["responseSchema"],gr(b));const _=i(e,["responseJsonSchema"]);if(_!=null&&l(o,["responseJsonSchema"],_),i(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(i(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=i(e,["safetySettings"]);if(n!==void 0&&w!=null){let V=w;Array.isArray(V)&&(V=V.map(j=>ay(j))),l(n,["safetySettings"],V)}const C=i(e,["tools"]);if(n!==void 0&&C!=null){let V=on(C);Array.isArray(V)&&(V=V.map(j=>py(nn(j)))),l(n,["tools"],V)}const I=i(e,["toolConfig"]);if(n!==void 0&&I!=null&&l(n,["toolConfig"],hy(I)),i(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const k=i(e,["cachedContent"]);n!==void 0&&k!=null&&l(n,["cachedContent"],Qe(t,k));const T=i(e,["responseModalities"]);T!=null&&l(o,["responseModalities"],T);const U=i(e,["mediaResolution"]);U!=null&&l(o,["mediaResolution"],U);const E=i(e,["speechConfig"]);if(E!=null&&l(o,["speechConfig"],yr(E)),i(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=i(e,["thinkingConfig"]);R!=null&&l(o,["thinkingConfig"],R);const A=i(e,["imageConfig"]);A!=null&&l(o,["imageConfig"],O0(A));const z=i(e,["enableEnhancedCivicAnswers"]);return z!=null&&l(o,["enableEnhancedCivicAnswers"],z),o}function v0(t,e,n){const o={},s=i(e,["systemInstruction"]);n!==void 0&&s!=null&&l(n,["systemInstruction"],de(s));const r=i(e,["temperature"]);r!=null&&l(o,["temperature"],r);const a=i(e,["topP"]);a!=null&&l(o,["topP"],a);const u=i(e,["topK"]);u!=null&&l(o,["topK"],u);const c=i(e,["candidateCount"]);c!=null&&l(o,["candidateCount"],c);const d=i(e,["maxOutputTokens"]);d!=null&&l(o,["maxOutputTokens"],d);const f=i(e,["stopSequences"]);f!=null&&l(o,["stopSequences"],f);const m=i(e,["responseLogprobs"]);m!=null&&l(o,["responseLogprobs"],m);const p=i(e,["logprobs"]);p!=null&&l(o,["logprobs"],p);const g=i(e,["presencePenalty"]);g!=null&&l(o,["presencePenalty"],g);const v=i(e,["frequencyPenalty"]);v!=null&&l(o,["frequencyPenalty"],v);const y=i(e,["seed"]);y!=null&&l(o,["seed"],y);const x=i(e,["responseMimeType"]);x!=null&&l(o,["responseMimeType"],x);const b=i(e,["responseSchema"]);b!=null&&l(o,["responseSchema"],gr(b));const _=i(e,["responseJsonSchema"]);_!=null&&l(o,["responseJsonSchema"],_);const w=i(e,["routingConfig"]);w!=null&&l(o,["routingConfig"],w);const C=i(e,["modelSelectionConfig"]);C!=null&&l(o,["modelConfig"],C);const I=i(e,["safetySettings"]);if(n!==void 0&&I!=null){let $=I;Array.isArray($)&&($=$.map(P=>P)),l(n,["safetySettings"],$)}const k=i(e,["tools"]);if(n!==void 0&&k!=null){let $=on(k);Array.isArray($)&&($=$.map(P=>gu(nn(P)))),l(n,["tools"],$)}const T=i(e,["toolConfig"]);n!==void 0&&T!=null&&l(n,["toolConfig"],T);const U=i(e,["labels"]);n!==void 0&&U!=null&&l(n,["labels"],U);const E=i(e,["cachedContent"]);n!==void 0&&E!=null&&l(n,["cachedContent"],Qe(t,E));const R=i(e,["responseModalities"]);R!=null&&l(o,["responseModalities"],R);const A=i(e,["mediaResolution"]);A!=null&&l(o,["mediaResolution"],A);const z=i(e,["speechConfig"]);z!=null&&l(o,["speechConfig"],yr(z));const V=i(e,["audioTimestamp"]);V!=null&&l(o,["audioTimestamp"],V);const j=i(e,["thinkingConfig"]);j!=null&&l(o,["thinkingConfig"],j);const q=i(e,["imageConfig"]);if(q!=null&&l(o,["imageConfig"],K0(q)),i(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return o}function Sa(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let a=Ce(s);Array.isArray(a)&&(a=a.map(u=>Lo(u))),l(n,["contents"],a)}const r=i(e,["config"]);return r!=null&&l(n,["generationConfig"],y0(t,r,n)),n}function Ea(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["contents"]);if(s!=null){let a=Ce(s);Array.isArray(a)&&(a=a.map(u=>u)),l(n,["contents"],a)}const r=i(e,["config"]);return r!=null&&l(n,["generationConfig"],v0(t,r,n)),n}function Ia(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["candidates"]);if(o!=null){let c=o;Array.isArray(c)&&(c=c.map(d=>Vg(d))),l(e,["candidates"],c)}const s=i(t,["modelVersion"]);s!=null&&l(e,["modelVersion"],s);const r=i(t,["promptFeedback"]);r!=null&&l(e,["promptFeedback"],r);const a=i(t,["responseId"]);a!=null&&l(e,["responseId"],a);const u=i(t,["usageMetadata"]);return u!=null&&l(e,["usageMetadata"],u),e}function ka(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["candidates"]);if(o!=null){let d=o;Array.isArray(d)&&(d=d.map(f=>f)),l(e,["candidates"],d)}const s=i(t,["createTime"]);s!=null&&l(e,["createTime"],s);const r=i(t,["modelVersion"]);r!=null&&l(e,["modelVersion"],r);const a=i(t,["promptFeedback"]);a!=null&&l(e,["promptFeedback"],a);const u=i(t,["responseId"]);u!=null&&l(e,["responseId"],u);const c=i(t,["usageMetadata"]);return c!=null&&l(e,["usageMetadata"],c),e}function x0(t,e){const n={};if(i(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const o=i(t,["numberOfImages"]);e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o);const s=i(t,["aspectRatio"]);e!==void 0&&s!=null&&l(e,["parameters","aspectRatio"],s);const r=i(t,["guidanceScale"]);if(e!==void 0&&r!=null&&l(e,["parameters","guidanceScale"],r),i(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=i(t,["safetyFilterLevel"]);e!==void 0&&a!=null&&l(e,["parameters","safetySetting"],a);const u=i(t,["personGeneration"]);e!==void 0&&u!=null&&l(e,["parameters","personGeneration"],u);const c=i(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&l(e,["parameters","includeSafetyAttributes"],c);const d=i(t,["includeRaiReason"]);e!==void 0&&d!=null&&l(e,["parameters","includeRaiReason"],d);const f=i(t,["language"]);e!==void 0&&f!=null&&l(e,["parameters","language"],f);const m=i(t,["outputMimeType"]);e!==void 0&&m!=null&&l(e,["parameters","outputOptions","mimeType"],m);const p=i(t,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&l(e,["parameters","outputOptions","compressionQuality"],p),i(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(i(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const g=i(t,["imageSize"]);if(e!==void 0&&g!=null&&l(e,["parameters","sampleImageSize"],g),i(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function b0(t,e){const n={},o=i(t,["outputGcsUri"]);e!==void 0&&o!=null&&l(e,["parameters","storageUri"],o);const s=i(t,["negativePrompt"]);e!==void 0&&s!=null&&l(e,["parameters","negativePrompt"],s);const r=i(t,["numberOfImages"]);e!==void 0&&r!=null&&l(e,["parameters","sampleCount"],r);const a=i(t,["aspectRatio"]);e!==void 0&&a!=null&&l(e,["parameters","aspectRatio"],a);const u=i(t,["guidanceScale"]);e!==void 0&&u!=null&&l(e,["parameters","guidanceScale"],u);const c=i(t,["seed"]);e!==void 0&&c!=null&&l(e,["parameters","seed"],c);const d=i(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&l(e,["parameters","safetySetting"],d);const f=i(t,["personGeneration"]);e!==void 0&&f!=null&&l(e,["parameters","personGeneration"],f);const m=i(t,["includeSafetyAttributes"]);e!==void 0&&m!=null&&l(e,["parameters","includeSafetyAttributes"],m);const p=i(t,["includeRaiReason"]);e!==void 0&&p!=null&&l(e,["parameters","includeRaiReason"],p);const g=i(t,["language"]);e!==void 0&&g!=null&&l(e,["parameters","language"],g);const v=i(t,["outputMimeType"]);e!==void 0&&v!=null&&l(e,["parameters","outputOptions","mimeType"],v);const y=i(t,["outputCompressionQuality"]);e!==void 0&&y!=null&&l(e,["parameters","outputOptions","compressionQuality"],y);const x=i(t,["addWatermark"]);e!==void 0&&x!=null&&l(e,["parameters","addWatermark"],x);const b=i(t,["labels"]);e!==void 0&&b!=null&&l(e,["labels"],b);const _=i(t,["imageSize"]);e!==void 0&&_!=null&&l(e,["parameters","sampleImageSize"],_);const w=i(t,["enhancePrompt"]);return e!==void 0&&w!=null&&l(e,["parameters","enhancePrompt"],w),n}function _0(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["prompt"]);s!=null&&l(n,["instances[0]","prompt"],s);const r=i(e,["config"]);return r!=null&&x0(r,n),n}function w0(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["prompt"]);s!=null&&l(n,["instances[0]","prompt"],s);const r=i(e,["config"]);return r!=null&&b0(r,n),n}function C0(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(a=>U0(a))),l(e,["generatedImages"],r)}const s=i(t,["positivePromptSafetyAttributes"]);return s!=null&&l(e,["positivePromptSafetyAttributes"],pu(s)),e}function T0(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let r=o;Array.isArray(r)&&(r=r.map(a=>Go(a))),l(e,["generatedImages"],r)}const s=i(t,["positivePromptSafetyAttributes"]);return s!=null&&l(e,["positivePromptSafetyAttributes"],mu(s)),e}function S0(t,e){const n={},o=i(t,["numberOfVideos"]);if(e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o),i(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(i(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=i(t,["durationSeconds"]);if(e!==void 0&&s!=null&&l(e,["parameters","durationSeconds"],s),i(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=i(t,["aspectRatio"]);e!==void 0&&r!=null&&l(e,["parameters","aspectRatio"],r);const a=i(t,["resolution"]);e!==void 0&&a!=null&&l(e,["parameters","resolution"],a);const u=i(t,["personGeneration"]);if(e!==void 0&&u!=null&&l(e,["parameters","personGeneration"],u),i(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=i(t,["negativePrompt"]);e!==void 0&&c!=null&&l(e,["parameters","negativePrompt"],c);const d=i(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&l(e,["parameters","enhancePrompt"],d),i(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const f=i(t,["lastFrame"]);e!==void 0&&f!=null&&l(e,["instances[0]","lastFrame"],qo(f));const m=i(t,["referenceImages"]);if(e!==void 0&&m!=null){let p=m;Array.isArray(p)&&(p=p.map(g=>Iy(g))),l(e,["instances[0]","referenceImages"],p)}if(i(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(i(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function E0(t,e){const n={},o=i(t,["numberOfVideos"]);e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o);const s=i(t,["outputGcsUri"]);e!==void 0&&s!=null&&l(e,["parameters","storageUri"],s);const r=i(t,["fps"]);e!==void 0&&r!=null&&l(e,["parameters","fps"],r);const a=i(t,["durationSeconds"]);e!==void 0&&a!=null&&l(e,["parameters","durationSeconds"],a);const u=i(t,["seed"]);e!==void 0&&u!=null&&l(e,["parameters","seed"],u);const c=i(t,["aspectRatio"]);e!==void 0&&c!=null&&l(e,["parameters","aspectRatio"],c);const d=i(t,["resolution"]);e!==void 0&&d!=null&&l(e,["parameters","resolution"],d);const f=i(t,["personGeneration"]);e!==void 0&&f!=null&&l(e,["parameters","personGeneration"],f);const m=i(t,["pubsubTopic"]);e!==void 0&&m!=null&&l(e,["parameters","pubsubTopic"],m);const p=i(t,["negativePrompt"]);e!==void 0&&p!=null&&l(e,["parameters","negativePrompt"],p);const g=i(t,["enhancePrompt"]);e!==void 0&&g!=null&&l(e,["parameters","enhancePrompt"],g);const v=i(t,["generateAudio"]);e!==void 0&&v!=null&&l(e,["parameters","generateAudio"],v);const y=i(t,["lastFrame"]);e!==void 0&&y!=null&&l(e,["instances[0]","lastFrame"],Re(y));const x=i(t,["referenceImages"]);if(e!==void 0&&x!=null){let w=x;Array.isArray(w)&&(w=w.map(C=>ky(C))),l(e,["instances[0]","referenceImages"],w)}const b=i(t,["mask"]);e!==void 0&&b!=null&&l(e,["instances[0]","mask"],Ey(b));const _=i(t,["compressionQuality"]);return e!==void 0&&_!=null&&l(e,["parameters","compressionQuality"],_),n}function I0(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata"]);o!=null&&l(e,["metadata"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["response","generateVideoResponse"]);return a!=null&&l(e,["response"],P0(a)),e}function k0(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata"]);o!=null&&l(e,["metadata"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["response"]);return a!=null&&l(e,["response"],R0(a)),e}function N0(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["prompt"]);s!=null&&l(n,["instances[0]","prompt"],s);const r=i(e,["image"]);r!=null&&l(n,["instances[0]","image"],qo(r));const a=i(e,["video"]);a!=null&&l(n,["instances[0]","video"],yu(a));const u=i(e,["source"]);u!=null&&M0(u,n);const c=i(e,["config"]);return c!=null&&S0(c,n),n}function A0(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["prompt"]);s!=null&&l(n,["instances[0]","prompt"],s);const r=i(e,["image"]);r!=null&&l(n,["instances[0]","image"],Re(r));const a=i(e,["video"]);a!=null&&l(n,["instances[0]","video"],vu(a));const u=i(e,["source"]);u!=null&&D0(u,n);const c=i(e,["config"]);return c!=null&&E0(c,n),n}function P0(t){const e={},n=i(t,["generatedSamples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>L0(a))),l(e,["generatedVideos"],r)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&l(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&l(e,["raiMediaFilteredReasons"],s),e}function R0(t){const e={},n=i(t,["videos"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(a=>G0(a))),l(e,["generatedVideos"],r)}const o=i(t,["raiMediaFilteredCount"]);o!=null&&l(e,["raiMediaFilteredCount"],o);const s=i(t,["raiMediaFilteredReasons"]);return s!=null&&l(e,["raiMediaFilteredReasons"],s),e}function M0(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&l(e,["instances[0]","prompt"],o);const s=i(t,["image"]);e!==void 0&&s!=null&&l(e,["instances[0]","image"],qo(s));const r=i(t,["video"]);return e!==void 0&&r!=null&&l(e,["instances[0]","video"],yu(r)),n}function D0(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&l(e,["instances[0]","prompt"],o);const s=i(t,["image"]);e!==void 0&&s!=null&&l(e,["instances[0]","image"],Re(s));const r=i(t,["video"]);return e!==void 0&&r!=null&&l(e,["instances[0]","video"],vu(r)),n}function U0(t){const e={},n=i(t,["_self"]);n!=null&&l(e,["image"],J0(n));const o=i(t,["raiFilteredReason"]);o!=null&&l(e,["raiFilteredReason"],o);const s=i(t,["_self"]);return s!=null&&l(e,["safetyAttributes"],pu(s)),e}function Go(t){const e={},n=i(t,["_self"]);n!=null&&l(e,["image"],hu(n));const o=i(t,["raiFilteredReason"]);o!=null&&l(e,["raiFilteredReason"],o);const s=i(t,["_self"]);s!=null&&l(e,["safetyAttributes"],mu(s));const r=i(t,["prompt"]);return r!=null&&l(e,["enhancedPrompt"],r),e}function F0(t){const e={},n=i(t,["_self"]);n!=null&&l(e,["mask"],hu(n));const o=i(t,["labels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(r=>r)),l(e,["labels"],s)}return e}function L0(t){const e={},n=i(t,["video"]);return n!=null&&l(e,["video"],Ty(n)),e}function G0(t){const e={},n=i(t,["_self"]);return n!=null&&l(e,["video"],Sy(n)),e}function q0(t){const e={},n=i(t,["modelSelectionConfig"]);n!=null&&l(e,["modelConfig"],n);const o=i(t,["responseJsonSchema"]);o!=null&&l(e,["responseJsonSchema"],o);const s=i(t,["audioTimestamp"]);s!=null&&l(e,["audioTimestamp"],s);const r=i(t,["candidateCount"]);r!=null&&l(e,["candidateCount"],r);const a=i(t,["enableAffectiveDialog"]);a!=null&&l(e,["enableAffectiveDialog"],a);const u=i(t,["frequencyPenalty"]);u!=null&&l(e,["frequencyPenalty"],u);const c=i(t,["logprobs"]);c!=null&&l(e,["logprobs"],c);const d=i(t,["maxOutputTokens"]);d!=null&&l(e,["maxOutputTokens"],d);const f=i(t,["mediaResolution"]);f!=null&&l(e,["mediaResolution"],f);const m=i(t,["presencePenalty"]);m!=null&&l(e,["presencePenalty"],m);const p=i(t,["responseLogprobs"]);p!=null&&l(e,["responseLogprobs"],p);const g=i(t,["responseMimeType"]);g!=null&&l(e,["responseMimeType"],g);const v=i(t,["responseModalities"]);v!=null&&l(e,["responseModalities"],v);const y=i(t,["responseSchema"]);y!=null&&l(e,["responseSchema"],y);const x=i(t,["routingConfig"]);x!=null&&l(e,["routingConfig"],x);const b=i(t,["seed"]);b!=null&&l(e,["seed"],b);const _=i(t,["speechConfig"]);_!=null&&l(e,["speechConfig"],_);const w=i(t,["stopSequences"]);w!=null&&l(e,["stopSequences"],w);const C=i(t,["temperature"]);C!=null&&l(e,["temperature"],C);const I=i(t,["thinkingConfig"]);I!=null&&l(e,["thinkingConfig"],I);const k=i(t,["topK"]);k!=null&&l(e,["topK"],k);const T=i(t,["topP"]);if(T!=null&&l(e,["topP"],T),i(t,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function V0(t,e){const n={},o=i(e,["model"]);return o!=null&&l(n,["_url","name"],Q(t,o)),n}function H0(t,e){const n={},o=i(e,["model"]);return o!=null&&l(n,["_url","name"],Q(t,o)),n}function B0(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function $0(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function O0(t){const e={},n=i(t,["aspectRatio"]);n!=null&&l(e,["aspectRatio"],n);const o=i(t,["imageSize"]);if(o!=null&&l(e,["imageSize"],o),i(t,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(i(t,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function K0(t){const e={},n=i(t,["aspectRatio"]);n!=null&&l(e,["aspectRatio"],n);const o=i(t,["imageSize"]);o!=null&&l(e,["imageSize"],o);const s=i(t,["outputMimeType"]);s!=null&&l(e,["imageOutputOptions","mimeType"],s);const r=i(t,["outputCompressionQuality"]);return r!=null&&l(e,["imageOutputOptions","compressionQuality"],r),e}function J0(t){const e={},n=i(t,["bytesBase64Encoded"]);n!=null&&l(e,["imageBytes"],mt(n));const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function hu(t){const e={},n=i(t,["gcsUri"]);n!=null&&l(e,["gcsUri"],n);const o=i(t,["bytesBase64Encoded"]);o!=null&&l(e,["imageBytes"],mt(o));const s=i(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function qo(t){const e={};if(i(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=i(t,["imageBytes"]);n!=null&&l(e,["bytesBase64Encoded"],mt(n));const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function Re(t){const e={},n=i(t,["gcsUri"]);n!=null&&l(e,["gcsUri"],n);const o=i(t,["imageBytes"]);o!=null&&l(e,["bytesBase64Encoded"],mt(o));const s=i(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function z0(t,e,n){const o={},s=i(e,["pageSize"]);n!==void 0&&s!=null&&l(n,["_query","pageSize"],s);const r=i(e,["pageToken"]);n!==void 0&&r!=null&&l(n,["_query","pageToken"],r);const a=i(e,["filter"]);n!==void 0&&a!=null&&l(n,["_query","filter"],a);const u=i(e,["queryBase"]);return n!==void 0&&u!=null&&l(n,["_url","models_url"],iu(t,u)),o}function j0(t,e,n){const o={},s=i(e,["pageSize"]);n!==void 0&&s!=null&&l(n,["_query","pageSize"],s);const r=i(e,["pageToken"]);n!==void 0&&r!=null&&l(n,["_query","pageToken"],r);const a=i(e,["filter"]);n!==void 0&&a!=null&&l(n,["_query","filter"],a);const u=i(e,["queryBase"]);return n!==void 0&&u!=null&&l(n,["_url","models_url"],iu(t,u)),o}function W0(t,e){const n={},o=i(e,["config"]);return o!=null&&z0(t,o,n),n}function Y0(t,e){const n={},o=i(e,["config"]);return o!=null&&j0(t,o,n),n}function Q0(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["_self"]);if(s!=null){let r=au(s);Array.isArray(r)&&(r=r.map(a=>Vs(a))),l(e,["models"],r)}return e}function X0(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["_self"]);if(s!=null){let r=au(s);Array.isArray(r)&&(r=r.map(a=>Hs(a))),l(e,["models"],r)}return e}function Z0(t){const e={},n=i(t,["maskMode"]);n!=null&&l(e,["maskMode"],n);const o=i(t,["segmentationClasses"]);o!=null&&l(e,["maskClasses"],o);const s=i(t,["maskDilation"]);return s!=null&&l(e,["dilation"],s),e}function Vs(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["displayName"]);o!=null&&l(e,["displayName"],o);const s=i(t,["description"]);s!=null&&l(e,["description"],s);const r=i(t,["version"]);r!=null&&l(e,["version"],r);const a=i(t,["_self"]);a!=null&&l(e,["tunedModelInfo"],my(a));const u=i(t,["inputTokenLimit"]);u!=null&&l(e,["inputTokenLimit"],u);const c=i(t,["outputTokenLimit"]);c!=null&&l(e,["outputTokenLimit"],c);const d=i(t,["supportedGenerationMethods"]);d!=null&&l(e,["supportedActions"],d);const f=i(t,["temperature"]);f!=null&&l(e,["temperature"],f);const m=i(t,["maxTemperature"]);m!=null&&l(e,["maxTemperature"],m);const p=i(t,["topP"]);p!=null&&l(e,["topP"],p);const g=i(t,["topK"]);g!=null&&l(e,["topK"],g);const v=i(t,["thinking"]);return v!=null&&l(e,["thinking"],v),e}function Hs(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["displayName"]);o!=null&&l(e,["displayName"],o);const s=i(t,["description"]);s!=null&&l(e,["description"],s);const r=i(t,["versionId"]);r!=null&&l(e,["version"],r);const a=i(t,["deployedModels"]);if(a!=null){let m=a;Array.isArray(m)&&(m=m.map(p=>f0(p))),l(e,["endpoints"],m)}const u=i(t,["labels"]);u!=null&&l(e,["labels"],u);const c=i(t,["_self"]);c!=null&&l(e,["tunedModelInfo"],gy(c));const d=i(t,["defaultCheckpointId"]);d!=null&&l(e,["defaultCheckpointId"],d);const f=i(t,["checkpoints"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(p=>p)),l(e,["checkpoints"],m)}return e}function ey(t){const e={},n=i(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&l(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&l(e,["executableCode"],s);const r=i(t,["fileData"]);r!=null&&l(e,["fileData"],h0(r));const a=i(t,["functionCall"]);a!=null&&l(e,["functionCall"],p0(a));const u=i(t,["functionResponse"]);u!=null&&l(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&l(e,["inlineData"],qg(c));const d=i(t,["text"]);d!=null&&l(e,["text"],d);const f=i(t,["thought"]);f!=null&&l(e,["thought"],f);const m=i(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const p=i(t,["videoMetadata"]);return p!=null&&l(e,["videoMetadata"],p),e}function ty(t){const e={},n=i(t,["productImage"]);return n!=null&&l(e,["image"],Re(n)),e}function ny(t,e){const n={},o=i(t,["numberOfImages"]);e!==void 0&&o!=null&&l(e,["parameters","sampleCount"],o);const s=i(t,["baseSteps"]);e!==void 0&&s!=null&&l(e,["parameters","baseSteps"],s);const r=i(t,["outputGcsUri"]);e!==void 0&&r!=null&&l(e,["parameters","storageUri"],r);const a=i(t,["seed"]);e!==void 0&&a!=null&&l(e,["parameters","seed"],a);const u=i(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&l(e,["parameters","safetySetting"],u);const c=i(t,["personGeneration"]);e!==void 0&&c!=null&&l(e,["parameters","personGeneration"],c);const d=i(t,["addWatermark"]);e!==void 0&&d!=null&&l(e,["parameters","addWatermark"],d);const f=i(t,["outputMimeType"]);e!==void 0&&f!=null&&l(e,["parameters","outputOptions","mimeType"],f);const m=i(t,["outputCompressionQuality"]);e!==void 0&&m!=null&&l(e,["parameters","outputOptions","compressionQuality"],m);const p=i(t,["enhancePrompt"]);e!==void 0&&p!=null&&l(e,["parameters","enhancePrompt"],p);const g=i(t,["labels"]);return e!==void 0&&g!=null&&l(e,["labels"],g),n}function oy(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["source"]);s!=null&&ry(s,n);const r=i(e,["config"]);return r!=null&&ny(r,n),n}function sy(t){const e={},n=i(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>Go(s))),l(e,["generatedImages"],o)}return e}function ry(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&l(e,["instances[0]","prompt"],o);const s=i(t,["personImage"]);e!==void 0&&s!=null&&l(e,["instances[0]","personImage","image"],Re(s));const r=i(t,["productImages"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>ty(u))),l(e,["instances[0]","productImages"],a)}return n}function iy(t){const e={},n=i(t,["referenceImage"]);n!=null&&l(e,["referenceImage"],Re(n));const o=i(t,["referenceId"]);o!=null&&l(e,["referenceId"],o);const s=i(t,["referenceType"]);s!=null&&l(e,["referenceType"],s);const r=i(t,["maskImageConfig"]);r!=null&&l(e,["maskImageConfig"],Z0(r));const a=i(t,["controlImageConfig"]);a!=null&&l(e,["controlImageConfig"],Jg(a));const u=i(t,["styleImageConfig"]);u!=null&&l(e,["styleImageConfig"],u);const c=i(t,["subjectImageConfig"]);return c!=null&&l(e,["subjectImageConfig"],c),e}function pu(t){const e={},n=i(t,["safetyAttributes","categories"]);n!=null&&l(e,["categories"],n);const o=i(t,["safetyAttributes","scores"]);o!=null&&l(e,["scores"],o);const s=i(t,["contentType"]);return s!=null&&l(e,["contentType"],s),e}function mu(t){const e={},n=i(t,["safetyAttributes","categories"]);n!=null&&l(e,["categories"],n);const o=i(t,["safetyAttributes","scores"]);o!=null&&l(e,["scores"],o);const s=i(t,["contentType"]);return s!=null&&l(e,["contentType"],s),e}function ay(t){const e={},n=i(t,["category"]);if(n!=null&&l(e,["category"],n),i(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const o=i(t,["threshold"]);return o!=null&&l(e,["threshold"],o),e}function ly(t){const e={},n=i(t,["image"]);return n!=null&&l(e,["image"],Re(n)),e}function uy(t,e){const n={},o=i(t,["mode"]);e!==void 0&&o!=null&&l(e,["parameters","mode"],o);const s=i(t,["maxPredictions"]);e!==void 0&&s!=null&&l(e,["parameters","maxPredictions"],s);const r=i(t,["confidenceThreshold"]);e!==void 0&&r!=null&&l(e,["parameters","confidenceThreshold"],r);const a=i(t,["maskDilation"]);e!==void 0&&a!=null&&l(e,["parameters","maskDilation"],a);const u=i(t,["binaryColorThreshold"]);e!==void 0&&u!=null&&l(e,["parameters","binaryColorThreshold"],u);const c=i(t,["labels"]);return e!==void 0&&c!=null&&l(e,["labels"],c),n}function cy(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["source"]);s!=null&&fy(s,n);const r=i(e,["config"]);return r!=null&&uy(r,n),n}function dy(t){const e={},n=i(t,["predictions"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>F0(s))),l(e,["generatedMasks"],o)}return e}function fy(t,e){const n={},o=i(t,["prompt"]);e!==void 0&&o!=null&&l(e,["instances[0]","prompt"],o);const s=i(t,["image"]);e!==void 0&&s!=null&&l(e,["instances[0]","image"],Re(s));const r=i(t,["scribbleImage"]);return e!==void 0&&r!=null&&l(e,["instances[0]","scribble"],ly(r)),n}function hy(t){const e={},n=i(t,["functionCallingConfig"]);n!=null&&l(e,["functionCallingConfig"],m0(n));const o=i(t,["retrievalConfig"]);return o!=null&&l(e,["retrievalConfig"],o),e}function py(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(t,["googleSearchRetrieval"]);o!=null&&l(e,["googleSearchRetrieval"],o);const s=i(t,["computerUse"]);s!=null&&l(e,["computerUse"],s);const r=i(t,["fileSearch"]);r!=null&&l(e,["fileSearch"],r);const a=i(t,["codeExecution"]);if(a!=null&&l(e,["codeExecution"],a),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=i(t,["googleMaps"]);u!=null&&l(e,["googleMaps"],B0(u));const c=i(t,["googleSearch"]);c!=null&&l(e,["googleSearch"],$0(c));const d=i(t,["urlContext"]);return d!=null&&l(e,["urlContext"],d),e}function gu(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let m=n;Array.isArray(m)&&(m=m.map(p=>g0(p))),l(e,["functionDeclarations"],m)}const o=i(t,["retrieval"]);o!=null&&l(e,["retrieval"],o);const s=i(t,["googleSearchRetrieval"]);s!=null&&l(e,["googleSearchRetrieval"],s);const r=i(t,["computerUse"]);if(r!=null&&l(e,["computerUse"],r),i(t,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const a=i(t,["codeExecution"]);a!=null&&l(e,["codeExecution"],a);const u=i(t,["enterpriseWebSearch"]);u!=null&&l(e,["enterpriseWebSearch"],u);const c=i(t,["googleMaps"]);c!=null&&l(e,["googleMaps"],c);const d=i(t,["googleSearch"]);d!=null&&l(e,["googleSearch"],d);const f=i(t,["urlContext"]);return f!=null&&l(e,["urlContext"],f),e}function my(t){const e={},n=i(t,["baseModel"]);n!=null&&l(e,["baseModel"],n);const o=i(t,["createTime"]);o!=null&&l(e,["createTime"],o);const s=i(t,["updateTime"]);return s!=null&&l(e,["updateTime"],s),e}function gy(t){const e={},n=i(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&l(e,["baseModel"],n);const o=i(t,["createTime"]);o!=null&&l(e,["createTime"],o);const s=i(t,["updateTime"]);return s!=null&&l(e,["updateTime"],s),e}function yy(t,e){const n={},o=i(t,["displayName"]);e!==void 0&&o!=null&&l(e,["displayName"],o);const s=i(t,["description"]);e!==void 0&&s!=null&&l(e,["description"],s);const r=i(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&l(e,["defaultCheckpointId"],r),n}function vy(t,e){const n={},o=i(t,["displayName"]);e!==void 0&&o!=null&&l(e,["displayName"],o);const s=i(t,["description"]);e!==void 0&&s!=null&&l(e,["description"],s);const r=i(t,["defaultCheckpointId"]);return e!==void 0&&r!=null&&l(e,["defaultCheckpointId"],r),n}function xy(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","name"],Q(t,o));const s=i(e,["config"]);return s!=null&&yy(s,n),n}function by(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["config"]);return s!=null&&vy(s,n),n}function _y(t,e){const n={},o=i(t,["outputGcsUri"]);e!==void 0&&o!=null&&l(e,["parameters","storageUri"],o);const s=i(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&l(e,["parameters","safetySetting"],s);const r=i(t,["personGeneration"]);e!==void 0&&r!=null&&l(e,["parameters","personGeneration"],r);const a=i(t,["includeRaiReason"]);e!==void 0&&a!=null&&l(e,["parameters","includeRaiReason"],a);const u=i(t,["outputMimeType"]);e!==void 0&&u!=null&&l(e,["parameters","outputOptions","mimeType"],u);const c=i(t,["outputCompressionQuality"]);e!==void 0&&c!=null&&l(e,["parameters","outputOptions","compressionQuality"],c);const d=i(t,["enhanceInputImage"]);e!==void 0&&d!=null&&l(e,["parameters","upscaleConfig","enhanceInputImage"],d);const f=i(t,["imagePreservationFactor"]);e!==void 0&&f!=null&&l(e,["parameters","upscaleConfig","imagePreservationFactor"],f);const m=i(t,["labels"]);e!==void 0&&m!=null&&l(e,["labels"],m);const p=i(t,["numberOfImages"]);e!==void 0&&p!=null&&l(e,["parameters","sampleCount"],p);const g=i(t,["mode"]);return e!==void 0&&g!=null&&l(e,["parameters","mode"],g),n}function wy(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["_url","model"],Q(t,o));const s=i(e,["image"]);s!=null&&l(n,["instances[0]","image"],Re(s));const r=i(e,["upscaleFactor"]);r!=null&&l(n,["parameters","upscaleConfig","upscaleFactor"],r);const a=i(e,["config"]);return a!=null&&_y(a,n),n}function Cy(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["predictions"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(r=>Go(r))),l(e,["generatedImages"],s)}return e}function Ty(t){const e={},n=i(t,["uri"]);n!=null&&l(e,["uri"],n);const o=i(t,["encodedVideo"]);o!=null&&l(e,["videoBytes"],mt(o));const s=i(t,["encoding"]);return s!=null&&l(e,["mimeType"],s),e}function Sy(t){const e={},n=i(t,["gcsUri"]);n!=null&&l(e,["uri"],n);const o=i(t,["bytesBase64Encoded"]);o!=null&&l(e,["videoBytes"],mt(o));const s=i(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}function Ey(t){const e={},n=i(t,["image"]);n!=null&&l(e,["_self"],Re(n));const o=i(t,["maskMode"]);return o!=null&&l(e,["maskMode"],o),e}function Iy(t){const e={},n=i(t,["image"]);n!=null&&l(e,["image"],qo(n));const o=i(t,["referenceType"]);return o!=null&&l(e,["referenceType"],o),e}function ky(t){const e={},n=i(t,["image"]);n!=null&&l(e,["image"],Re(n));const o=i(t,["referenceType"]);return o!=null&&l(e,["referenceType"],o),e}function yu(t){const e={},n=i(t,["uri"]);n!=null&&l(e,["uri"],n);const o=i(t,["videoBytes"]);o!=null&&l(e,["encodedVideo"],mt(o));const s=i(t,["mimeType"]);return s!=null&&l(e,["encoding"],s),e}function vu(t){const e={},n=i(t,["uri"]);n!=null&&l(e,["gcsUri"],n);const o=i(t,["videoBytes"]);o!=null&&l(e,["bytesBase64Encoded"],mt(o));const s=i(t,["mimeType"]);return s!=null&&l(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ny(t,e){const n={},o=i(t,["displayName"]);return e!==void 0&&o!=null&&l(e,["displayName"],o),n}function Ay(t){const e={},n=i(t,["config"]);return n!=null&&Ny(n,e),e}function Py(t,e){const n={},o=i(t,["force"]);return e!==void 0&&o!=null&&l(e,["_query","force"],o),n}function Ry(t){const e={},n=i(t,["name"]);n!=null&&l(e,["_url","name"],n);const o=i(t,["config"]);return o!=null&&Py(o,e),e}function My(t){const e={},n=i(t,["name"]);return n!=null&&l(e,["_url","name"],n),e}function Dy(t,e){const n={},o=i(t,["customMetadata"]);if(e!==void 0&&o!=null){let r=o;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["customMetadata"],r)}const s=i(t,["chunkingConfig"]);return e!==void 0&&s!=null&&l(e,["chunkingConfig"],s),n}function Uy(t){const e={},n=i(t,["name"]);n!=null&&l(e,["name"],n);const o=i(t,["metadata"]);o!=null&&l(e,["metadata"],o);const s=i(t,["done"]);s!=null&&l(e,["done"],s);const r=i(t,["error"]);r!=null&&l(e,["error"],r);const a=i(t,["response"]);return a!=null&&l(e,["response"],Ly(a)),e}function Fy(t){const e={},n=i(t,["fileSearchStoreName"]);n!=null&&l(e,["_url","file_search_store_name"],n);const o=i(t,["fileName"]);o!=null&&l(e,["fileName"],o);const s=i(t,["config"]);return s!=null&&Dy(s,e),e}function Ly(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["parent"]);o!=null&&l(e,["parent"],o);const s=i(t,["documentName"]);return s!=null&&l(e,["documentName"],s),e}function Gy(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&l(e,["_query","pageToken"],s),n}function qy(t){const e={},n=i(t,["config"]);return n!=null&&Gy(n,e),e}function Vy(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["fileSearchStores"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["fileSearchStores"],r)}return e}function xu(t,e){const n={},o=i(t,["mimeType"]);e!==void 0&&o!=null&&l(e,["mimeType"],o);const s=i(t,["displayName"]);e!==void 0&&s!=null&&l(e,["displayName"],s);const r=i(t,["customMetadata"]);if(e!==void 0&&r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>c)),l(e,["customMetadata"],u)}const a=i(t,["chunkingConfig"]);return e!==void 0&&a!=null&&l(e,["chunkingConfig"],a),n}function Hy(t){const e={},n=i(t,["fileSearchStoreName"]);n!=null&&l(e,["_url","file_search_store_name"],n);const o=i(t,["config"]);return o!=null&&xu(o,e),e}function By(t){const e={},n=i(t,["sdkHttpResponse"]);return n!=null&&l(e,["sdkHttpResponse"],n),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const $y="Content-Type",Oy="X-Server-Timeout",Ky="User-Agent",Bs="x-goog-api-client",Jy="1.34.0",zy=`google-genai-sdk/${Jy}`,jy="v1beta1",Wy="v1beta";class Yy{constructor(e){var n,o;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:jy,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(o=this.clientOptions.apiVersion)!==null&&o!==void 0?o:Wy,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const o=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&o.push(e.apiVersion),o.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,o){const s=[this.getRequestUrlInternal(n)];return o&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,o);if(e.queryParams)for(const[a,u]of Object.entries(e.queryParams))s.searchParams.append(a,String(u));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,n,s.toString(),e.abortSignal),this.unaryApiCall(s,r,e.httpMethod)}patchHttpOptions(e,n){const o=JSON.parse(JSON.stringify(e));for(const[s,r]of Object.entries(n))typeof r=="object"?o[s]=Object.assign(Object.assign({},o[s]),r):r!==void 0&&(o[s]=r);return o}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const o=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,o);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,n,s.toString(),e.abortSignal),this.streamApiCall(s,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,o,s){if(n&&n.timeout||s){const r=new AbortController,a=r.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const u=setTimeout(()=>r.abort(),n.timeout);u&&typeof u.unref=="function"&&u.unref()}s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=a}return n&&n.extraBody!==null&&Qy(e,n.extraBody),e.headers=await this.getHeadersInternal(n,o),e}async unaryApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async s=>(await Na(s),new Ls(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,o){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:o})).then(async s=>(await Na(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){return Ae(this,arguments,function*(){var o;const s=(o=e==null?void 0:e.body)===null||o===void 0?void 0:o.getReader(),r=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let a="";const u="data:",c=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:d,value:f}=yield J(s.read());if(d){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const m=r.decode(f,{stream:!0});try{const v=JSON.parse(m);if("error"in v){const y=JSON.parse(JSON.stringify(v.error)),x=y.status,b=y.code,_=`got status: ${x}. ${JSON.stringify(v)}`;if(b>=400&&b<600)throw new Fo({message:_,status:b})}}catch(v){if(v.name==="ApiError")throw v}a+=m;let p=-1,g=0;for(;;){p=-1,g=0;for(const x of c){const b=a.indexOf(x);b!==-1&&(p===-1||b<p)&&(p=b,g=x.length)}if(p===-1)break;const v=a.substring(0,p);a=a.substring(p+g);const y=v.trim();if(y.startsWith(u)){const x=y.substring(u.length).trim();try{const b=new Response(x,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield J(new Ls(b))}catch(b){throw new Error(`exception parsing stream chunk ${x}. ${b}`)}}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(o=>{throw new Error(`exception ${o} sending request`)})}getDefaultHeaders(){const e={},n=zy+" "+this.clientOptions.userAgentExtra;return e[Ky]=n,e[Bs]=n,e[$y]="application/json",e}async getHeadersInternal(e,n){const o=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))o.append(s,r);e.timeout&&e.timeout>0&&o.append(Oy,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(o,n),o}getFileName(e){var n;let o="";return typeof e=="string"&&(o=e.replace(/[/\\]+$/,""),o=(n=o.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),o}async uploadFile(e,n){var o;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const r=this.clientOptions.uploader,a=await r.stat(e);s.sizeBytes=String(a.size);const u=(o=n==null?void 0:n.mimeType)!==null&&o!==void 0?o:a.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=u;const c={file:s},d=this.getFileName(e),f=F("upload/v1beta/files",c._url),m=await this.fetchUploadUrl(f,s.sizeBytes,s.mimeType,d,c,n==null?void 0:n.httpOptions);return r.upload(e,m,this)}async uploadFileToFileSearchStore(e,n,o){var s;const r=this.clientOptions.uploader,a=await r.stat(n),u=String(a.size),c=(s=o==null?void 0:o.mimeType)!==null&&s!==void 0?s:a.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,f=this.getFileName(n),m={};o!=null&&xu(o,m);const p=await this.fetchUploadUrl(d,u,c,f,m,o==null?void 0:o.httpOptions);return r.uploadToFileSearchStore(n,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n,o,s,r,a){var u;let c={};a?c=a:c={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${o}`},s?{"X-Goog-Upload-File-Name":s}:{})};const d=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:c});if(!d||!(d!=null&&d.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const f=(u=d==null?void 0:d.headers)===null||u===void 0?void 0:u["x-goog-upload-url"];if(f===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return f}}async function Na(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let o;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?o=await t.json():o={error:{message:await t.text(),code:t.status,status:t.statusText}};const s=JSON.stringify(o);throw n>=400&&n<600?new Fo({message:s,status:n}):new Error(s)}}function Qy(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const r=JSON.parse(t.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))n=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function o(r,a){const u=Object.assign({},r);for(const c in a)if(Object.prototype.hasOwnProperty.call(a,c)){const d=a[c],f=u[c];d&&typeof d=="object"&&!Array.isArray(d)&&f&&typeof f=="object"&&!Array.isArray(f)?u[c]=o(f,d):(f&&d&&typeof f!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof f}, New type: ${typeof d}. Overwriting.`),u[c]=d)}return u}const s=o(n,e);t.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Xy="mcp_used/unknown";let Zy=!1;function bu(t){for(const e of t)if(ev(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Zy}function _u(t){var e;const n=(e=t[Bs])!==null&&e!==void 0?e:"";t[Bs]=(n+` ${Xy}`).trimStart()}function ev(t){return t!==null&&typeof t=="object"&&t instanceof xr}function tv(t){return Ae(this,arguments,function*(n,o=100){let s,r=0;for(;r<o;){const a=yield J(n.listTools({cursor:s}));for(const u of a.tools)yield yield J(u),r++;if(!a.nextCursor)break;s=a.nextCursor}})}class xr{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new xr(e,n)}async initialize(){var e,n,o,s;if(this.mcpTools.length>0)return;const r={},a=[];for(const f of this.mcpClients)try{for(var u=!0,c=(n=void 0,Pe(tv(f))),d;d=await c.next(),e=d.done,!e;u=!0){s=d.value,u=!1;const m=s;a.push(m);const p=m.name;if(r[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);r[p]=f}}catch(m){n={error:m}}finally{try{!u&&!e&&(o=c.return)&&await o.call(c)}finally{if(n)throw n.error}}this.mcpTools=a,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),Mp(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const o of e)if(o.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[o.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const a=await s.callTool({name:o.name,arguments:o.args},void 0,r);n.push({functionResponse:{name:o.name,response:a.isError?{error:a}:a}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function nv(t,e,n){const o=new Sp;let s;n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),Object.assign(o,s),e(o)}class ov{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o}async connect(e){var n,o;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),a=iv(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${u}`;let d=()=>{};const f=new Promise(w=>{d=w}),m=e.callbacks,p=function(){d({})},g=this.apiClient,v={onopen:p,onmessage:w=>{nv(g,m.onmessage,w)},onerror:(n=m==null?void 0:m.onerror)!==null&&n!==void 0?n:function(w){},onclose:(o=m==null?void 0:m.onclose)!==null&&o!==void 0?o:function(w){}},y=this.webSocketFactory.create(c,rv(a),v);y.connect(),await f;const _={setup:{model:Q(this.apiClient,e.model)}};return y.send(JSON.stringify(_)),new sv(y,this.apiClient)}}class sv{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=Ag(e);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=Ng(e);this.conn.send(JSON.stringify(n))}sendPlaybackControl(e){const n={playbackControl:e};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ft.PLAY)}pause(){this.sendPlaybackControl(Ft.PAUSE)}stop(){this.sendPlaybackControl(Ft.STOP)}resetContext(){this.sendPlaybackControl(Ft.RESET_CONTEXT)}close(){this.conn.close()}}function rv(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function iv(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const av="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function lv(t,e,n){const o=new Tp;let s;n.data instanceof Blob?s=await n.data.text():n.data instanceof ArrayBuffer?s=new TextDecoder().decode(n.data):s=n.data;const r=JSON.parse(s);if(t.isVertexAI()){const a=Mg(r);Object.assign(o,a)}else Object.assign(o,r);e(o)}class uv{constructor(e,n,o){this.apiClient=e,this.auth=n,this.webSocketFactory=o,this.music=new ov(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,o,s,r,a,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let f;const m=this.apiClient.getHeaders();e.config&&e.config.tools&&bu(e.config.tools)&&_u(m);const p=hv(m);if(this.apiClient.isVertexAI())f=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,f);else{const E=this.apiClient.getApiKey();let R="BidiGenerateContent",A="key";E!=null&&E.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),R="BidiGenerateContentConstrained",A="access_token"),f=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${R}?${A}=${E}`}let g=()=>{};const v=new Promise(E=>{g=E}),y=e.callbacks,x=function(){var E;(E=y==null?void 0:y.onopen)===null||E===void 0||E.call(y),g({})},b=this.apiClient,_={onopen:x,onmessage:E=>{lv(b,y.onmessage,E)},onerror:(n=y==null?void 0:y.onerror)!==null&&n!==void 0?n:function(E){},onclose:(o=y==null?void 0:y.onclose)!==null&&o!==void 0?o:function(E){}},w=this.webSocketFactory.create(f,fv(p),_);w.connect(),await v;let C=Q(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&C.startsWith("publishers/")){const E=this.apiClient.getProject(),R=this.apiClient.getLocation();C=`projects/${E}/locations/${R}/`+C}let I={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[Co.AUDIO]}:e.config.responseModalities=[Co.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const k=(u=(a=e.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[],T=[];for(const E of k)if(this.isCallableTool(E)){const R=E;T.push(await R.tool())}else T.push(E);T.length>0&&(e.config.tools=T);const U={model:C,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?I=kg(this.apiClient,U):I=Ig(this.apiClient,U),delete I.config,w.send(JSON.stringify(I)),new dv(w,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const cv={turnComplete:!0};class dv{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let o=[];try{o=Ce(n.turns),e.isVertexAI()||(o=o.map(s=>Lo(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:o,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let o=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?o=n.functionResponses:o=[n.functionResponses],o.length===0)throw new Error("functionResponses is required.");for(const r of o){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(av)}return{toolResponse:{functionResponses:o}}}sendClientContent(e){e=Object.assign(Object.assign({},cv),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Rg(e)}:n={realtimeInput:Pg(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function fv(t){const e={};return t.forEach((n,o)=>{e[o]=n}),e}function hv(t){const e=new Headers;for(const[n,o]of Object.entries(t))e.append(n,o);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Aa=10;function Pa(t){var e,n,o;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const a of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if($t(a)){s=!0;break}if(!s)return!0;const r=(o=t==null?void 0:t.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function $t(t){return"callTool"in t&&typeof t.callTool=="function"}function pv(t){var e,n,o;return(o=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(s=>$t(s)))!==null&&o!==void 0?o:!1}function Ra(t){var e;const n=[];return!((e=t==null?void 0:t.config)===null||e===void 0)&&e.tools&&t.config.tools.forEach((o,s)=>{if($t(o))return;const r=o;r.functionDeclarations&&r.functionDeclarations.length>0&&n.push(s)}),n}function Ma(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class mv extends Ye{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var o,s,r,a,u;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!pv(n)||Pa(n.config))return await this.generateContentInternal(c);const d=Ra(n);if(d.length>0){const y=d.map(x=>`tools[${x}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${y}.`)}let f,m;const p=Ce(c.contents),g=(r=(s=(o=c.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:Aa;let v=0;for(;v<g&&(f=await this.generateContentInternal(c),!(!f.functionCalls||f.functionCalls.length===0));){const y=f.candidates[0].content,x=[];for(const b of(u=(a=n.config)===null||a===void 0?void 0:a.tools)!==null&&u!==void 0?u:[])if($t(b)){const w=await b.callTool(f.functionCalls);x.push(...w)}v++,m={role:"user",parts:x},c.contents=Ce(c.contents),c.contents.push(y),c.contents.push(m),Ma(c.config)&&(p.push(y),p.push(m))}return Ma(c.config)&&(f.automaticFunctionCallingHistory=p),f},this.generateContentStream=async n=>{var o,s,r,a,u;if(this.maybeMoveToResponseJsonSchem(n),Pa(n.config)){const m=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(m)}const c=Ra(n);if(c.length>0){const m=c.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${m}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(r=(s=(o=n==null?void 0:n.config)===null||o===void 0?void 0:o.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||r===void 0?void 0:r.streamFunctionCallArguments,f=(u=(a=n==null?void 0:n.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||u===void 0?void 0:u.disable;if(d&&!f)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(o=>{var s;let r;const a=[];if(o!=null&&o.generatedImages)for(const c of o.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?r=c==null?void 0:c.safetyAttributes:a.push(c);let u;return r?u={generatedImages:a,positivePromptSafetyAttributes:r,sdkHttpResponse:o.sdkHttpResponse}:u={generatedImages:a,sdkHttpResponse:o.sdkHttpResponse},u}),this.list=async n=>{var o;const a={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((o=a.config)===null||o===void 0)&&o.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new Pt(We.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(a),a)},this.editImage=async n=>{const o={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(o.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(o)},this.upscaleImage=async n=>{let o={numberOfImages:1,mode:"upscale"};n.config&&(o=Object.assign(Object.assign({},o),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:o};return await this.upscaleImageInternal(s)},this.generateVideos=async n=>{var o,s,r,a,u,c;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((o=n.video)===null||o===void 0)&&o.uri&&(!((s=n.video)===null||s===void 0)&&s.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((a=(r=n.source)===null||r===void 0?void 0:r.video)===null||a===void 0)&&a.uri&&(!((c=(u=n.source)===null||u===void 0?void 0:u.video)===null||c===void 0)&&c.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,o,s;const r=(n=e.config)===null||n===void 0?void 0:n.tools;if(!r)return e;const a=await Promise.all(r.map(async c=>$t(c)?await c.tool():c)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:a})};if(u.config.tools=a,e.config&&e.config.tools&&bu(e.config.tools)){const c=(s=(o=e.config.httpOptions)===null||o===void 0?void 0:o.headers)!==null&&s!==void 0?s:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),_u(d),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return u}async initAfcToolsMap(e){var n,o,s;const r=new Map;for(const a of(o=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&o!==void 0?o:[])if($t(a)){const u=a,c=await u.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(r.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);r.set(d.name,u)}}return r}async processAfcStream(e){var n,o,s;const r=(s=(o=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||o===void 0?void 0:o.maximumRemoteCalls)!==null&&s!==void 0?s:Aa;let a=!1,u=0;const c=await this.initAfcToolsMap(e);return function(d,f,m){return Ae(this,arguments,function*(){for(var p,g,v,y,x,b;u<r;){a&&(u++,a=!1);const I=yield J(d.processParamsMaybeAddMcpUsage(m)),k=yield J(d.generateContentStreamInternal(I)),T=[],U=[];try{for(var _=!0,w=(g=void 0,Pe(k)),C;C=yield J(w.next()),p=C.done,!p;_=!0){y=C.value,_=!1;const E=y;if(yield yield J(E),E.candidates&&(!((x=E.candidates[0])===null||x===void 0)&&x.content)){U.push(E.candidates[0].content);for(const R of(b=E.candidates[0].content.parts)!==null&&b!==void 0?b:[])if(u<r&&R.functionCall){if(!R.functionCall.name)throw new Error("Function call name was not returned by the model.");if(f.has(R.functionCall.name)){const A=yield J(f.get(R.functionCall.name).callTool([R.functionCall]));T.push(...A)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${f.keys()}, mising tool: ${R.functionCall.name}`)}}}}catch(E){g={error:E}}finally{try{!_&&!p&&(v=w.return)&&(yield J(v.call(w)))}finally{if(g)throw g.error}}if(T.length>0){a=!0;const E=new ln;E.candidates=[{content:{role:"user",parts:T}}],yield yield J(E);const R=[];R.push(...U),R.push({role:"user",parts:T});const A=Ce(m.contents).concat(R);m.contents=A}else break}})}(this,c,e)}async generateContentInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ea(this.apiClient,e);return u=F("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=ka(f),p=new ln;return Object.assign(p,m),p})}else{const d=Sa(this.apiClient,e);return u=F("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Ia(f),p=new ln;return Object.assign(p,m),p})}}async generateContentStreamInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ea(this.apiClient,e);return u=F("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),a.then(function(m){return Ae(this,arguments,function*(){var p,g,v,y;try{for(var x=!0,b=Pe(m),_;_=yield J(b.next()),p=_.done,!p;x=!0){y=_.value,x=!1;const w=y,C=ka(yield J(w.json()));C.sdkHttpResponse={headers:w.headers};const I=new ln;Object.assign(I,C),yield yield J(I)}}catch(w){g={error:w}}finally{try{!x&&!p&&(v=b.return)&&(yield J(v.call(b)))}finally{if(g)throw g.error}}})})}else{const d=Sa(this.apiClient,e);return u=F("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),a.then(function(m){return Ae(this,arguments,function*(){var p,g,v,y;try{for(var x=!0,b=Pe(m),_;_=yield J(b.next()),p=_.done,!p;x=!0){y=_.value,x=!1;const w=y,C=Ia(yield J(w.json()));C.sdkHttpResponse={headers:w.headers};const I=new ln;Object.assign(I,C),yield yield J(I)}}catch(w){g={error:w}}finally{try{!x&&!p&&(v=b.return)&&(yield J(v.call(b)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=u0(this.apiClient,e);return u=F("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=d0(f),p=new la;return Object.assign(p,m),p})}else{const d=l0(this.apiClient,e);return u=F("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=c0(f),p=new la;return Object.assign(p,m),p})}}async generateImagesInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=w0(this.apiClient,e);return u=F("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=T0(f),p=new ua;return Object.assign(p,m),p})}else{const d=_0(this.apiClient,e);return u=F("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=C0(f),p=new ua;return Object.assign(p,m),p})}}async editImageInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=s0(this.apiClient,e);return r=F("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=r0(c),f=new hp;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=wy(this.apiClient,e);return r=F("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=Cy(c),f=new pp;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=oy(this.apiClient,e);return r=F("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=sy(c),f=new mp;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=cy(this.apiClient,e);return r=F("{model}:predict",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=dy(c),f=new gp;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=H0(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>Hs(f))}else{const d=V0(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>Vs(f))}}async listInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Y0(this.apiClient,e);return u=F("{models_url}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=X0(f),p=new ca;return Object.assign(p,m),p})}else{const d=W0(this.apiClient,e);return u=F("{models_url}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Q0(f),p=new ca;return Object.assign(p,m),p})}}async update(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=by(this.apiClient,e);return u=F("{model}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>Hs(f))}else{const d=xy(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>Vs(f))}}async delete(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=e0(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=n0(f),p=new da;return Object.assign(p,m),p})}else{const d=Zg(this.apiClient,e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=t0(f),p=new da;return Object.assign(p,m),p})}}async countTokens(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Yg(this.apiClient,e);return u=F("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Xg(f),p=new fa;return Object.assign(p,m),p})}else{const d=Wg(this.apiClient,e);return u=F("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Qg(f),p=new fa;return Object.assign(p,m),p})}}async computeTokens(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=Bg(this.apiClient,e);return r=F("{model}:computeTokens",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>{const d=$g(c),f=new yp;return Object.assign(f,d),f})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=A0(this.apiClient,e);return u=F("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a.then(f=>{const m=k0(f),p=new To;return Object.assign(p,m),p})}else{const d=N0(this.apiClient,e);return u=F("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a.then(f=>{const m=I0(f),p=new To;return Object.assign(p,m),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class gv extends Ye{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let r;o&&"httpOptions"in o&&(r=o.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:r}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const n=e.operation,o=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let r;o&&"httpOptions"in o&&(r=o.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:r}});return n._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:n.name,config:o});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=ap(e);return u=F("{operationName}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json()),a}else{const d=ip(e);return u=F("{operationName}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),a}}async fetchPredictVideosOperationInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=Zh(e);return r=F("{resourceName}:fetchPredictOperation",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function yv(t){const e={},n=i(t,["data"]);if(n!=null&&l(e,["data"],n),i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function vv(t){const e={},n=i(t,["parts"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(r=>Iv(r))),l(e,["parts"],s)}const o=i(t,["role"]);return o!=null&&l(e,["role"],o),e}function xv(t,e,n){const o={},s=i(e,["expireTime"]);n!==void 0&&s!=null&&l(n,["expireTime"],s);const r=i(e,["newSessionExpireTime"]);n!==void 0&&r!=null&&l(n,["newSessionExpireTime"],r);const a=i(e,["uses"]);n!==void 0&&a!=null&&l(n,["uses"],a);const u=i(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&l(n,["bidiGenerateContentSetup"],Ev(t,u));const c=i(e,["lockAdditionalFields"]);return n!==void 0&&c!=null&&l(n,["fieldMask"],c),o}function bv(t,e){const n={},o=i(e,["config"]);return o!=null&&l(n,["config"],xv(t,o,n)),n}function _v(t){const e={};if(i(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=i(t,["fileUri"]);n!=null&&l(e,["fileUri"],n);const o=i(t,["mimeType"]);return o!=null&&l(e,["mimeType"],o),e}function wv(t){const e={},n=i(t,["id"]);n!=null&&l(e,["id"],n);const o=i(t,["args"]);o!=null&&l(e,["args"],o);const s=i(t,["name"]);if(s!=null&&l(e,["name"],s),i(t,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(i(t,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Cv(t){const e={};if(i(t,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=i(t,["enableWidget"]);return n!=null&&l(e,["enableWidget"],n),e}function Tv(t){const e={};if(i(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(i(t,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=i(t,["timeRangeFilter"]);return n!=null&&l(e,["timeRangeFilter"],n),e}function Sv(t,e){const n={},o=i(t,["generationConfig"]);e!==void 0&&o!=null&&l(e,["setup","generationConfig"],o);const s=i(t,["responseModalities"]);e!==void 0&&s!=null&&l(e,["setup","generationConfig","responseModalities"],s);const r=i(t,["temperature"]);e!==void 0&&r!=null&&l(e,["setup","generationConfig","temperature"],r);const a=i(t,["topP"]);e!==void 0&&a!=null&&l(e,["setup","generationConfig","topP"],a);const u=i(t,["topK"]);e!==void 0&&u!=null&&l(e,["setup","generationConfig","topK"],u);const c=i(t,["maxOutputTokens"]);e!==void 0&&c!=null&&l(e,["setup","generationConfig","maxOutputTokens"],c);const d=i(t,["mediaResolution"]);e!==void 0&&d!=null&&l(e,["setup","generationConfig","mediaResolution"],d);const f=i(t,["seed"]);e!==void 0&&f!=null&&l(e,["setup","generationConfig","seed"],f);const m=i(t,["speechConfig"]);e!==void 0&&m!=null&&l(e,["setup","generationConfig","speechConfig"],vr(m));const p=i(t,["thinkingConfig"]);e!==void 0&&p!=null&&l(e,["setup","generationConfig","thinkingConfig"],p);const g=i(t,["enableAffectiveDialog"]);e!==void 0&&g!=null&&l(e,["setup","generationConfig","enableAffectiveDialog"],g);const v=i(t,["systemInstruction"]);e!==void 0&&v!=null&&l(e,["setup","systemInstruction"],vv(de(v)));const y=i(t,["tools"]);if(e!==void 0&&y!=null){let k=on(y);Array.isArray(k)&&(k=k.map(T=>Nv(nn(T)))),l(e,["setup","tools"],k)}const x=i(t,["sessionResumption"]);e!==void 0&&x!=null&&l(e,["setup","sessionResumption"],kv(x));const b=i(t,["inputAudioTranscription"]);e!==void 0&&b!=null&&l(e,["setup","inputAudioTranscription"],b);const _=i(t,["outputAudioTranscription"]);e!==void 0&&_!=null&&l(e,["setup","outputAudioTranscription"],_);const w=i(t,["realtimeInputConfig"]);e!==void 0&&w!=null&&l(e,["setup","realtimeInputConfig"],w);const C=i(t,["contextWindowCompression"]);e!==void 0&&C!=null&&l(e,["setup","contextWindowCompression"],C);const I=i(t,["proactivity"]);if(e!==void 0&&I!=null&&l(e,["setup","proactivity"],I),i(t,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return n}function Ev(t,e){const n={},o=i(e,["model"]);o!=null&&l(n,["setup","model"],Q(t,o));const s=i(e,["config"]);return s!=null&&l(n,["config"],Sv(s,n)),n}function Iv(t){const e={},n=i(t,["mediaResolution"]);n!=null&&l(e,["mediaResolution"],n);const o=i(t,["codeExecutionResult"]);o!=null&&l(e,["codeExecutionResult"],o);const s=i(t,["executableCode"]);s!=null&&l(e,["executableCode"],s);const r=i(t,["fileData"]);r!=null&&l(e,["fileData"],_v(r));const a=i(t,["functionCall"]);a!=null&&l(e,["functionCall"],wv(a));const u=i(t,["functionResponse"]);u!=null&&l(e,["functionResponse"],u);const c=i(t,["inlineData"]);c!=null&&l(e,["inlineData"],yv(c));const d=i(t,["text"]);d!=null&&l(e,["text"],d);const f=i(t,["thought"]);f!=null&&l(e,["thought"],f);const m=i(t,["thoughtSignature"]);m!=null&&l(e,["thoughtSignature"],m);const p=i(t,["videoMetadata"]);return p!=null&&l(e,["videoMetadata"],p),e}function kv(t){const e={},n=i(t,["handle"]);if(n!=null&&l(e,["handle"],n),i(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Nv(t){const e={},n=i(t,["functionDeclarations"]);if(n!=null){let f=n;Array.isArray(f)&&(f=f.map(m=>m)),l(e,["functionDeclarations"],f)}if(i(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const o=i(t,["googleSearchRetrieval"]);o!=null&&l(e,["googleSearchRetrieval"],o);const s=i(t,["computerUse"]);s!=null&&l(e,["computerUse"],s);const r=i(t,["fileSearch"]);r!=null&&l(e,["fileSearch"],r);const a=i(t,["codeExecution"]);if(a!=null&&l(e,["codeExecution"],a),i(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const u=i(t,["googleMaps"]);u!=null&&l(e,["googleMaps"],Cv(u));const c=i(t,["googleSearch"]);c!=null&&l(e,["googleSearch"],Tv(c));const d=i(t,["urlContext"]);return d!=null&&l(e,["urlContext"],d),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Av(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const o=t[n];if(typeof o=="object"&&o!=null&&Object.keys(o).length>0){const s=Object.keys(o).map(r=>`${n}.${r}`);e.push(...s)}else e.push(n)}return e.join(",")}function Pv(t,e){let n=null;const o=t.bidiGenerateContentSetup;if(typeof o=="object"&&o!==null&&"setup"in o){const r=o.setup;typeof r=="object"&&r!==null?(t.bidiGenerateContentSetup=r,n=r):delete t.bidiGenerateContentSetup}else o!==void 0&&delete t.bidiGenerateContentSetup;const s=t.fieldMask;if(n){const r=Av(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)r?t.fieldMask=r:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];s.length>0&&(u=s.map(d=>a.includes(d)?`generationConfig.${d}`:d));const c=[];r&&c.push(r),u.length>0&&c.push(...u),c.length>0?t.fieldMask=c.join(","):delete t.fieldMask}else delete t.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?t.fieldMask=s.join(","):delete t.fieldMask;return t}class Rv extends Ye{constructor(e){super(),this.apiClient=e}async create(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=bv(this.apiClient,e);r=F("auth_tokens",u._url),a=u._query,delete u.config,delete u._url,delete u._query;const c=Pv(u,e.config);return s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>d)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mv(t,e){const n={},o=i(t,["force"]);return e!==void 0&&o!=null&&l(e,["_query","force"],o),n}function Dv(t){const e={},n=i(t,["name"]);n!=null&&l(e,["_url","name"],n);const o=i(t,["config"]);return o!=null&&Mv(o,e),e}function Uv(t){const e={},n=i(t,["name"]);return n!=null&&l(e,["_url","name"],n),e}function Fv(t,e){const n={},o=i(t,["pageSize"]);e!==void 0&&o!=null&&l(e,["_query","pageSize"],o);const s=i(t,["pageToken"]);return e!==void 0&&s!=null&&l(e,["_query","pageToken"],s),n}function Lv(t){const e={},n=i(t,["parent"]);n!=null&&l(e,["_url","parent"],n);const o=i(t,["config"]);return o!=null&&Fv(o,e),e}function Gv(t){const e={},n=i(t,["sdkHttpResponse"]);n!=null&&l(e,["sdkHttpResponse"],n);const o=i(t,["nextPageToken"]);o!=null&&l(e,["nextPageToken"],o);const s=i(t,["documents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(a=>a)),l(e,["documents"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qv extends Ye{constructor(e){super(),this.apiClient=e,this.list=async n=>new Pt(We.PAGED_ITEM_DOCUMENTS,o=>this.listInternal({parent:n.parent,config:o.config}),await this.listInternal(n),n)}async get(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Uv(e);return r=F("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,o;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Dv(e);s=F("{name}",a._url),r=a._query,delete a._url,delete a._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Lv(e);return r=F("{parent}/documents",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Gv(c),f=new vp;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vv extends Ye{constructor(e,n=new qv(e)){super(),this.apiClient=e,this.documents=n,this.list=async(o={})=>new Pt(We.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(o),o)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Ay(e);return r=F("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async get(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=My(e);return r=F("{name}",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>c)}}async delete(e){var n,o;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Ry(e);s=F("{name}",a._url),r=a._query,delete a._url,delete a._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=qy(e);return r=F("fileSearchStores",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Vy(c),f=new xp;return Object.assign(f,d),f})}}async uploadToFileSearchStoreInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Hy(e);return r=F("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=By(c),f=new bp;return Object.assign(f,d),f})}}async importFile(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=Fy(e);return r=F("{file_search_store_name}:importFile",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json()),s.then(c=>{const d=Uy(c),f=new hr;return Object.assign(f,d),f})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let wu=function(){const{crypto:t}=globalThis;if(t!=null&&t.randomUUID)return wu=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,o=>(+o^n()&15>>+o/4).toString(16))};const Hv=()=>wu();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $s(t){return typeof t=="object"&&t!==null&&("name"in t&&t.name==="AbortError"||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const Os=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null){try{if(Object.prototype.toString.call(t)==="[object Error]"){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Te extends Error{}class ve extends Te{constructor(e,n,o,s){super(`${ve.makeMessage(e,n,o)}`),this.status=e,this.headers=s,this.error=n}static makeMessage(e,n,o){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):o;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,o,s){if(!e||!s)return new Vo({message:o,cause:Os(n)});const r=n;return e===400?new Tu(e,r,o,s):e===401?new Su(e,r,o,s):e===403?new Eu(e,r,o,s):e===404?new Iu(e,r,o,s):e===409?new ku(e,r,o,s):e===422?new Nu(e,r,o,s):e===429?new Au(e,r,o,s):e>=500?new Pu(e,r,o,s):new ve(e,r,o,s)}}class Ks extends ve{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Vo extends ve{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class Cu extends Vo{constructor({message:e}={}){super({message:e??"Request timed out."})}}class Tu extends ve{}class Su extends ve{}class Eu extends ve{}class Iu extends ve{}class ku extends ve{}class Nu extends ve{}class Au extends ve{}class Pu extends ve{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bv=/^[a-z][a-z0-9+.-]*:/i,$v=t=>Bv.test(t);let Js=t=>(Js=Array.isArray,Js(t));const Ov=Js;let Kv=Ov;const Da=Kv;function Jv(t){if(!t)return!0;for(const e in t)return!1;return!0}function zv(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const jv=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Te(`${t} must be an integer`);if(e<0)throw new Te(`${t} must be a positive integer`);return e},Wv=t=>{try{return JSON.parse(t)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yv=t=>new Promise(e=>setTimeout(e,t));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ut="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qv(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Xv=()=>{var t,e,n,o,s;const r=Qv();if(r==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ut,"X-Stainless-OS":Fa(Deno.build.os),"X-Stainless-Arch":Ua(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(t=Deno.version)===null||t===void 0?void 0:t.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ut,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(r==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ut,"X-Stainless-OS":Fa((n=globalThis.process.platform)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Arch":Ua((o=globalThis.process.arch)!==null&&o!==void 0?o:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(s=globalThis.process.version)!==null&&s!==void 0?s:"unknown"};const a=Zv();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ut,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ut,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Zv(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const o=n.exec(navigator.userAgent);if(o){const s=o[1]||0,r=o[2]||0,a=o[3]||0;return{browser:e,version:`${s}.${r}.${a}`}}}return null}const Ua=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",Fa=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Jn;const ex=()=>Jn??(Jn=Xv());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tx(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Ru(...t){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function nx(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return Ru({start(){},async pull(n){const{done:o,value:s}=await e.next();o?n.close():n.enqueue(s)},async cancel(){var n;await((n=e.return)===null||n===void 0?void 0:n.call(e))}})}function Mu(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function ox(t){var e,n;if(t===null||typeof t!="object")return;if(t[Symbol.asyncIterator]){await((n=(e=t[Symbol.asyncIterator]()).return)===null||n===void 0?void 0:n.call(e));return}const o=t.getReader(),s=o.cancel();o.releaseLock(),await s}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sx=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Du=()=>{var t;if(typeof File>"u"){const{process:e}=globalThis,n=typeof((t=e==null?void 0:e.versions)===null||t===void 0?void 0:t.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(n?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function es(t,e,n){return Du(),new File(t,e??"unknown_file",n)}function rx(t){return(typeof t=="object"&&t!==null&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const ix=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Uu=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",ax=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Uu(t),lx=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function";async function ux(t,e,n){if(Du(),t=await t,ax(t))return t instanceof File?t:es([await t.arrayBuffer()],t.name);if(lx(t)){const s=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),es(await zs(s),e,n)}const o=await zs(t);if(e||(e=rx(t)),!(n!=null&&n.type)){const s=o.find(r=>typeof r=="object"&&"type"in r&&r.type);typeof s=="string"&&(n=Object.assign(Object.assign({},n),{type:s}))}return es(o,e,n)}async function zs(t){var e,n,o,s,r;let a=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)a.push(t);else if(Uu(t))a.push(t instanceof Blob?t:await t.arrayBuffer());else if(ix(t))try{for(var u=!0,c=Pe(t),d;d=await c.next(),e=d.done,!e;u=!0){s=d.value,u=!1;const f=s;a.push(...await zs(f))}}catch(f){n={error:f}}finally{try{!u&&!e&&(o=c.return)&&await o.call(c)}finally{if(n)throw n.error}}else{const f=(r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name;throw new Error(`Unexpected data type: ${typeof t}${f?`; constructor: ${f}`:""}${cx(t)}`)}return a}function cx(t){return typeof t!="object"||t===null?"":`; props: [${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Fu{constructor(e){this._client=e}}Fu._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lu(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const La=Object.freeze(Object.create(null)),dx=(t=Lu)=>function(n,...o){if(n.length===1)return n[0];let s=!1;const r=[],a=n.reduce((f,m,p)=>{var g,v,y;/[?#]/.test(m)&&(s=!0);const x=o[p];let b=(s?encodeURIComponent:t)(""+x);return p!==o.length&&(x==null||typeof x=="object"&&x.toString===((y=Object.getPrototypeOf((v=Object.getPrototypeOf((g=x.hasOwnProperty)!==null&&g!==void 0?g:La))!==null&&v!==void 0?v:La))===null||y===void 0?void 0:y.toString))&&(b=x+"",r.push({start:f.length+m.length,length:b.length,error:`Value of type ${Object.prototype.toString.call(x).slice(8,-1)} is not a valid path parameter`})),f+m+(p===o.length?"":b)},""),u=a.split(/[?#]/,1)[0],c=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=c.exec(u))!==null;)r.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(r.sort((f,m)=>f.start-m.start),r.length>0){let f=0;const m=r.reduce((p,g)=>{const v=" ".repeat(g.start-f),y="^".repeat(g.length);return f=g.start+g.length,p+v+y},"");throw new Te(`Path parameters result in path with invalid segments:
${r.map(p=>p.error).join(`
`)}
${a}
${m}`)}return a},zn=dx(Lu);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gu extends Fu{create(e,n){var o;const{api_version:s=this._client.apiVersion}=e,r=Eo(e,["api_version"]);if("model"in r&&"agent_config"in r)throw new Te("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in r&&"generation_config"in r)throw new Te("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(zn`/${s}/interactions`,Object.assign(Object.assign({body:r},n),{stream:(o=e.stream)!==null&&o!==void 0?o:!1}))}delete(e,n={},o){const{api_version:s=this._client.apiVersion}=n??{};return this._client.delete(zn`/${s}/interactions/${e}`,o)}cancel(e,n={},o){const{api_version:s=this._client.apiVersion}=n??{};return this._client.post(zn`/${s}/interactions/${e}/cancel`,o)}get(e,n={},o){var s;const r=n??{},{api_version:a=this._client.apiVersion}=r,u=Eo(r,["api_version"]);return this._client.get(zn`/${a}/interactions/${e}`,Object.assign(Object.assign({query:u},o),{stream:(s=n==null?void 0:n.stream)!==null&&s!==void 0?s:!1}))}}Gu._key=Object.freeze(["interactions"]);class qu extends Gu{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fx(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let o=0;for(const s of t)n.set(s,o),o+=s.length;return n}let jn;function br(t){let e;return(jn??(e=new globalThis.TextEncoder,jn=e.encode.bind(e)))(t)}let Wn;function Ga(t){let e;return(Wn??(e=new globalThis.TextDecoder,Wn=e.decode.bind(e)))(t)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ho{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?br(e):e;this.buffer=fx([this.buffer,n]);const o=[];let s;for(;(s=hx(this.buffer,this.carriageReturnIndex))!=null;){if(s.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=s.index;continue}if(this.carriageReturnIndex!=null&&(s.index!==this.carriageReturnIndex+1||s.carriage)){o.push(Ga(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const r=this.carriageReturnIndex!==null?s.preceding-1:s.preceding,a=Ga(this.buffer.subarray(0,r));o.push(a),this.buffer=this.buffer.subarray(s.index),this.carriageReturnIndex=null}return o}flush(){return this.buffer.length?this.decode(`
`):[]}}Ho.NEWLINE_CHARS=new Set([`
`,"\r"]);Ho.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function hx(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function px(t){for(let o=0;o<t.length-1;o++){if(t[o]===10&&t[o+1]===10||t[o]===13&&t[o+1]===13)return o+2;if(t[o]===13&&t[o+1]===10&&o+3<t.length&&t[o+2]===13&&t[o+3]===10)return o+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Io={off:0,error:200,warn:300,info:400,debug:500},qa=(t,e,n)=>{if(t){if(zv(Io,t))return t;he(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Io))}`)}};function fn(){}function Yn(t,e,n){return!e||Io[t]>Io[n]?fn:e[t].bind(e)}const mx={error:fn,warn:fn,info:fn,debug:fn};let Va=new WeakMap;function he(t){var e;const n=t.logger,o=(e=t.logLevel)!==null&&e!==void 0?e:"off";if(!n)return mx;const s=Va.get(n);if(s&&s[0]===o)return s[1];const r={error:Yn("error",n,o),warn:Yn("warn",n,o),info:Yn("info",n,o),debug:Yn("debug",n,o)};return Va.set(n,[o,r]),r}const yt=t=>(t.options&&(t.options=Object.assign({},t.options),delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([e,n])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Lt{constructor(e,n,o){this.iterator=e,this.controller=n,this.client=o}static fromSSEResponse(e,n,o){let s=!1;const r=o?he(o):console;function a(){return Ae(this,arguments,function*(){var c,d,f,m;if(s)throw new Te("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let p=!1;try{try{for(var g=!0,v=Pe(gx(e,n)),y;y=yield J(v.next()),c=y.done,!c;g=!0){m=y.value,g=!1;const x=m;if(!p)if(x.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield J(JSON.parse(x.data))}catch(b){throw r.error("Could not parse message into JSON:",x.data),r.error("From chunk:",x.raw),b}}}catch(x){d={error:x}}finally{try{!g&&!c&&(f=v.return)&&(yield J(f.call(v)))}finally{if(d)throw d.error}}p=!0}catch(x){if($s(x))return yield J(void 0);throw x}finally{p||n.abort()}})}return new Lt(a,n,o)}static fromReadableStream(e,n,o){let s=!1;function r(){return Ae(this,arguments,function*(){var c,d,f,m;const p=new Ho,g=Mu(e);try{for(var v=!0,y=Pe(g),x;x=yield J(y.next()),c=x.done,!c;v=!0){m=x.value,v=!1;const b=m;for(const _ of p.decode(b))yield yield J(_)}}catch(b){d={error:b}}finally{try{!v&&!c&&(f=y.return)&&(yield J(f.call(y)))}finally{if(d)throw d.error}}for(const b of p.flush())yield yield J(b)})}function a(){return Ae(this,arguments,function*(){var c,d,f,m;if(s)throw new Te("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");s=!0;let p=!1;try{try{for(var g=!0,v=Pe(r()),y;y=yield J(v.next()),c=y.done,!c;g=!0){m=y.value,g=!1;const x=m;p||x&&(yield yield J(JSON.parse(x)))}}catch(x){d={error:x}}finally{try{!g&&!c&&(f=v.return)&&(yield J(f.call(v)))}finally{if(d)throw d.error}}p=!0}catch(x){if($s(x))return yield J(void 0);throw x}finally{p||n.abort()}})}return new Lt(a,n,o)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],o=this.iterator(),s=r=>({next:()=>{if(r.length===0){const a=o.next();e.push(a),n.push(a)}return r.shift()}});return[new Lt(()=>s(e),this.controller,this.client),new Lt(()=>s(n),this.controller,this.client)]}toReadableStream(){const e=this;let n;return Ru({async start(){n=e[Symbol.asyncIterator]()},async pull(o){try{const{value:s,done:r}=await n.next();if(r)return o.close();const a=br(JSON.stringify(s)+`
`);o.enqueue(a)}catch(s){o.error(s)}},async cancel(){var o;await((o=n.return)===null||o===void 0?void 0:o.call(n))}})}}function gx(t,e){return Ae(this,arguments,function*(){var o,s,r,a;if(!t.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Te("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Te("Attempted to iterate over a response with no body");const u=new vx,c=new Ho,d=Mu(t.body);try{for(var f=!0,m=Pe(yx(d)),p;p=yield J(m.next()),o=p.done,!o;f=!0){a=p.value,f=!1;const g=a;for(const v of c.decode(g)){const y=u.decode(v);y&&(yield yield J(y))}}}catch(g){s={error:g}}finally{try{!f&&!o&&(r=m.return)&&(yield J(r.call(m)))}finally{if(s)throw s.error}}for(const g of c.flush()){const v=u.decode(g);v&&(yield yield J(v))}})}function yx(t){return Ae(this,arguments,function*(){var n,o,s,r;let a=new Uint8Array;try{for(var u=!0,c=Pe(t),d;d=yield J(c.next()),n=d.done,!n;u=!0){r=d.value,u=!1;const f=r;if(f==null)continue;const m=f instanceof ArrayBuffer?new Uint8Array(f):typeof f=="string"?br(f):f;let p=new Uint8Array(a.length+m.length);p.set(a),p.set(m,a.length),a=p;let g;for(;(g=px(a))!==-1;)yield yield J(a.slice(0,g)),a=a.slice(g)}}catch(f){o={error:f}}finally{try{!u&&!n&&(s=c.return)&&(yield J(s.call(c)))}finally{if(o)throw o.error}}a.length>0&&(yield yield J(a))})}class vx{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const r={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],r}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,o,s]=xx(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function xx(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function bx(t,e){const{response:n,requestLogID:o,retryOfRequestLogID:s,startTime:r}=e,a=await(async()=>{var u;if(e.options.stream)return he(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Lt.fromSSEResponse(n,e.controller,t);if(n.status===204)return null;if(e.options.__binaryResponse)return n;const c=n.headers.get("content-type"),d=(u=c==null?void 0:c.split(";")[0])===null||u===void 0?void 0:u.trim();return(d==null?void 0:d.includes("application/json"))||(d==null?void 0:d.endsWith("+json"))?await n.json():await n.text()})();return he(t).debug(`[${o}] response parsed`,yt({retryOfRequestLogID:s,url:n.url,status:n.status,body:a,durationMs:Date.now()-r})),a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _r extends Promise{constructor(e,n,o=bx){super(s=>{s(null)}),this.responsePromise=n,this.parseResponse=o,this.client=e}_thenUnwrap(e){return new _r(this.client,this.responsePromise,async(n,o)=>e(await this.parseResponse(n,o),o))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Vu=Symbol("brand.privateNullableHeaders");function*_x(t){if(!t)return;if(Vu in t){const{values:o,nulls:s}=t;yield*o.entries();for(const r of s)yield[r,null];return}let e=!1,n;t instanceof Headers?n=t.entries():Da(t)?n=t:(e=!0,n=Object.entries(t??{}));for(let o of n){const s=o[0];if(typeof s!="string")throw new TypeError("expected header name to be a string");const r=Da(o[1])?o[1]:[o[1]];let a=!1;for(const u of r)u!==void 0&&(e&&!a&&(a=!0,yield[s,null]),yield[s,u])}}const un=t=>{const e=new Headers,n=new Set;for(const o of t){const s=new Set;for(const[r,a]of _x(o)){const u=r.toLowerCase();s.has(u)||(e.delete(r),s.add(u)),a===null?(e.delete(r),n.add(u)):(e.append(r,a),n.delete(u))}}return{[Vu]:!0,values:e,nulls:n}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ts=t=>{var e,n,o,s,r,a;if(typeof globalThis.process<"u")return(o=(n=(e=zh)===null||e===void 0?void 0:e[t])===null||n===void 0?void 0:n.trim())!==null&&o!==void 0?o:void 0;if(typeof globalThis.Deno<"u")return(a=(r=(s=globalThis.Deno.env)===null||s===void 0?void 0:s.get)===null||r===void 0?void 0:r.call(s,t))===null||a===void 0?void 0:a.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hu;class Bo{constructor(e){var n,o,s,r,a,u,c,{baseURL:d=ts("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:f=(n=ts("GEMINI_API_KEY"))!==null&&n!==void 0?n:null,apiVersion:m="v1beta"}=e,p=Eo(e,["baseURL","apiKey","apiVersion"]);const g=Object.assign(Object.assign({apiKey:f,apiVersion:m},p),{baseURL:d||"https://generativelanguage.googleapis.com"});this.baseURL=g.baseURL,this.timeout=(o=g.timeout)!==null&&o!==void 0?o:Bo.DEFAULT_TIMEOUT,this.logger=(s=g.logger)!==null&&s!==void 0?s:console;const v="warn";this.logLevel=v,this.logLevel=(a=(r=qa(g.logLevel,"ClientOptions.logLevel",this))!==null&&r!==void 0?r:qa(ts("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&a!==void 0?a:v,this.fetchOptions=g.fetchOptions,this.maxRetries=(u=g.maxRetries)!==null&&u!==void 0?u:2,this.fetch=(c=g.fetch)!==null&&c!==void 0?c:tx(),this.encoder=sx,this._options=g,this.apiKey=f,this.apiVersion=m,this.clientAdapter=g.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:n}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!n.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const n=un([e.headers]);if(!(n.values.has("authorization")||n.values.has("x-goog-api-key"))){if(this.apiKey)return un([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return un([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([n,o])=>typeof o<"u").map(([n,o])=>{if(typeof o=="string"||typeof o=="number"||typeof o=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(o)}`;if(o===null)return`${encodeURIComponent(n)}=`;throw new Te(`Cannot stringify type ${typeof o}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Ut}`}defaultIdempotencyKey(){return`stainless-node-retry-${Hv()}`}makeStatusError(e,n,o,s){return ve.generate(e,n,o,s)}buildURL(e,n,o){const s=!this.baseURLOverridden()&&o||this.baseURL,r=$v(e)?new URL(e):new URL(s+(s.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return Jv(a)||(n=Object.assign(Object.assign({},a),n)),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const n=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${n}`}}async prepareRequest(e,{url:n,options:o}){}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,o){return this.request(Promise.resolve(o).then(s=>Object.assign({method:e,path:n},s)))}request(e,n=null){return new _r(this,this.makeRequest(e,n,void 0))}async makeRequest(e,n,o){var s,r,a;const u=await e,c=(s=u.maxRetries)!==null&&s!==void 0?s:this.maxRetries;n==null&&(n=c),await this.prepareOptions(u);const{req:d,url:f,timeout:m}=await this.buildRequest(u,{retryCount:c-n});await this.prepareRequest(d,{url:f,options:u});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),g=o===void 0?"":`, retryOf: ${o}`,v=Date.now();if(he(this).debug(`[${p}] sending request`,yt({retryOfRequestLogID:o,method:u.method,url:f,options:u,headers:d.headers})),!((r=u.signal)===null||r===void 0)&&r.aborted)throw new Ks;const y=new AbortController,x=await this.fetchWithTimeout(f,d,m,y).catch(Os),b=Date.now();if(x instanceof globalThis.Error){const w=`retrying, ${n} attempts remaining`;if(!((a=u.signal)===null||a===void 0)&&a.aborted)throw new Ks;const C=$s(x)||/timed? ?out/i.test(String(x)+("cause"in x?String(x.cause):""));if(n)return he(this).info(`[${p}] connection ${C?"timed out":"failed"} - ${w}`),he(this).debug(`[${p}] connection ${C?"timed out":"failed"} (${w})`,yt({retryOfRequestLogID:o,url:f,durationMs:b-v,message:x.message})),this.retryRequest(u,n,o??p);throw he(this).info(`[${p}] connection ${C?"timed out":"failed"} - error; no more retries left`),he(this).debug(`[${p}] connection ${C?"timed out":"failed"} (error; no more retries left)`,yt({retryOfRequestLogID:o,url:f,durationMs:b-v,message:x.message})),C?new Cu:new Vo({cause:x})}const _=`[${p}${g}] ${d.method} ${f} ${x.ok?"succeeded":"failed"} with status ${x.status} in ${b-v}ms`;if(!x.ok){const w=await this.shouldRetry(x);if(n&&w){const E=`retrying, ${n} attempts remaining`;return await ox(x.body),he(this).info(`${_} - ${E}`),he(this).debug(`[${p}] response error (${E})`,yt({retryOfRequestLogID:o,url:x.url,status:x.status,headers:x.headers,durationMs:b-v})),this.retryRequest(u,n,o??p,x.headers)}const C=w?"error; no more retries left":"error; not retryable";he(this).info(`${_} - ${C}`);const I=await x.text().catch(E=>Os(E).message),k=Wv(I),T=k?void 0:I;throw he(this).debug(`[${p}] response error (${C})`,yt({retryOfRequestLogID:o,url:x.url,status:x.status,headers:x.headers,message:T,durationMs:Date.now()-v})),this.makeStatusError(x.status,k,T,x.headers)}return he(this).info(_),he(this).debug(`[${p}] response start`,yt({retryOfRequestLogID:o,url:x.url,status:x.status,headers:x.headers,durationMs:b-v})),{response:x,options:u,controller:y,requestLogID:p,retryOfRequestLogID:o,startTime:v}}async fetchWithTimeout(e,n,o,s){const r=n||{},{signal:a,method:u}=r,c=Eo(r,["signal","method"]);a&&a.addEventListener("abort",()=>s.abort());const d=setTimeout(()=>s.abort(),o),f=globalThis.ReadableStream&&c.body instanceof globalThis.ReadableStream||typeof c.body=="object"&&c.body!==null&&Symbol.asyncIterator in c.body,m=Object.assign(Object.assign(Object.assign({signal:s.signal},f?{duplex:"half"}:{}),{method:"GET"}),c);u&&(m.method=u.toUpperCase());try{return await this.fetch.call(void 0,e,m)}finally{clearTimeout(d)}}async shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,o,s){var r;let a;const u=s==null?void 0:s.get("retry-after-ms");if(u){const d=parseFloat(u);Number.isNaN(d)||(a=d)}const c=s==null?void 0:s.get("retry-after");if(c&&!a){const d=parseFloat(c);Number.isNaN(d)?a=Date.parse(c)-Date.now():a=d*1e3}if(!(a&&0<=a&&a<60*1e3)){const d=(r=e.maxRetries)!==null&&r!==void 0?r:this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(n,d)}return await Yv(a),this.makeRequest(e,n-1,o)}calculateDefaultRetryTimeoutMillis(e,n){const r=n-e,a=Math.min(.5*Math.pow(2,r),8),u=1-Math.random()*.25;return a*u*1e3}async buildRequest(e,{retryCount:n=0}={}){var o,s,r;const a=Object.assign({},e),{method:u,path:c,query:d,defaultBaseURL:f}=a,m=this.buildURL(c,d,f);"timeout"in a&&jv("timeout",a.timeout),a.timeout=(o=a.timeout)!==null&&o!==void 0?o:this.timeout;const{bodyHeaders:p,body:g}=this.buildBody({options:a}),v=await this.buildHeaders({options:e,method:u,bodyHeaders:p,retryCount:n});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:u,headers:v},a.signal&&{signal:a.signal}),globalThis.ReadableStream&&g instanceof globalThis.ReadableStream&&{duplex:"half"}),g&&{body:g}),(s=this.fetchOptions)!==null&&s!==void 0?s:{}),(r=a.fetchOptions)!==null&&r!==void 0?r:{}),url:m,timeout:a.timeout}}async buildHeaders({options:e,method:n,bodyHeaders:o,retryCount:s}){let r={};this.idempotencyHeader&&n!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey);const a=await this.authHeaders(e);let u=un([r,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(s)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),ex()),this._options.defaultHeaders,o,e.headers,a]);return this.validateHeaders(u),u.values}buildBody({options:{body:e,headers:n}}){if(!e)return{bodyHeaders:void 0,body:void 0};const o=un([n]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&o.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:nx(e)}:this.encoder({body:e,headers:o})}}Bo.DEFAULT_TIMEOUT=6e4;class ae extends Bo{constructor(){super(...arguments),this.interactions=new qu(this)}}Hu=ae;ae.GeminiNextGenAPIClient=Hu;ae.GeminiNextGenAPIClientError=Te;ae.APIError=ve;ae.APIConnectionError=Vo;ae.APIConnectionTimeoutError=Cu;ae.APIUserAbortError=Ks;ae.NotFoundError=Iu;ae.ConflictError=ku;ae.RateLimitError=Au;ae.BadRequestError=Tu;ae.AuthenticationError=Su;ae.InternalServerError=Pu;ae.PermissionDeniedError=Eu;ae.UnprocessableEntityError=Nu;ae.toFile=ux;ae.Interactions=qu;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wx(t,e){const n={},o=i(t,["name"]);return o!=null&&l(n,["_url","name"],o),n}function Cx(t,e){const n={},o=i(t,["name"]);return o!=null&&l(n,["_url","name"],o),n}function Tx(t,e){const n={},o=i(t,["sdkHttpResponse"]);return o!=null&&l(n,["sdkHttpResponse"],o),n}function Sx(t,e){const n={},o=i(t,["sdkHttpResponse"]);return o!=null&&l(n,["sdkHttpResponse"],o),n}function Ex(t,e,n){const o={};if(i(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=i(t,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&l(e,["displayName"],s),i(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=i(t,["epochCount"]);e!==void 0&&r!=null&&l(e,["tuningTask","hyperparameters","epochCount"],r);const a=i(t,["learningRateMultiplier"]);if(a!=null&&l(o,["tuningTask","hyperparameters","learningRateMultiplier"],a),i(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(i(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(i(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const u=i(t,["batchSize"]);e!==void 0&&u!=null&&l(e,["tuningTask","hyperparameters","batchSize"],u);const c=i(t,["learningRate"]);if(e!==void 0&&c!=null&&l(e,["tuningTask","hyperparameters","learningRate"],c),i(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(i(t,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return o}function Ix(t,e,n){const o={};let s=i(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const g=i(t,["validationDataset"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec"],Ha(g))}else if(s==="PREFERENCE_TUNING"){const g=i(t,["validationDataset"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec"],Ha(g))}const r=i(t,["tunedModelDisplayName"]);e!==void 0&&r!=null&&l(e,["tunedModelDisplayName"],r);const a=i(t,["description"]);e!==void 0&&a!=null&&l(e,["description"],a);let u=i(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const g=i(t,["epochCount"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","hyperParameters","epochCount"],g)}else if(u==="PREFERENCE_TUNING"){const g=i(t,["epochCount"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],g)}let c=i(n,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const g=i(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],g)}else if(c==="PREFERENCE_TUNING"){const g=i(t,["learningRateMultiplier"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],g)}let d=i(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const g=i(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","exportLastCheckpointOnly"],g)}else if(d==="PREFERENCE_TUNING"){const g=i(t,["exportLastCheckpointOnly"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],g)}let f=i(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const g=i(t,["adapterSize"]);e!==void 0&&g!=null&&l(e,["supervisedTuningSpec","hyperParameters","adapterSize"],g)}else if(f==="PREFERENCE_TUNING"){const g=i(t,["adapterSize"]);e!==void 0&&g!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],g)}if(i(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(i(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const m=i(t,["labels"]);e!==void 0&&m!=null&&l(e,["labels"],m);const p=i(t,["beta"]);return e!==void 0&&p!=null&&l(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),o}function kx(t,e){const n={},o=i(t,["baseModel"]);o!=null&&l(n,["baseModel"],o);const s=i(t,["preTunedModel"]);s!=null&&l(n,["preTunedModel"],s);const r=i(t,["trainingDataset"]);r!=null&&qx(r);const a=i(t,["config"]);return a!=null&&Ex(a,n),n}function Nx(t,e){const n={},o=i(t,["baseModel"]);o!=null&&l(n,["baseModel"],o);const s=i(t,["preTunedModel"]);s!=null&&l(n,["preTunedModel"],s);const r=i(t,["trainingDataset"]);r!=null&&Vx(r,n,e);const a=i(t,["config"]);return a!=null&&Ix(a,n,e),n}function Ax(t,e){const n={},o=i(t,["name"]);return o!=null&&l(n,["_url","name"],o),n}function Px(t,e){const n={},o=i(t,["name"]);return o!=null&&l(n,["_url","name"],o),n}function Rx(t,e,n){const o={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const r=i(t,["pageToken"]);e!==void 0&&r!=null&&l(e,["_query","pageToken"],r);const a=i(t,["filter"]);return e!==void 0&&a!=null&&l(e,["_query","filter"],a),o}function Mx(t,e,n){const o={},s=i(t,["pageSize"]);e!==void 0&&s!=null&&l(e,["_query","pageSize"],s);const r=i(t,["pageToken"]);e!==void 0&&r!=null&&l(e,["_query","pageToken"],r);const a=i(t,["filter"]);return e!==void 0&&a!=null&&l(e,["_query","filter"],a),o}function Dx(t,e){const n={},o=i(t,["config"]);return o!=null&&Rx(o,n),n}function Ux(t,e){const n={},o=i(t,["config"]);return o!=null&&Mx(o,n),n}function Fx(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&l(n,["sdkHttpResponse"],o);const s=i(t,["nextPageToken"]);s!=null&&l(n,["nextPageToken"],s);const r=i(t,["tunedModels"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>Bu(u))),l(n,["tuningJobs"],a)}return n}function Lx(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&l(n,["sdkHttpResponse"],o);const s=i(t,["nextPageToken"]);s!=null&&l(n,["nextPageToken"],s);const r=i(t,["tuningJobs"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(u=>js(u))),l(n,["tuningJobs"],a)}return n}function Gx(t,e){const n={},o=i(t,["name"]);o!=null&&l(n,["model"],o);const s=i(t,["name"]);return s!=null&&l(n,["endpoint"],s),n}function qx(t,e){const n={};if(i(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(i(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const o=i(t,["examples"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(r=>r)),l(n,["examples","examples"],s)}return n}function Vx(t,e,n){const o={};let s=i(n,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const a=i(t,["gcsUri"]);e!==void 0&&a!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(s==="PREFERENCE_TUNING"){const a=i(t,["gcsUri"]);e!==void 0&&a!=null&&l(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let r=i(n,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const a=i(t,["vertexDatasetResource"]);e!==void 0&&a!=null&&l(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(r==="PREFERENCE_TUNING"){const a=i(t,["vertexDatasetResource"]);e!==void 0&&a!=null&&l(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(i(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return o}function Bu(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&l(n,["sdkHttpResponse"],o);const s=i(t,["name"]);s!=null&&l(n,["name"],s);const r=i(t,["state"]);r!=null&&l(n,["state"],su(r));const a=i(t,["createTime"]);a!=null&&l(n,["createTime"],a);const u=i(t,["tuningTask","startTime"]);u!=null&&l(n,["startTime"],u);const c=i(t,["tuningTask","completeTime"]);c!=null&&l(n,["endTime"],c);const d=i(t,["updateTime"]);d!=null&&l(n,["updateTime"],d);const f=i(t,["description"]);f!=null&&l(n,["description"],f);const m=i(t,["baseModel"]);m!=null&&l(n,["baseModel"],m);const p=i(t,["_self"]);return p!=null&&l(n,["tunedModel"],Gx(p)),n}function js(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&l(n,["sdkHttpResponse"],o);const s=i(t,["name"]);s!=null&&l(n,["name"],s);const r=i(t,["state"]);r!=null&&l(n,["state"],su(r));const a=i(t,["createTime"]);a!=null&&l(n,["createTime"],a);const u=i(t,["startTime"]);u!=null&&l(n,["startTime"],u);const c=i(t,["endTime"]);c!=null&&l(n,["endTime"],c);const d=i(t,["updateTime"]);d!=null&&l(n,["updateTime"],d);const f=i(t,["error"]);f!=null&&l(n,["error"],f);const m=i(t,["description"]);m!=null&&l(n,["description"],m);const p=i(t,["baseModel"]);p!=null&&l(n,["baseModel"],p);const g=i(t,["tunedModel"]);g!=null&&l(n,["tunedModel"],g);const v=i(t,["preTunedModel"]);v!=null&&l(n,["preTunedModel"],v);const y=i(t,["supervisedTuningSpec"]);y!=null&&l(n,["supervisedTuningSpec"],y);const x=i(t,["preferenceOptimizationSpec"]);x!=null&&l(n,["preferenceOptimizationSpec"],x);const b=i(t,["tuningDataStats"]);b!=null&&l(n,["tuningDataStats"],b);const _=i(t,["encryptionSpec"]);_!=null&&l(n,["encryptionSpec"],_);const w=i(t,["partnerModelTuningSpec"]);w!=null&&l(n,["partnerModelTuningSpec"],w);const C=i(t,["customBaseModel"]);C!=null&&l(n,["customBaseModel"],C);const I=i(t,["experiment"]);I!=null&&l(n,["experiment"],I);const k=i(t,["labels"]);k!=null&&l(n,["labels"],k);const T=i(t,["outputUri"]);T!=null&&l(n,["outputUri"],T);const U=i(t,["pipelineJob"]);U!=null&&l(n,["pipelineJob"],U);const E=i(t,["serviceAccount"]);E!=null&&l(n,["serviceAccount"],E);const R=i(t,["tunedModelDisplayName"]);R!=null&&l(n,["tunedModelDisplayName"],R);const A=i(t,["veoTuningSpec"]);return A!=null&&l(n,["veoTuningSpec"],A),n}function Hx(t,e){const n={},o=i(t,["sdkHttpResponse"]);o!=null&&l(n,["sdkHttpResponse"],o);const s=i(t,["name"]);s!=null&&l(n,["name"],s);const r=i(t,["metadata"]);r!=null&&l(n,["metadata"],r);const a=i(t,["done"]);a!=null&&l(n,["done"],a);const u=i(t,["error"]);return u!=null&&l(n,["error"],u),n}function Ha(t,e){const n={},o=i(t,["gcsUri"]);o!=null&&l(n,["validationDatasetUri"],o);const s=i(t,["vertexDatasetResource"]);return s!=null&&l(n,["validationDatasetUri"],s),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bx extends Ye{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new Pt(We.PAGED_ITEM_TUNING_JOBS,o=>this.listInternal(o),await this.listInternal(n),n),this.get=async n=>await this.getInternal(n),this.tune=async n=>{var o;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const s={tunedModelName:n.baseModel};!((o=n.config)===null||o===void 0)&&o.preTunedModelCheckpointId&&(s.checkpointId=n.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},n),{preTunedModel:s});return r.baseModel=void 0,await this.tuneInternal(r)}else{const s=Object.assign({},n);return await this.tuneInternal(s)}else{const s=Object.assign({},n),r=await this.tuneMldevInternal(s);let a="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?a=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(a=r.name.split("/operations/")[0]),{name:a,state:Fs.JOB_STATE_QUEUED}}}}async getInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Px(e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>js(f))}else{const d=Ax(e);return u=F("{name}",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>Bu(f))}}async listInternal(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Ux(e);return u=F("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Lx(f),p=new ha;return Object.assign(p,m),p})}else{const d=Dx(e);return u=F("tunedModels",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Fx(f),p=new ha;return Object.assign(p,m),p})}}async cancel(e){var n,o,s,r;let a,u="",c={};if(this.apiClient.isVertexAI()){const d=Cx(e);return u=F("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Sx(f),p=new pa;return Object.assign(p,m),p})}else{const d=wx(e);return u=F("{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,a=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json().then(m=>{const p=m;return p.sdkHttpResponse={headers:f.headers},p})),a.then(f=>{const m=Tx(f),p=new pa;return Object.assign(p,m),p})}}async tuneInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI()){const u=Nx(e,e);return r=F("tuningJobs",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>js(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,o;let s,r="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=kx(e);return r=F("tunedModels",u._url),a=u._query,delete u._url,delete u._query,s=this.apiClient.request({path:r,queryParams:a,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(c=>c.json().then(d=>{const f=d;return f.sdkHttpResponse={headers:c.headers},f})),s.then(c=>Hx(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $x{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Ox=1024*1024*8,Kx=3,Jx=1e3,zx=2,ko="x-goog-upload-status";async function jx(t,e,n){var o;const s=await $u(t,e,n),r=await(s==null?void 0:s.json());if(((o=s==null?void 0:s.headers)===null||o===void 0?void 0:o[ko])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}async function Wx(t,e,n){var o;const s=await $u(t,e,n),r=await(s==null?void 0:s.json());if(((o=s==null?void 0:s.headers)===null||o===void 0?void 0:o[ko])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const a=Xl(r),u=new pr;return Object.assign(u,a),u}async function $u(t,e,n){var o,s;let r=0,a=0,u=new Ls(new Response),c="upload";for(r=t.size;a<r;){const d=Math.min(Ox,r-a),f=t.slice(a,a+d);a+d>=r&&(c+=", finalize");let m=0,p=Jx;for(;m<Kx&&(u=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(d)}}}),!(!((o=u==null?void 0:u.headers)===null||o===void 0)&&o[ko]));)m++,await Qx(p),p=p*zx;if(a+=d,((s=u==null?void 0:u.headers)===null||s===void 0?void 0:s[ko])!=="active")break;if(r<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return u}async function Yx(t){return{size:t.size,type:t.type}}function Qx(t){return new Promise(e=>setTimeout(e,t))}class Xx{async upload(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await jx(e,n,o)}async uploadToFileSearchStore(e,n,o){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Wx(e,n,o)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Yx(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Zx{create(e,n,o){return new eb(e,n,o)}}class eb{constructor(e,n,o){this.url=e,this.headers=n,this.callbacks=o}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ba="x-goog-api-key";class tb{constructor(e){this.apiKey=e}async addAuthHeaders(e,n){if(e.get(Ba)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Ba,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nb="gl-node/";class ob{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const n=new ae({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=n.interactions,this._interactions}constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const o=Qh(e.httpOptions,e.vertexai,void 0,void 0);o&&(e.httpOptions?e.httpOptions.baseUrl=o:e.httpOptions={baseUrl:o}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const s=new tb(this.apiKey);this.apiClient=new Yy({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:nb+"web",uploader:new Xx,downloader:new $x}),this.models=new mv(this.apiClient),this.live=new uv(this.apiClient,s,new Zx),this.batches=new Em(this.apiClient),this.chats=new ag(this.models,this.apiClient),this.caches=new sg(this.apiClient),this.files=new yg(this.apiClient),this.operations=new gv(this.apiClient),this.authTokens=new Rv(this.apiClient),this.tunings=new Bx(this.apiClient),this.fileSearchStores=new Vv(this.apiClient)}}const Ou=t=>{const e=t||void 0;return e?new ob({apiKey:e}):null},sb=async(t,e)=>{if(console.log("Generating Portfolio Summary. Supabase available:",!!X,"Manual API Key provided:",!!e),X&&!e)try{console.log("[Portfolio] Using Direct Fetch for Proxy...");const a=`${Xs}/functions/v1/gemini-proxy`,u=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${bn}`,apikey:bn},body:JSON.stringify({action:"portfolio",payload:{tasks:t}})});if(!u.ok){const d=await u.json().catch(()=>({}));throw console.error("[Portfolio] Proxy Error Details:",d),new Error(d.error||`Proxy error ${u.status}`)}const c=await u.json();return console.log("[Portfolio] Proxy Success! Received result."),c.result}catch(a){console.error("[Portfolio] Secure proxy FETCH FAILED:",a.message||a)}const n=Ou(e);if(!n)throw new Error("API Key missing. Please configure it in Admin Settings.");const r=`
    You are helping an FTC Robotics team (high school students) write their Engineering Portfolio summary.
    Write in a casual, enthusiastic voice that sounds like it was actually written BY high school students.
    Use natural student phrases like "we figured out", "it was super cool when", "our team decided", "the hardest part was", "we were really proud of".
    Avoid corporate jargon or overly formal language - keep it authentic and passionate.
    Still highlight technical achievements and problem-solving, but make it sound like excited students explaining their work to judges.
    Format the output as a bulleted Markdown summary.
    
    Tasks completed this season:
    ${t.filter(a=>a.status==="Done").map(a=>{var u;return`- ${a.title} (${a.type}): ${a.description}. Tags: ${((u=a.tags)==null?void 0:u.join(", "))||""}`}).join(`
`)}
  `;try{return(await n.models.generateContent({model:"gemini-1.5-flash",contents:r})).text||"Could not generate summary."}catch{throw new Error("AI Generation failed. Check API Key or limit.")}},rb=async(t,e,n)=>{if(X&&!n)try{console.log("[Questions] Using Direct Fetch for Proxy...");const a=`${Xs}/functions/v1/gemini-proxy`,u=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${bn}`,apikey:bn},body:JSON.stringify({action:"questions",payload:{context:t,studyGuide:e}})});if(!u.ok)throw new Error(`Proxy error ${u.status}`);const c=await u.json();console.log("[Questions] Proxy Success!");let d=c.result;const f=d.indexOf("{"),m=d.lastIndexOf("}");return f!==-1&&m!==-1&&(d=d.substring(f,m+1)),JSON.parse(d).questions||[]}catch(a){console.error("[Questions] Secure proxy FETCH FAILED:",a.message||a)}const o=Ou(n);if(!o)throw new Error("API Key missing. Please configure it in Admin Settings.");const s=`
    Create 5 potential judge interview questions and answers for an FTC Robotics team.
    Base the questions on the provided context about the team's season and robot.
    Return the response as a JSON object with a list of "questions" (each with "question" and "answer" keys).
    
    Context: ${t}
    Study Guide: ${e||"None"}
  `,r=await o.models.generateContent({model:"gemini-1.5-flash",contents:s});try{const a=(r.text||"").replace(/```json|```/g,"").trim();return JSON.parse(a).questions||[]}catch(a){return console.error("Failed to parse AI response",a),[]}},$a=({tasks:t,view:e})=>{const n=ge(q=>q.geminiApiKey),o=ge(q=>q.portfolioHistory),s=ge(q=>q.currentSeasonId),r=ge(q=>q.addPortfolioEntry),a=ge(q=>q.deletePortfolioEntry),u=o.filter(q=>!q.seasonId||q.seasonId===s),{isOnline:c}=Ql(),[d,f]=D.useState(""),[m,p]=D.useState([]),[g,v]=D.useState(!1),[y,x]=D.useState(null),[b,_]=D.useState("done"),[w,C]=D.useState(null),[I,k]=D.useState(""),[T,U]=D.useState(""),E=async()=>{v(!0),C(null);const q=b==="done"?t.filter($=>$.status==="Done"):t;try{const $=await sb(q,n||void 0);f($),r($,q.length)}catch{alert("Error generating portfolio. Please check your API Key configuration in Admin Settings.")}finally{v(!1)}},R=q=>{f(q.content),C(q.id)},A=(q,$)=>{q.stopPropagation(),a($),w===$&&(f(""),C(null))},z=q=>new Date(q).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),V=async()=>{v(!0);try{const $=await rb(d||"We built a great robot that has a high scoring autonomous and durable drivetrain.",I,n||void 0);$&&$.length>0?p($):p([{question:"Describe your robot's drivetrain.",answer:"We use a mecanum drivetrain for omnidirectional movement."},{question:"What was your biggest challenge?",answer:"Our biggest challenge was consistent intake, which we solved with a compliant wheel system."},{question:"How did you use sensors?",answer:"We use odometry pods for precise localization during autonomous."}])}catch{alert("Error generating questions. Showing demo questions instead."),p([{question:"Describe your robot's drivetrain.",answer:"We use a mecanum drivetrain for omnidirectional movement."},{question:"What was your biggest challenge?",answer:"Our biggest challenge was consistent intake, which we solved with a compliant wheel system."}])}finally{v(!1)}},j=q=>{var P;const $=(P=q.target.files)==null?void 0:P[0];if($){U($.name);const W=new FileReader;W.onload=Z=>{var S;(S=Z.target)!=null&&S.result&&k(Z.target.result)},W.readAsText($)}};return h.jsx("div",{className:"h-full flex flex-col p-2 md:p-6 max-w-5xl mx-auto w-full",children:h.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e==="portfolio"&&h.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 md:gap-6 h-full",children:[h.jsxs("div",{className:"md:col-span-1 space-y-4",children:[h.jsxs("div",{className:"bg-orange-50 dark:bg-slate-800 p-3 md:p-4 rounded-xl border border-orange-100 dark:border-slate-700",children:[h.jsx("h3",{className:"font-bold text-orange-900 dark:text-orange-400 mb-2",children:"Portfolio Helper"}),h.jsx("p",{className:"text-sm text-orange-800/80 dark:text-slate-300 mb-4",children:"The AI analyzes your tasks to create a summary of your season's technical achievements."}),h.jsxs("div",{className:"mb-4",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase block mb-2",children:"Include Tasks"}),h.jsxs("div",{className:"flex bg-white dark:bg-slate-900 rounded-lg p-1 border border-orange-100 dark:border-slate-600",children:[h.jsx("button",{onClick:()=>_("done"),className:`flex-1 py-1 text-xs font-medium rounded transition ${b==="done"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"text-slate-500 dark:text-slate-400"}`,children:"Completed Only"}),h.jsx("button",{onClick:()=>_("all"),className:`flex-1 py-1 text-xs font-medium rounded transition ${b==="all"?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"text-slate-500 dark:text-slate-400"}`,children:"All Tasks"})]})]}),h.jsxs("div",{className:"text-xs text-orange-800/60 dark:text-slate-400 font-mono bg-white/50 dark:bg-slate-900/50 p-2 rounded mb-4",children:["Tasks Analyzed: ",b==="done"?t.filter(q=>q.status==="Done").length:t.length]}),h.jsxs("button",{onClick:E,disabled:g||!c,className:"w-full bg-orange-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-orange-700 transition flex justify-center items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[g?h.jsx(us,{className:"animate-spin",size:18}):c?h.jsx(ho,{size:18}):h.jsx(uo,{size:18}),c?"Generate Summary":"Offline - AI Disabled"]}),!c&&h.jsx("p",{className:"text-[10px] text-center text-slate-500 mt-2",children:"Connecting to internet will enable AI features."})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 md:p-4 rounded-xl border border-slate-200 dark:border-slate-700",children:[h.jsxs("h3",{className:"font-bold text-slate-800 dark:text-white mb-3 flex items-center gap-2 text-sm",children:[h.jsx(fl,{size:16})," History"]}),u.length===0?h.jsx("p",{className:"text-xs text-slate-400 italic",children:"No saved summaries yet."}):h.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:u.map(q=>h.jsx("div",{onClick:()=>R(q),className:`p-2 rounded-lg cursor-pointer transition text-sm border ${w===q.id?"bg-orange-100 dark:bg-orange-900/30 border-orange-300 dark:border-orange-700":"bg-slate-50 dark:bg-slate-900 border-slate-100 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800"}`,children:h.jsxs("div",{className:"flex justify-between items-start gap-2",children:[h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:z(q.createdAt)}),h.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-300 truncate",children:[q.taskCount," tasks"]})]}),h.jsx("button",{onClick:$=>A($,q.id),className:"text-slate-400 hover:text-red-500 transition p-1 shrink-0",children:h.jsx(Ge,{size:14})})]})},q.id))})]})]}),h.jsxs("div",{className:"md:col-span-3 bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-4 md:p-6 h-full flex flex-col",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("h3",{className:"font-bold text-slate-800 dark:text-white",children:"Generated Content"}),d&&h.jsxs("button",{className:"text-xs flex items-center gap-1 text-slate-500 dark:text-slate-400 hover:text-slate-900",children:[h.jsx(fd,{size:14})," Copy MD"]})]}),h.jsx("div",{className:"flex-1 bg-slate-50 dark:bg-slate-900 rounded-lg p-4 font-mono text-sm text-slate-700 dark:text-slate-300 overflow-y-auto whitespace-pre-wrap leading-relaxed border border-slate-100 dark:border-slate-700",children:d||h.jsx("span",{className:"text-slate-400 italic",children:"Content will appear here..."})})]})]}),e==="judging"&&h.jsxs("div",{className:"flex flex-col",children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-6",children:"Judging Prep"}),h.jsxs("div",{className:"space-y-6",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-3 md:p-6 rounded-xl border border-slate-200 dark:border-slate-700",children:[h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white mb-2",children:"Study Guide & Context"}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-4",children:"Upload a text file/PDF or paste content to help the AI ask better questions."}),h.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[h.jsx("div",{className:"flex-1 relative",children:h.jsx("textarea",{className:"w-full h-24 p-3 text-sm border rounded-lg bg-slate-50 dark:bg-slate-900 border-slate-300 dark:border-slate-600 text-slate-900 dark:text-white resize-none",placeholder:"Paste technical info, robot specs, or outreach details here...",value:I,onChange:q=>k(q.target.value)})}),h.jsxs("div",{className:"w-full md:w-48 flex flex-col justify-center items-center border-2 border-dashed border-slate-300 dark:border-slate-600 rounded-lg bg-slate-50 dark:bg-slate-900 hover:bg-slate-100 dark:hover:bg-slate-800 transition cursor-pointer relative py-4 md:py-0",children:[h.jsx("input",{type:"file",onChange:j,className:"absolute inset-0 opacity-0 cursor-pointer",accept:".txt,.md,.json"}),h.jsx(ld,{className:"text-slate-400 mb-2"}),h.jsx("span",{className:"text-xs text-slate-500 font-medium text-center px-2",children:T||"Upload .txt"})]})]}),h.jsxs("div",{className:"flex justify-center flex-col items-center gap-2",children:[h.jsxs("button",{onClick:V,disabled:g||!c,className:"bg-orange-600 text-white py-2 px-6 rounded-lg text-sm font-medium hover:bg-orange-700 transition flex items-center gap-2 shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[g?h.jsx(us,{className:"animate-spin",size:16}):c?h.jsx(ho,{size:16}):h.jsx(uo,{size:16}),c?"Generate Questions":"Offline - AI Disabled"]}),!c&&h.jsx("p",{className:"text-[10px] text-slate-500",children:"AI generation requires an internet connection."})]})]}),h.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 md:gap-6 pb-4 md:pb-6",children:[m.length===0&&!g&&h.jsx("div",{className:"col-span-full text-center py-10 text-slate-400 italic",children:"No flashcards yet. Add context and click Generate."}),m.map((q,$)=>h.jsx("div",{className:"h-64 perspective-1000 cursor-pointer group",onClick:()=>x(y===$?null:$),children:h.jsxs("div",{className:`relative w-full h-full transition-all duration-500 transform-style-3d ${y===$?"rotate-y-180":""}`,children:[h.jsxs("div",{className:"absolute w-full h-full bg-white dark:bg-slate-800 rounded-xl border-2 border-slate-200 dark:border-slate-700 p-6 flex flex-col items-center justify-center text-center backface-hidden shadow-sm group-hover:border-orange-200 dark:group-hover:border-slate-500",children:[h.jsxs("span",{className:"text-xs uppercase font-bold text-orange-600 dark:text-orange-400 mb-2",children:["Question ",$+1]}),h.jsx("div",{className:"max-h-full overflow-y-auto custom-scrollbar pr-1",children:h.jsx("p",{className:"font-medium text-slate-800 dark:text-slate-100 select-none break-words",children:q.question})}),h.jsxs("div",{className:"mt-4 text-xs text-slate-400 flex items-center gap-1 shrink-0",children:["Click to reveal answer ",h.jsx(ao,{size:12})]})]}),h.jsxs("div",{className:"absolute w-full h-full bg-slate-800 dark:bg-slate-900 rounded-xl p-6 flex flex-col items-center justify-center text-center backface-hidden rotate-y-180 shadow-xl border border-slate-700",children:[h.jsx("span",{className:"text-xs uppercase font-bold text-slate-400 mb-2",children:"Suggested Answer"}),h.jsx("div",{className:"max-h-full overflow-y-auto custom-scrollbar pr-1",children:h.jsx("p",{className:"text-slate-200 dark:text-slate-300 text-sm leading-relaxed select-none break-words",children:q.answer})})]})]})},$))]})]})]})]})})},ib=({members:t,setMembers:e,teams:n,setTeams:o})=>{var $;const[s,r]=D.useState(""),[a,u]=D.useState(""),[c,d]=D.useState(""),[f,m]=D.useState(null),p=ge(P=>P.seasons),g=ge(P=>P.currentSeasonId),v=ge(P=>P.addSeason),y=ge(P=>P.updateSeason),x=ge(P=>P.deleteSeason),[b,_]=D.useState(""),[w,C]=D.useState(null),[I,k]=D.useState(""),[T,U]=D.useState(""),[E,R]=D.useState(null),A=()=>{if(s.trim()&&a.trim().length===1){const P={id:Date.now().toString(),firstName:s.trim(),lastNameInitial:a.trim().toUpperCase()};e([...t,P]),r(""),u("")}else alert("Please provide a First Name and a single letter Last Initial.")},z=P=>{e(t.filter(W=>W.id!==P)),o(n.map(W=>({...W,memberIds:W.memberIds.filter(Z=>Z!==P)})))},V=()=>{if(c.trim()){const P={id:Date.now().toString(),name:c.trim(),memberIds:[]};o([...n,P]),d("")}},j=P=>{o(n.filter(W=>W.id!==P))},q=(P,W)=>{o(n.map(Z=>{if(Z.id!==P)return Z;const S=Z.memberIds.includes(W);return{...Z,memberIds:S?Z.memberIds.filter(M=>M!==W):[...Z.memberIds,W]}}))};return h.jsxs("div",{className:"p-3 md:p-6 max-w-6xl mx-auto w-full h-full overflow-y-auto",children:[h.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-white mb-6",children:"Admin Settings"}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-8",children:[h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-4 md:p-6",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 border-b border-slate-100 dark:border-slate-700 pb-2",children:[h.jsx(lf,{className:"text-orange-600",size:24}),h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Team Roster"})]}),h.jsxs("div",{className:"flex gap-2 mb-4 items-end",children:[h.jsxs("div",{className:"flex-1",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400",children:"First Name"}),h.jsx("input",{type:"text",value:s,onChange:P=>r(P.target.value),placeholder:"e.g. Abby",className:"w-full p-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-white"})]}),h.jsxs("div",{className:"w-20",children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400",children:"Last Init."}),h.jsx("input",{type:"text",value:a,maxLength:1,onChange:P=>u(P.target.value),placeholder:"B",className:"w-full p-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-white text-center",onKeyDown:P=>P.key==="Enter"&&A()})]}),h.jsx("button",{onClick:A,className:"bg-orange-600 text-white p-2.5 rounded-lg hover:bg-orange-700 transition mb-[1px]",children:h.jsx(sf,{size:20})})]}),h.jsx("ul",{className:"space-y-2 max-h-96 overflow-y-auto pr-1 custom-scrollbar",children:t.map(P=>h.jsxs("li",{className:"flex justify-between items-center p-3 bg-slate-50 dark:bg-slate-700/50 rounded-lg group hover:bg-slate-100 dark:hover:bg-slate-700 transition",children:[h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsxs("div",{className:"w-8 h-8 rounded-full bg-slate-200 dark:bg-slate-600 flex items-center justify-center font-bold text-slate-600 dark:text-slate-300 text-xs",children:[P.firstName[0],P.lastNameInitial]}),h.jsxs("span",{className:"font-medium text-slate-700 dark:text-slate-200",children:[P.firstName," ",P.lastNameInitial,"."]})]}),h.jsx("button",{onClick:()=>z(P.id),className:"text-slate-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition",children:h.jsx(Ge,{size:18})})]},P.id))})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-4 md:p-6",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 border-b border-slate-100 dark:border-slate-700 pb-2",children:[h.jsx(yd,{className:"text-orange-600",size:24}),h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Sub-Teams & Assignments"})]}),h.jsxs("div",{className:"flex gap-2 mb-4",children:[h.jsx("input",{type:"text",value:c,onChange:P=>d(P.target.value),placeholder:"New Team Name (e.g. Pit Crew)",className:"flex-1 p-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-white",onKeyDown:P=>P.key==="Enter"&&V()}),h.jsx("button",{onClick:V,className:"bg-orange-600 text-white p-2 rounded-lg hover:bg-orange-700 transition",children:h.jsx(Gt,{size:20})})]}),h.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto pr-2",children:n.map(P=>h.jsxs("div",{className:"border border-slate-200 dark:border-slate-600 rounded-lg overflow-hidden",children:[h.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 p-3 bg-slate-50 dark:bg-slate-700/50",children:[h.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-200",children:P.name}),h.jsxs("div",{className:"flex gap-2 self-end sm:self-auto",children:[h.jsx("button",{onClick:()=>m(f===P.id?null:P.id),className:`text-xs px-3 py-1 rounded-full transition ${f===P.id?"bg-orange-100 text-orange-700":"bg-white dark:bg-slate-600 text-slate-600 dark:text-slate-300"}`,children:f===P.id?"Done":"Manage Members"}),h.jsx("button",{onClick:()=>j(P.id),className:"text-slate-400 hover:text-red-500",children:h.jsx(Ge,{size:18})})]})]}),h.jsx("div",{className:"p-3 bg-white dark:bg-slate-800",children:f===P.id?h.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.map(W=>h.jsxs("div",{onClick:()=>q(P.id,W.id),className:`cursor-pointer p-2 rounded border flex items-center justify-between text-sm ${P.memberIds.includes(W.id)?"border-orange-500 bg-orange-50 dark:bg-orange-900/20 text-orange-700 dark:text-orange-300":"border-slate-200 dark:border-slate-600 text-slate-600 dark:text-slate-400"}`,children:[h.jsxs("span",{children:[W.firstName," ",W.lastNameInitial,"."]}),P.memberIds.includes(W.id)&&h.jsx(dl,{size:14})]},W.id))}):h.jsxs("div",{className:"flex flex-wrap gap-2",children:[P.memberIds.length===0&&h.jsx("span",{className:"text-xs text-slate-400 italic",children:"No members assigned."}),P.memberIds.map(W=>{const Z=t.find(S=>S.id===W);return Z?h.jsxs("span",{className:"text-xs bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 px-2 py-1 rounded-full border border-slate-200 dark:border-slate-600",children:[Z.firstName," ",Z.lastNameInitial,"."]},W):null})]})})]},P.id))})]})]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 p-4 md:p-6 mt-6",children:[h.jsxs("div",{className:"flex items-center gap-2 mb-4 border-b border-slate-100 dark:border-slate-700 pb-2",children:[h.jsx(cl,{className:"text-orange-600",size:24}),h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Season Manager"})]}),h.jsxs("div",{className:"flex gap-2 mb-4",children:[h.jsx("input",{type:"text",value:b,onChange:P=>_(P.target.value),placeholder:"New Season Name (e.g. 2025-2026 Decode)",className:"flex-1 p-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-white",onKeyDown:P=>P.key==="Enter"&&b.trim()&&(v(b.trim()),_(""))}),h.jsx("button",{onClick:()=>{b.trim()&&(v(b.trim()),_(""))},className:"bg-orange-600 text-white p-2 rounded-lg hover:bg-orange-700 transition",children:h.jsx(Gt,{size:20})})]}),h.jsx("div",{className:"space-y-3",children:p.map(P=>h.jsxs("div",{className:`border rounded-lg overflow-hidden ${g===P.id?"border-orange-400 ring-2 ring-orange-200 dark:ring-orange-900/50":"border-slate-200 dark:border-slate-600"}`,children:[h.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 p-3 bg-slate-50 dark:bg-slate-700/50",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[g===P.id&&h.jsx("span",{className:"text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400 px-2 py-0.5 rounded-full font-bold",children:"Active"}),h.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-200",children:P.name})]}),h.jsxs("div",{className:"flex gap-2 self-end sm:self-auto",children:[h.jsx("button",{onClick:()=>{w===P.id?C(null):(C(P.id),k(P.name),U(P.fieldImageUrl||""))},className:`text-xs px-3 py-1 rounded-full transition ${w===P.id?"bg-orange-100 text-orange-700":"bg-white dark:bg-slate-600 text-slate-600 dark:text-slate-300"}`,children:w===P.id?"Done":"Edit"}),p.length>1&&h.jsx("button",{onClick:()=>R(P.id),className:"text-slate-400 hover:text-red-500",children:h.jsx(Ge,{size:18})})]})]}),w===P.id&&h.jsxs("div",{className:"p-3 bg-white dark:bg-slate-800 space-y-3",children:[h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1",children:"Season Name"}),h.jsx("input",{type:"text",value:I,onChange:W=>k(W.target.value),onBlur:()=>I.trim()&&y(P.id,{name:I.trim()}),className:"w-full p-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-white"})]}),h.jsxs("div",{children:[h.jsx("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 block mb-1",children:"Field Image URL (for Match Planner)"}),h.jsx("input",{type:"text",value:T,onChange:W=>U(W.target.value),onBlur:()=>y(P.id,{fieldImageUrl:T}),placeholder:"https://example.com/field.png (1200x800 recommended)",className:"w-full p-2 rounded-lg border border-slate-300 dark:border-slate-600 bg-slate-50 dark:bg-slate-700 text-slate-900 dark:text-white text-sm"}),h.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Recommended dimensions: 1200800 pixels (3:2 ratio)"})]})]})]},P.id))})]}),E&&h.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-xl p-6 max-w-md w-full shadow-2xl",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[h.jsx("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center",children:h.jsx(Xd,{className:"text-red-600",size:24})}),h.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-white",children:"Delete Season?"})]}),h.jsxs("p",{className:"text-slate-600 dark:text-slate-300 mb-2",children:[h.jsx("strong",{children:"Warning:"})," This will permanently delete the season ",h.jsxs("strong",{children:['"',($=p.find(P=>P.id===E))==null?void 0:$.name,'"']})," and ALL associated data:"]}),h.jsxs("ul",{className:"text-sm text-slate-500 dark:text-slate-400 list-disc list-inside mb-4",children:[h.jsx("li",{children:"All tasks"}),h.jsx("li",{children:"All team members"}),h.jsx("li",{children:"All scouting reports"}),h.jsx("li",{children:"All match plans"}),h.jsx("li",{children:"All portfolio entries"})]}),h.jsx("p",{className:"text-red-600 dark:text-red-400 text-sm font-medium mb-6",children:"This action cannot be undone."}),h.jsxs("div",{className:"flex justify-end gap-3",children:[h.jsx("button",{onClick:()=>R(null),className:"px-4 py-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-lg transition",children:"Cancel"}),h.jsx("button",{onClick:()=>{x(E),R(null)},className:"px-4 py-2 bg-red-600 text-white rounded-lg font-medium hover:bg-red-700 transition",children:"Delete Season"})]})]})})]})};function ab({setActiveTab:t}){var b,_;const{user:e}=Ro(),{tasks:n,matchPlans:o,scoutingReports:s,currentSeasonId:r}=ge(),a=n.filter(w=>!w.seasonId||w.seasonId===r),u=o.filter(w=>!w.seasonId||w.seasonId===r),c=s.filter(w=>!w.seasonId||w.seasonId===r),d=((_=(b=e==null?void 0:e.user_metadata)==null?void 0:b.full_name)==null?void 0:_.split(" ")[0])||"Team Member",f=a.filter(w=>w.status==="Done").length,m=["To Do","In Progress","Validation","Done"],p=a.filter(w=>m.includes(w.status)).length,g=a.filter(w=>w.status==="Backlog").length,v=[{label:"Sprint Progress",value:`${f} / ${p}`,icon:po,color:"text-blue-600",bg:"bg-blue-50 dark:bg-blue-900/20"},{label:"Backlog Items",value:g,icon:fo,color:"text-purple-600",bg:"bg-purple-50 dark:bg-purple-900/20"},{label:"Match Plans",value:u.length,icon:co,color:"text-orange-600",bg:"bg-orange-50 dark:bg-orange-900/20"},{label:"Scouting Reports",value:c.length,icon:lo,color:"text-green-600",bg:"bg-green-50 dark:bg-green-900/20"}],y=[{id:"kanban",label:"Sprint Planning",desc:"Track your team's progress",icon:fo,color:"bg-blue-500"},{id:"checklist",label:"Pre-Match Checklist",desc:"Always be competition ready",icon:po,color:"bg-teal-500"},{id:"scouting",label:"Scouting Reports",desc:"Know your competition",icon:lo,color:"bg-green-500"},{id:"planner",label:"Match Planner",desc:"Plan with your allies",icon:co,color:"bg-orange-500"},{id:"portfolio",label:"Portfolio Helper",desc:"Summarize your team's accomplishments",icon:ho,color:"bg-pink-500"},{id:"judging",label:"Judging Prep",desc:"Be ready to answer any question",icon:ho,color:"bg-purple-500"}],x=[...u.map(w=>({type:"plan",title:w.title,date:w.updatedAt,id:w.id})),...c.map(w=>({type:"scout",title:`Team ${w.teamNumber}`,date:Date.now(),id:w.id})),...a.slice(-5).map(w=>({type:"task",title:w.title,date:w.createdAt,id:w.id}))].sort((w,C)=>C.date-w.date).slice(0,5);return h.jsxs("div",{className:"max-w-6xl mx-auto space-y-8 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[h.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-orange-600 to-orange-500 rounded-3xl p-8 text-white shadow-xl",children:[h.jsxs("div",{className:"relative z-10",children:[h.jsxs("h1",{className:"text-3xl md:text-4xl font-bold mb-2",children:["Welcome back, ",d,"! "]}),h.jsxs("p",{className:"text-orange-100 text-lg opacity-90 max-w-xl",children:["Your robotics Command Center is ready. You have ",a.filter(w=>["To Do","In Progress","Validation"].includes(w.status)).length," open tasks for this sprint."]})]}),h.jsx("div",{className:"absolute top-0 right-0 -mr-16 -mt-16 w-64 h-64 bg-white/10 rounded-full blur-3xl"}),h.jsx("div",{className:"absolute bottom-0 right-10 w-32 h-32 bg-orange-400/20 rounded-full blur-2xl"})]}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:v.map((w,C)=>h.jsxs("div",{className:"bg-white dark:bg-slate-800 p-4 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm",children:[h.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[h.jsx("div",{className:`${w.bg} ${w.color} p-2 rounded-lg`,children:h.jsx(w.icon,{size:18})}),h.jsx("span",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider",children:w.label})]}),h.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:w.value})]},C))}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[h.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[h.jsx(od,{size:20,className:"text-orange-500"}),"Quick Actions"]}),h.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:y.map((w,C)=>h.jsxs("button",{onClick:()=>t(w.id),className:"group relative bg-white dark:bg-slate-800 p-6 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-md hover:border-orange-500/50 transition-all text-left overflow-hidden",children:[h.jsxs("div",{className:"relative z-10",children:[h.jsx("div",{className:`${w.color} text-white w-12 h-12 rounded-xl flex items-center justify-center mb-4 shadow-lg group-hover:scale-110 transition-transform`,children:h.jsx(w.icon,{size:24})}),h.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-1",children:w.label}),h.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:w.desc})]}),h.jsx(ao,{className:"absolute top-6 right-6 text-slate-300 dark:text-slate-600 group-hover:text-orange-500 group-hover:translate-x-1 transition-all"}),h.jsx("div",{className:"absolute -bottom-4 -right-4 w-24 h-24 bg-slate-50 dark:bg-slate-700/50 rounded-full opacity-0 group-hover:opacity-100 transition-opacity"})]},C))})]}),h.jsxs("div",{className:"space-y-4",children:[h.jsxs("h2",{className:"text-xl font-bold text-slate-900 dark:text-white flex items-center gap-2",children:[h.jsx(as,{size:20,className:"text-orange-500"}),"Recent Activity"]}),h.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden text-sm",children:[x.length>0?h.jsx("div",{className:"divide-y divide-slate-100 dark:divide-slate-700",children:x.map((w,C)=>h.jsxs("div",{className:"p-4 flex items-start gap-3 hover:bg-slate-50 dark:hover:bg-slate-700/50 transition-colors cursor-pointer",onClick:()=>t(w.type==="plan"?"planner":w.type==="scout"?"scouting":"kanban"),children:[h.jsx("div",{className:`mt-1 w-2 h-2 rounded-full shrink-0 ${w.type==="plan"?"bg-orange-500":w.type==="scout"?"bg-green-500":"bg-blue-500"}`}),h.jsxs("div",{className:"flex-1 min-w-0",children:[h.jsxs("p",{className:"font-medium text-slate-900 dark:text-white truncate",children:[w.type==="plan"?"Match Plan: ":w.type==="scout"?"Scouting: ":"Task: ",w.title]}),h.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:new Date(w.date).toLocaleDateString()})]})]},C))}):h.jsxs("div",{className:"p-8 text-center",children:[h.jsx(Yd,{className:"mx-auto text-slate-300 mb-2",size:32}),h.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"No activity yet. Start by adding a task or scouting report!"})]}),h.jsx("div",{className:"p-3 bg-slate-50 dark:bg-slate-700/50 border-t border-slate-100 dark:border-slate-700",children:h.jsx("button",{onClick:()=>t("kanban"),className:"w-full text-center text-xs font-bold text-orange-600 dark:text-orange-400 hover:underline",children:"View all project updates"})})]})]})]})]})}function lb(){var R;const[t,e]=D.useState("dashboard"),[n,o]=D.useState(!1),{user:s,signOut:r,isConfigured:a}=Ro(),{tasks:u,members:c,teams:d,theme:f,setTheme:m,addTask:p,updateTask:g,setMembers:v,setTeams:y,seasons:x,currentSeasonId:b,setCurrentSeason:_}=ge(),w=Xu(),C=u.filter(A=>!A.seasonId||A.seasonId===b),I=c.filter(A=>!A.seasonId||A.seasonId===b),k=d.filter(A=>!A.seasonId||A.seasonId===b),T=C.map(A=>({...A,timeline:A.timeline.map(z=>({...z,type:z.type}))})),U=async()=>{await r(),w("/login")},E=({id:A,label:z,icon:V})=>h.jsxs("button",{onClick:()=>{e(A),o(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 mb-1
        ${t===A?"bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 font-bold shadow-sm":"text-slate-500 dark:text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800 hover:text-slate-900 dark:hover:text-slate-200 font-medium"}`,children:[h.jsx(V,{size:20}),h.jsx("span",{children:z})]});return h.jsxs("div",{className:"flex h-screen bg-slate-50 dark:bg-slate-900 font-sans overflow-hidden transition-colors duration-200",children:[h.jsxs("aside",{className:"hidden lg:flex w-64 flex-col bg-white dark:bg-slate-800 border-r border-slate-200 dark:border-slate-700 h-full",children:[h.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700 flex items-center gap-3",children:[h.jsx("img",{src:"/ftc-team-manager/logo.png",className:"w-12 h-12 object-contain rounded-lg",alt:"Logo"}),h.jsx("h1",{className:"text-xl font-bold text-slate-900 dark:text-white tracking-tight",children:"FTC Manager"})]}),h.jsxs("div",{className:"px-4 pt-3",children:[h.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 block",children:"Season"}),h.jsxs("div",{className:"relative",children:[h.jsx("select",{value:b||"",onChange:A=>_(A.target.value),className:"w-full appearance-none bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg px-3 py-2 pr-8 text-sm font-medium text-slate-700 dark:text-slate-200 cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-600 transition",children:x.map(A=>h.jsx("option",{value:A.id,children:A.name},A.id))}),h.jsx(ls,{size:16,className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"})]})]}),h.jsxs("nav",{className:"flex-1 p-4 overflow-y-auto",children:[h.jsx(E,{id:"dashboard",label:"Dashboard",icon:fo}),h.jsx("div",{className:"my-4 border-t border-slate-100 dark:border-slate-700"}),h.jsx(E,{id:"kanban",label:"Sprint Planning",icon:as}),h.jsx(E,{id:"checklist",label:"Pre-Match Checklist",icon:po}),h.jsx(E,{id:"scouting",label:"Scouting Reports",icon:lo}),h.jsx(E,{id:"planner",label:"Match Planner",icon:co}),h.jsx("div",{className:"my-4 border-t border-slate-100 dark:border-slate-700"}),h.jsx(E,{id:"portfolio",label:"Portfolio Helper",icon:Dr}),h.jsx(E,{id:"judging",label:"Judging Prep",icon:Fr}),h.jsx("div",{className:"my-4 border-t border-slate-100 dark:border-slate-700"}),h.jsx(E,{id:"admin",label:"Admin Settings",icon:Hr})]}),h.jsxs("div",{className:"p-4 border-t border-slate-100 dark:border-slate-700",children:[h.jsxs("div",{className:"bg-slate-100 dark:bg-slate-700 rounded-xl p-4",children:[h.jsxs("div",{className:"flex justify-between items-center mb-4",children:[h.jsx("p",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase",children:"Appearance"}),h.jsx("button",{onClick:()=>m(f==="light"?"dark":"light"),className:"text-slate-500 dark:text-slate-400 hover:text-orange-600 dark:hover:text-orange-400",children:f==="light"?h.jsx(qr,{size:16}):h.jsx(Br,{size:16})})]}),h.jsxs("div",{className:"flex justify-between text-sm mb-1 text-slate-600 dark:text-slate-300",children:[h.jsx("span",{children:"Tasks Done"}),h.jsx("span",{className:"font-bold",children:C.filter(A=>A.status==="Done").length})]}),h.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-600 rounded-full h-1.5 mt-2",children:h.jsx("div",{className:"bg-green-500 h-1.5 rounded-full",style:{width:`${C.length>0?C.filter(A=>A.status==="Done").length/C.length*100:0}%`}})})]}),a&&s&&h.jsxs("div",{className:"mt-4 flex flex-col gap-2",children:[h.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-900/50 rounded-xl",children:[h.jsx("div",{className:"w-8 h-8 bg-orange-100 dark:bg-orange-900/50 rounded-full flex items-center justify-center",children:h.jsx(pl,{size:16,className:"text-orange-600 dark:text-orange-400"})}),h.jsx("div",{className:"flex-1 min-w-0",children:h.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white truncate",children:((R=s.user_metadata)==null?void 0:R.full_name)||s.email})}),h.jsx("button",{onClick:U,className:"p-2 text-slate-400 hover:text-red-500 transition-colors",title:"Sign out",children:h.jsx(Lr,{size:16})})]}),h.jsx(li,{variant:"full"})]})]})]}),h.jsxs("div",{className:"lg:hidden fixed top-0 left-0 right-0 h-16 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 flex items-center justify-between px-4 z-20 safe-area-top",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("img",{src:"/ftc-team-manager/logo.png",className:"w-12 h-12 object-contain rounded-lg",alt:"Logo"}),h.jsx("span",{className:"font-bold text-lg text-slate-900 dark:text-white",children:"FTC Manager"})]}),h.jsxs("div",{className:"flex items-center gap-3",children:[h.jsx(li,{variant:"icon"}),h.jsx("button",{onClick:()=>m(f==="light"?"dark":"light"),className:"text-slate-600 dark:text-slate-300",children:f==="light"?h.jsx(qr,{size:20}):h.jsx(Br,{size:20})}),h.jsx("button",{onClick:()=>o(!n),className:"p-2 text-slate-600 dark:text-slate-300",children:n?h.jsx(_n,{}):h.jsx(kd,{})})]})]}),n&&h.jsxs("div",{className:"lg:hidden fixed inset-0 bg-white dark:bg-slate-800 z-50 pt-4 px-4 safe-area-top",children:[h.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[h.jsxs("div",{className:"flex items-center gap-2",children:[h.jsx("img",{src:"/ftc-team-manager/logo.png",className:"w-10 h-10 object-contain rounded-lg",alt:"Logo"}),h.jsx("span",{className:"font-bold text-xl text-slate-900 dark:text-white",children:"FTC Manager"})]}),h.jsx("button",{onClick:()=>o(!1),className:"p-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-full transition flex items-center justify-center w-10 h-10",children:h.jsx(_n,{size:24})})]}),h.jsxs("div",{className:"mb-4 px-2",children:[h.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-1 block",children:"Season"}),h.jsxs("div",{className:"relative",children:[h.jsx("select",{value:b||"",onChange:A=>_(A.target.value),className:"w-full appearance-none bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg px-3 py-2 pr-8 text-sm font-medium text-slate-700 dark:text-slate-200",children:x.map(A=>h.jsx("option",{value:A.id,children:A.name},A.id))}),h.jsx(ls,{size:16,className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 pointer-events-none"})]})]}),h.jsxs("nav",{className:"space-y-2",children:[h.jsx(E,{id:"dashboard",label:"Dashboard",icon:fo}),h.jsx(E,{id:"kanban",label:"Sprint Planning",icon:as}),h.jsx(E,{id:"checklist",label:"Pre-Match Checklist",icon:po}),h.jsx(E,{id:"scouting",label:"Scouting Reports",icon:lo}),h.jsx(E,{id:"planner",label:"Match Planner",icon:co}),h.jsx(E,{id:"portfolio",label:"Portfolio Helper",icon:Dr}),h.jsx(E,{id:"judging",label:"Judging Prep",icon:Fr}),h.jsx(E,{id:"admin",label:"Admin Settings",icon:Hr})]}),a&&s&&h.jsx("div",{className:"mt-8 pt-4 border-t border-slate-200 dark:border-slate-700",children:h.jsxs("button",{onClick:U,className:"w-full flex items-center gap-3 px-4 py-3 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-all",children:[h.jsx(Lr,{size:20}),h.jsx("span",{className:"font-medium",children:"Sign Out"})]})})]}),h.jsx("main",{className:"flex-1 h-full overflow-hidden relative pt-16 lg:pt-0",children:h.jsxs("div",{className:"h-full w-full overflow-y-auto bg-slate-50 dark:bg-slate-900 p-4 lg:p-6",children:[t==="dashboard"&&h.jsx(ab,{setActiveTab:e}),t==="kanban"&&h.jsx($h,{tasks:T,setTasks:A=>{let z=[];typeof A=="function"?z=A(T):z=A,z.forEach(V=>{C.find(q=>q.id===V.id)?g(V.id,V):p(V)})},members:I,teams:k}),t==="checklist"&&h.jsx(Kh,{}),t==="scouting"&&h.jsx(Oh,{}),t==="planner"&&h.jsx(Jh,{}),t==="portfolio"&&h.jsx($a,{tasks:T,view:"portfolio"}),t==="judging"&&h.jsx($a,{tasks:T,view:"judging"}),t==="admin"&&h.jsx(ib,{members:I,setMembers:v,teams:k,setTeams:y})]})})]})}function ub(){const{user:t,isLoading:e,isConfigured:n}=Ro(),{theme:o,initializeStore:s}=ge();return D.useEffect(()=>{s()},[s]),D.useEffect(()=>{o==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[o]),e?h.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-8",children:[h.jsx("div",{className:"absolute inset-0 bg-orange-500/20 rounded-3xl blur-xl animate-pulse"}),h.jsx("div",{className:"relative w-24 h-24 bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl flex items-center justify-center border border-slate-700/50 shadow-2xl",children:h.jsx("img",{src:"/ftc-team-manager/logo.png",className:"w-16 h-16 object-contain animate-pulse",alt:"FTC Manager Logo"})})]}),h.jsx("h2",{className:"text-xl font-bold text-white mb-2 tracking-tight",children:"FTC Manager"}),h.jsxs("div",{className:"flex items-center justify-center gap-2 text-slate-400",children:[h.jsx("div",{className:"w-4 h-4 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),h.jsx("p",{className:"text-sm font-medium",children:"Preparing your workspace..."})]})]})}):h.jsxs(Qu,{children:[h.jsx(Oo,{path:"/login",element:!n||t?h.jsx(Cr,{to:"/",replace:!0}):h.jsx(Fh,{})}),h.jsx(Oo,{path:"/auth/callback",element:h.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:h.jsxs("div",{className:"text-center",children:[h.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-8",children:[h.jsx("div",{className:"absolute inset-0 bg-orange-500/20 rounded-3xl blur-xl animate-pulse"}),h.jsx("div",{className:"relative w-24 h-24 bg-gradient-to-br from-slate-800 to-slate-900 rounded-3xl flex items-center justify-center border border-slate-700/50 shadow-2xl",children:h.jsx("img",{src:"/ftc-team-manager/logo.png",className:"w-16 h-16 object-contain animate-pulse",alt:"FTC Manager Logo"})})]}),h.jsx("h2",{className:"text-xl font-bold text-white mb-2 tracking-tight",children:"Authenticating"}),h.jsxs("div",{className:"flex items-center justify-center gap-2 text-slate-400",children:[h.jsx("div",{className:"w-4 h-4 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),h.jsx("p",{className:"text-sm font-medium",children:"Securing your session..."})]})]})})}),h.jsx(Oo,{path:"/*",element:!n||t?h.jsx(lb,{}):h.jsx(Cr,{to:"/login",replace:!0})})]})}const cb=new Dc({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1}}}),Ku=document.getElementById("root");if(!Ku)throw new Error("Could not find root element to mount to");const db=ns.createRoot(Ku);db.render(h.jsx(Za.StrictMode,{children:h.jsx(Fc,{client:cb,children:h.jsx(Zu,{children:h.jsx(Lc,{children:h.jsx(ub,{})})})})}));
//# sourceMappingURL=index-BvtiVtVp.js.map
